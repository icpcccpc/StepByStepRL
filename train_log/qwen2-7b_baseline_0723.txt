nohup: ignoring input
+ project_name=DAPO
+ exp_name=DAPO-Qwen2-7B-Test
+ adv_estimator=grpo
+ use_kl_in_reward=False
+ kl_coef=0.0
+ use_kl_loss=False
+ kl_loss_coef=0.0
+ clip_ratio_low=0.2
+ clip_ratio_high=0.28
+ max_prompt_length=2048
+ max_response_length=2048
+ enable_overlong_buffer=True
+ overlong_buffer_len=512
+ overlong_penalty_factor=1.0
+ loss_agg_mode=token-mean
+ enable_filter_groups=True
+ filter_groups_metric=seq_reward
+ max_num_gen_batches=10
+ train_prompt_bsz=512
+ gen_prompt_bsz=1536
+ train_prompt_mini_bsz=32
+ n_resp_per_prompt=16
+ WORKING_DIR=/workspace/lujiahao/verl
+ RUNTIME_ENV=/workspace/lujiahao/verl/verl/trainer/runtime_env.yaml
+ NNODES=1
+ RAY_DATA_HOME=/workspace
+ MODEL_PATH=/workspace/models/Qwen/Qwen2-7B-Instruct
+ CKPTS_DIR=/workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test
+ TRAIN_FILE=/workspace/data/dapo-math-17k.parquet
+ TEST_FILE=/workspace/data/aime-2024.parquet
+ export TENSORBOARD_DIR=/workspace/log/tensorboard/DAPO/DAPO-Qwen2-7B-Test
+ TENSORBOARD_DIR=/workspace/log/tensorboard/DAPO/DAPO-Qwen2-7B-Test
+ temperature=1.0
+ top_p=1.0
+ top_k=-1
+ use_dynamic_bsz=True
+ infer_micro_batch_size=null
+ train_micro_batch_size=null
+ offload=False
+ python3 -m recipe.dapo.main_dapo data.train_files=/workspace/data/dapo-math-17k.parquet data.val_files=/workspace/data/aime-2024.parquet data.prompt_key=prompt data.truncation=left data.max_prompt_length=2048 data.max_response_length=2048 data.gen_batch_size=1536 data.train_batch_size=512 actor_rollout_ref.rollout.n=16 actor_rollout_ref.actor.use_kl_loss=False actor_rollout_ref.actor.kl_loss_coef=0.0 actor_rollout_ref.actor.clip_ratio_low=0.2 actor_rollout_ref.actor.clip_ratio_high=0.28 actor_rollout_ref.actor.clip_ratio_c=10.0 algorithm.adv_estimator=grpo algorithm.use_kl_in_reward=False algorithm.kl_ctrl.kl_coef=0.0 algorithm.filter_groups.enable=True algorithm.filter_groups.metric=seq_reward algorithm.filter_groups.max_num_gen_batches=10 actor_rollout_ref.model.use_remove_padding=True actor_rollout_ref.actor.use_dynamic_bsz=True actor_rollout_ref.ref.log_prob_use_dynamic_bsz=True actor_rollout_ref.rollout.log_prob_use_dynamic_bsz=True actor_rollout_ref.actor.ppo_max_token_len_per_gpu=4096 actor_rollout_ref.ref.log_prob_max_token_len_per_gpu=4096 actor_rollout_ref.rollout.log_prob_max_token_len_per_gpu=4096 actor_rollout_ref.model.path=/workspace/models/Qwen/Qwen2-7B-Instruct actor_rollout_ref.model.enable_gradient_checkpointing=True actor_rollout_ref.actor.optim.lr=1e-6 actor_rollout_ref.actor.optim.lr_warmup_steps=10 actor_rollout_ref.actor.optim.weight_decay=0.1 actor_rollout_ref.actor.ppo_mini_batch_size=32 actor_rollout_ref.actor.ppo_micro_batch_size=null actor_rollout_ref.actor.fsdp_config.param_offload=False actor_rollout_ref.actor.fsdp_config.optimizer_offload=False actor_rollout_ref.actor.entropy_coeff=0 actor_rollout_ref.actor.grad_clip=1.0 actor_rollout_ref.actor.loss_agg_mode=token-mean actor_rollout_ref.actor.ulysses_sequence_parallel_size=1 actor_rollout_ref.rollout.gpu_memory_utilization=0.85 actor_rollout_ref.rollout.log_prob_micro_batch_size=null actor_rollout_ref.rollout.tensor_model_parallel_size=1 actor_rollout_ref.rollout.enable_chunked_prefill=True actor_rollout_ref.rollout.max_num_batched_tokens=4096 actor_rollout_ref.rollout.temperature=1.0 actor_rollout_ref.rollout.top_p=1.0 actor_rollout_ref.rollout.top_k=-1 actor_rollout_ref.rollout.val_kwargs.temperature=1.0 actor_rollout_ref.rollout.val_kwargs.top_p=1.0 actor_rollout_ref.rollout.val_kwargs.top_k=-1 actor_rollout_ref.rollout.val_kwargs.do_sample=True actor_rollout_ref.rollout.val_kwargs.n=1 actor_rollout_ref.ref.log_prob_micro_batch_size=null actor_rollout_ref.ref.fsdp_config.param_offload=False actor_rollout_ref.ref.ulysses_sequence_parallel_size=1 actor_rollout_ref.actor.fsdp_config.fsdp_size=-1 reward_model.reward_manager=dapo reward_model.overlong_buffer.enable=True reward_model.overlong_buffer.len=512 reward_model.overlong_buffer.penalty_factor=1.0 'trainer.logger=[console,tensorboard]' trainer.project_name=DAPO trainer.experiment_name=DAPO-Qwen2-7B-Test trainer.n_gpus_per_node=8 trainer.nnodes=1 trainer.val_before_train=True trainer.total_training_steps=50 trainer.test_freq=10 trainer.save_freq=20 trainer.total_epochs=50 trainer.default_local_dir=/workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test trainer.resume_mode=disable
2025-07-22 18:32:41,079	INFO worker.py:1908 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=379036)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=379036)[0m WARNING:2025-07-22 18:32:50,350:Waiting for register center actor CMSyiL_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=384149)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=384149)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=384149)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=384149)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.55s/it]
[36m(WorkerDict pid=379911)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=379911)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=379911)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=379911)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:09<00:03,  3.11s/it][32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=379911)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.09s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.11s/it]
[36m(WorkerDict pid=379911)[0m /root/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=379911)[0m   warnings.warn(
[36m(WorkerDict pid=384148)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:10<00:03,  3.47s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=384148)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.34s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.40s/it][32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=379036)[0m Training Progress:   0%|          | 0/50 [00:00<?, ?it/s]
[36m(WorkerDict pid=384153)[0m /root/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=384153)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=379036)[0m /workspace/lujiahao/verl/recipe/dapo/dapo_ray_trainer.py:322: FutureWarning: Warning: Function 'verl.trainer.ppo.metric_utils.reduce_metrics' is deprecated. Please use 'verl.utils.metric.reduce_metrics' instead.
[36m(TaskRunner pid=379036)[0m   actor_output_metrics = reduce_metrics(actor_output.meta_info["metrics"])
[36m(TaskRunner pid=379036)[0m Training Progress:   2%|â–         | 1/50 [15:03<12:17:45, 903.39s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:   4%|â–         | 2/50 [29:49<11:54:45, 893.45s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:   6%|â–Œ         | 3/50 [44:29<11:34:56, 887.17s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:   8%|â–Š         | 4/50 [58:42<11:09:40, 873.48s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  10%|â–ˆ         | 5/50 [1:11:34<10:27:44, 837.00s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  12%|â–ˆâ–        | 6/50 [1:22:49<9:33:26, 781.98s/it] 
[36m(TaskRunner pid=379036)[0m Training Progress:  14%|â–ˆâ–        | 7/50 [1:33:19<8:44:48, 732.28s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  16%|â–ˆâ–Œ        | 8/50 [1:43:27<8:04:49, 692.60s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  18%|â–ˆâ–Š        | 9/50 [1:53:19<7:31:53, 661.31s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  20%|â–ˆâ–ˆ        | 10/50 [2:04:18<7:20:21, 660.54s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  22%|â–ˆâ–ˆâ–       | 11/50 [2:14:27<6:59:06, 644.78s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  24%|â–ˆâ–ˆâ–       | 12/50 [2:24:00<6:34:31, 622.94s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [2:34:00<6:19:48, 615.89s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  28%|â–ˆâ–ˆâ–Š       | 14/50 [2:43:53<6:05:25, 609.05s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [2:53:55<5:54:06, 607.05s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [3:04:19<5:46:52, 612.14s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [3:14:30<5:36:30, 611.84s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [3:24:25<5:23:30, 606.59s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [3:33:52<5:07:20, 594.87s/it]
[36m(WorkerDict pid=379911)[0m INFO:2025-07-22 22:19:18,877:[Rank 0] Saved model to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_20/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=384149)[0m INFO:2025-07-22 22:19:50,577:[Rank 2] Saved optim to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_20/actor/optim_world_size_8_rank_2.pt
[36m(WorkerDict pid=384149)[0m INFO:2025-07-22 22:19:50,586:[Rank 2] Saved extra_state to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_20/actor/extra_state_world_size_8_rank_2.pt
[36m(WorkerDict pid=384148)[0m INFO:2025-07-22 22:19:19,410:[Rank 1] Saved model to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_20/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=379911)[0m INFO:2025-07-22 22:19:51,151:[Rank 0] Saved model config and tokenizer class to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_20/actor/huggingface
[36m(TaskRunner pid=379036)[0m Training Progress:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [3:45:06<5:09:12, 618.41s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [3:54:13<4:48:35, 597.10s/it]
[36m(WorkerDict pid=384148)[0m INFO:2025-07-22 22:19:52,040:[Rank 1] Saved optim to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_20/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=384148)[0m INFO:2025-07-22 22:19:52,047:[Rank 1] Saved extra_state to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_20/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=379036)[0m Training Progress:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [4:03:30<4:33:03, 585.14s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [4:12:53<4:20:16, 578.39s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [4:22:16<4:08:38, 573.80s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [4:31:48<3:58:48, 573.15s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [4:41:02<3:47:02, 567.61s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [4:50:00<3:34:07, 558.57s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [4:59:13<3:24:13, 556.96s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [5:08:12<3:13:01, 551.49s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [5:17:57<3:07:11, 561.58s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [5:27:02<2:56:14, 556.57s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [5:35:52<2:44:34, 548.60s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [5:44:44<2:34:03, 543.72s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [5:53:42<2:24:29, 541.81s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [6:02:22<2:13:51, 535.44s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [6:10:59<2:03:38, 529.91s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [6:19:39<1:54:10, 526.94s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [6:28:32<1:45:46, 528.88s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [6:37:04<1:35:59, 523.58s/it]
[36m(WorkerDict pid=379911)[0m INFO:2025-07-23 01:21:27,954:[Rank 0] Saved model to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_40/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=379911)[0m INFO:2025-07-23 01:21:59,005:[Rank 0] Saved optim to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_40/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=384150)[0m INFO:2025-07-23 01:21:28,546:[Rank 3] Saved model to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_40/actor/model_world_size_8_rank_3.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=379911)[0m INFO:2025-07-23 01:21:59,039:[Rank 0] Saved extra_state to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_40/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=379911)[0m INFO:2025-07-23 01:21:59,430:[Rank 0] Saved model config and tokenizer class to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_40/actor/huggingface
[36m(TaskRunner pid=379036)[0m Training Progress:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [6:47:15<1:31:38, 549.84s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [6:55:36<1:20:18, 535.36s/it]
[36m(WorkerDict pid=384153)[0m INFO:2025-07-23 01:22:01,526:[Rank 6] Saved optim to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_40/actor/optim_world_size_8_rank_6.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=384153)[0m INFO:2025-07-23 01:22:01,532:[Rank 6] Saved extra_state to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_40/actor/extra_state_world_size_8_rank_6.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=379036)[0m Training Progress:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [7:03:54<1:09:51, 523.95s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [7:12:07<1:00:02, 514.67s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [7:20:32<51:10, 511.73s/it]  
[36m(TaskRunner pid=379036)[0m Training Progress:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [7:28:44<42:09, 505.91s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 46/50 [7:37:04<33:36, 504.21s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 47/50 [7:45:05<24:51, 497.28s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 48/50 [7:53:14<16:29, 494.69s/it]
[36m(TaskRunner pid=379036)[0m Training Progress:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 49/50 [8:01:22<08:12, 492.68s/it]
[36m(WorkerDict pid=384152)[0m INFO:2025-07-23 02:45:14,204:[Rank 5] Saved model to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_50/actor/model_world_size_8_rank_5.pt
[36m(WorkerDict pid=384152)[0m INFO:2025-07-23 02:45:45,564:[Rank 5] Saved optim to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_50/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=384152)[0m INFO:2025-07-23 02:45:45,596:[Rank 5] Saved extra_state to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_50/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=384154)[0m INFO:2025-07-23 02:45:14,916:[Rank 7] Saved model to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_50/actor/model_world_size_8_rank_7.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=379911)[0m INFO:2025-07-23 02:45:46,765:[Rank 0] Saved model config and tokenizer class to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_50/actor/huggingface
[36m(TaskRunner pid=379036)[0m TaskRunner hostname: p-phy-zy-daxing-kt-lc-a800-node-prod-15-172, PID: 379036
[36m(TaskRunner pid=379036)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'load_contents': ['model',
[36m(TaskRunner pid=379036)[0m                                                                   'optimizer',
[36m(TaskRunner pid=379036)[0m                                                                   'extra'],
[36m(TaskRunner pid=379036)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=379036)[0m                                                                   'optimizer',
[36m(TaskRunner pid=379036)[0m                                                                   'extra']},
[36m(TaskRunner pid=379036)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=379036)[0m                                  'clip_ratio_c': 10.0,
[36m(TaskRunner pid=379036)[0m                                  'clip_ratio_high': 0.28,
[36m(TaskRunner pid=379036)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=379036)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=379036)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=379036)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=379036)[0m                                  'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=379036)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=379036)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=379036)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=379036)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=379036)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=379036)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=379036)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=379036)[0m                                  'kl_loss_coef': 0.0,
[36m(TaskRunner pid=379036)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=379036)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=379036)[0m                                  'optim': {'lr': 1e-06,
[36m(TaskRunner pid=379036)[0m                                            'lr_warmup_steps': 10,
[36m(TaskRunner pid=379036)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=379036)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=379036)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=379036)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=379036)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=379036)[0m                                            'weight_decay': 0.1},
[36m(TaskRunner pid=379036)[0m                                  'policy_loss': {'clip_cov_lb': 1.0,
[36m(TaskRunner pid=379036)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=379036)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=379036)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=379036)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=379036)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=379036)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=379036)[0m                                  'ppo_max_token_len_per_gpu': 4096,
[36m(TaskRunner pid=379036)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=379036)[0m                                  'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=379036)[0m                                  'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=379036)[0m                                  'shuffle': False,
[36m(TaskRunner pid=379036)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=379036)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=379036)[0m                                  'use_dynamic_bsz': True,
[36m(TaskRunner pid=379036)[0m                                  'use_kl_loss': False,
[36m(TaskRunner pid=379036)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=379036)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=379036)[0m                        'model': {'custom_chat_template': None,
[36m(TaskRunner pid=379036)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=379036)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=379036)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=379036)[0m                                  'external_lib': None,
[36m(TaskRunner pid=379036)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=379036)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=379036)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=379036)[0m                                  'override_config': {},
[36m(TaskRunner pid=379036)[0m                                  'path': '/workspace/models/Qwen/Qwen2-7B-Instruct',
[36m(TaskRunner pid=379036)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=379036)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=379036)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=379036)[0m                                  'use_liger': False,
[36m(TaskRunner pid=379036)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=379036)[0m                                  'use_shm': False},
[36m(TaskRunner pid=379036)[0m                        'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=379036)[0m                                     'all_ranks': False,
[36m(TaskRunner pid=379036)[0m                                     'discrete': False,
[36m(TaskRunner pid=379036)[0m                                     'ranks': []},
[36m(TaskRunner pid=379036)[0m                        'ref': {'entropy_checkpointing': False,
[36m(TaskRunner pid=379036)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=379036)[0m                                'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=379036)[0m                                                'param_offload': False,
[36m(TaskRunner pid=379036)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=379036)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=379036)[0m                                'log_prob_max_token_len_per_gpu': 4096,
[36m(TaskRunner pid=379036)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=379036)[0m                                'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=379036)[0m                                'log_prob_use_dynamic_bsz': True,
[36m(TaskRunner pid=379036)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=379036)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=379036)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=379036)[0m                        'rollout': {'agent': {'agent_loop_config_path': None,
[36m(TaskRunner pid=379036)[0m                                              'custom_async_server': {'name': None,
[36m(TaskRunner pid=379036)[0m                                                                      'path': None},
[36m(TaskRunner pid=379036)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=379036)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=379036)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=379036)[0m                                    'do_sample': True,
[36m(TaskRunner pid=379036)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=379036)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=379036)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=379036)[0m                                    'engine_kwargs': {'sglang': {'attention_backend': None},
[36m(TaskRunner pid=379036)[0m                                                      'vllm': {'disable_mm_preprocessor_cache': False,
[36m(TaskRunner pid=379036)[0m                                                               'swap_space': None}},
[36m(TaskRunner pid=379036)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=379036)[0m                                    'gpu_memory_utilization': 0.85,
[36m(TaskRunner pid=379036)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=379036)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=379036)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=379036)[0m                                    'log_prob_max_token_len_per_gpu': 4096,
[36m(TaskRunner pid=379036)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=379036)[0m                                    'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=379036)[0m                                    'log_prob_use_dynamic_bsz': True,
[36m(TaskRunner pid=379036)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=379036)[0m                                    'max_num_batched_tokens': 4096,
[36m(TaskRunner pid=379036)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=379036)[0m                                    'mode': 'sync',
[36m(TaskRunner pid=379036)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=379036)[0m                                    'multi_turn': {'completion_callback': None,
[36m(TaskRunner pid=379036)[0m                                                   'enable': False,
[36m(TaskRunner pid=379036)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=379036)[0m                                                   'interaction_config_path': None,
[36m(TaskRunner pid=379036)[0m                                                   'max_assistant_turns': None,
[36m(TaskRunner pid=379036)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=379036)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=379036)[0m                                                   'max_user_turns': None,
[36m(TaskRunner pid=379036)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=379036)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=379036)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=379036)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=379036)[0m                                    'n': 16,
[36m(TaskRunner pid=379036)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=379036)[0m                                    'prompt_length': 2048,
[36m(TaskRunner pid=379036)[0m                                    'response_length': 2048,
[36m(TaskRunner pid=379036)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=379036)[0m                                    'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=379036)[0m                                    'top_k': -1,
[36m(TaskRunner pid=379036)[0m                                    'top_p': 1.0,
[36m(TaskRunner pid=379036)[0m                                    'trace': {'backend': None,
[36m(TaskRunner pid=379036)[0m                                              'token2text': False},
[36m(TaskRunner pid=379036)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=379036)[0m                                    'val_kwargs': {'do_sample': True,
[36m(TaskRunner pid=379036)[0m                                                   'n': 1,
[36m(TaskRunner pid=379036)[0m                                                   'temperature': 1.0,
[36m(TaskRunner pid=379036)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=379036)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=379036)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=379036)[0m                'adv_estimator': 'grpo',
[36m(TaskRunner pid=379036)[0m                'filter_groups': {'_target_': 'verl.trainer.config.FilterGroupsConfig',
[36m(TaskRunner pid=379036)[0m                                  'enable': True,
[36m(TaskRunner pid=379036)[0m                                  'max_num_gen_batches': 10,
[36m(TaskRunner pid=379036)[0m                                  'metric': 'seq_reward'},
[36m(TaskRunner pid=379036)[0m                'gamma': 1.0,
[36m(TaskRunner pid=379036)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=379036)[0m                            'horizon': 10000,
[36m(TaskRunner pid=379036)[0m                            'kl_coef': 0.0,
[36m(TaskRunner pid=379036)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=379036)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=379036)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=379036)[0m                'lam': 1.0,
[36m(TaskRunner pid=379036)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=379036)[0m                'pf_ppo': {'_target_': 'verl.trainer.config.PFPPOConfig',
[36m(TaskRunner pid=379036)[0m                           'reweight_method': 'pow',
[36m(TaskRunner pid=379036)[0m                           'weight_pow': 2.0},
[36m(TaskRunner pid=379036)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=379036)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=379036)[0m  'critic': {'_target_': 'verl.trainer.config.FSDPCriticConfig',
[36m(TaskRunner pid=379036)[0m             'checkpoint': {'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=379036)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=379036)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=379036)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=379036)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=379036)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=379036)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=379036)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=379036)[0m             'model': {'enable_activation_offload': False,
[36m(TaskRunner pid=379036)[0m                       'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=379036)[0m                       'external_lib': None,
[36m(TaskRunner pid=379036)[0m                       'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=379036)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=379036)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=379036)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=379036)[0m                                       'param_offload': False,
[36m(TaskRunner pid=379036)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=379036)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=379036)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=379036)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=379036)[0m                       'override_config': {},
[36m(TaskRunner pid=379036)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=379036)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=379036)[0m                       'tokenizer_path': '/workspace/models/Qwen/Qwen2-7B-Instruct',
[36m(TaskRunner pid=379036)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=379036)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=379036)[0m                       'use_shm': False},
[36m(TaskRunner pid=379036)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=379036)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=379036)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=379036)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=379036)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=379036)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=379036)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=379036)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=379036)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=379036)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=379036)[0m             'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=379036)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=379036)[0m                          'all_ranks': False,
[36m(TaskRunner pid=379036)[0m                          'discrete': False,
[36m(TaskRunner pid=379036)[0m                          'ranks': []},
[36m(TaskRunner pid=379036)[0m             'rollout_n': 16,
[36m(TaskRunner pid=379036)[0m             'shuffle': False,
[36m(TaskRunner pid=379036)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=379036)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=379036)[0m             'use_dynamic_bsz': True},
[36m(TaskRunner pid=379036)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=379036)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=379036)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=379036)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=379036)[0m           'filter_overlong_prompts': False,
[36m(TaskRunner pid=379036)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=379036)[0m           'gen_batch_size': 1536,
[36m(TaskRunner pid=379036)[0m           'image_key': 'images',
[36m(TaskRunner pid=379036)[0m           'max_prompt_length': 2048,
[36m(TaskRunner pid=379036)[0m           'max_response_length': 2048,
[36m(TaskRunner pid=379036)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=379036)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=379036)[0m           'return_multi_modal_inputs': True,
[36m(TaskRunner pid=379036)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=379036)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=379036)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=379036)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=379036)[0m           'shuffle': True,
[36m(TaskRunner pid=379036)[0m           'tokenizer': None,
[36m(TaskRunner pid=379036)[0m           'train_batch_size': 512,
[36m(TaskRunner pid=379036)[0m           'train_files': '/workspace/data/dapo-math-17k.parquet',
[36m(TaskRunner pid=379036)[0m           'truncation': 'left',
[36m(TaskRunner pid=379036)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=379036)[0m           'use_shm': False,
[36m(TaskRunner pid=379036)[0m           'val_batch_size': None,
[36m(TaskRunner pid=379036)[0m           'val_files': '/workspace/data/aime-2024.parquet',
[36m(TaskRunner pid=379036)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=379036)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=379036)[0m  'ray_init': {'num_cpus': None, 'timeline_json_file': None},
[36m(TaskRunner pid=379036)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=379036)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=379036)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=379036)[0m                   'max_length': None,
[36m(TaskRunner pid=379036)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=379036)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=379036)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=379036)[0m                             'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=379036)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=379036)[0m                                             'param_offload': False,
[36m(TaskRunner pid=379036)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=379036)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=379036)[0m                             'input_tokenizer': '/workspace/models/Qwen/Qwen2-7B-Instruct',
[36m(TaskRunner pid=379036)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=379036)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=379036)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=379036)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=379036)[0m                             'use_shm': False},
[36m(TaskRunner pid=379036)[0m                   'overlong_buffer': {'enable': True,
[36m(TaskRunner pid=379036)[0m                                       'len': 512,
[36m(TaskRunner pid=379036)[0m                                       'log': False,
[36m(TaskRunner pid=379036)[0m                                       'penalty_factor': 1.0},
[36m(TaskRunner pid=379036)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=379036)[0m                                'all_ranks': False,
[36m(TaskRunner pid=379036)[0m                                'discrete': False,
[36m(TaskRunner pid=379036)[0m                                'ranks': []},
[36m(TaskRunner pid=379036)[0m                   'reward_manager': 'dapo',
[36m(TaskRunner pid=379036)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=379036)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=379036)[0m                                      'url': None},
[36m(TaskRunner pid=379036)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=379036)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=379036)[0m                   'use_dynamic_bsz': True},
[36m(TaskRunner pid=379036)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=379036)[0m              'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=379036)[0m                                            'cuda-memory-usage': 'true',
[36m(TaskRunner pid=379036)[0m                                            'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=379036)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=379036)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=379036)[0m              'default_local_dir': '/workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test',
[36m(TaskRunner pid=379036)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=379036)[0m              'device': 'cuda',
[36m(TaskRunner pid=379036)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=379036)[0m              'experiment_name': 'DAPO-Qwen2-7B-Test',
[36m(TaskRunner pid=379036)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=379036)[0m              'logger': ['console', 'tensorboard'],
[36m(TaskRunner pid=379036)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=379036)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=379036)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=379036)[0m              'nnodes': 1,
[36m(TaskRunner pid=379036)[0m              'npu_profile': {'options': {'analysis': True,
[36m(TaskRunner pid=379036)[0m                                          'level': 'level1',
[36m(TaskRunner pid=379036)[0m                                          'record_shapes': False,
[36m(TaskRunner pid=379036)[0m                                          'save_path': './profiler_data',
[36m(TaskRunner pid=379036)[0m                                          'with_cpu': True,
[36m(TaskRunner pid=379036)[0m                                          'with_memory': False,
[36m(TaskRunner pid=379036)[0m                                          'with_module': False,
[36m(TaskRunner pid=379036)[0m                                          'with_npu': True,
[36m(TaskRunner pid=379036)[0m                                          'with_stack': False}},
[36m(TaskRunner pid=379036)[0m              'profile_steps': None,
[36m(TaskRunner pid=379036)[0m              'project_name': 'DAPO',
[36m(TaskRunner pid=379036)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=379036)[0m              'resume_from_path': None,
[36m(TaskRunner pid=379036)[0m              'resume_mode': 'disable',
[36m(TaskRunner pid=379036)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=379036)[0m              'save_freq': 20,
[36m(TaskRunner pid=379036)[0m              'test_freq': 10,
[36m(TaskRunner pid=379036)[0m              'total_epochs': 50,
[36m(TaskRunner pid=379036)[0m              'total_training_steps': 50,
[36m(TaskRunner pid=379036)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=379036)[0m              'val_before_train': True,
[36m(TaskRunner pid=379036)[0m              'val_only': False,
[36m(TaskRunner pid=379036)[0m              'validation_data_dir': None,
[36m(TaskRunner pid=379036)[0m              'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=379036)[0m                                        'capture-range-end': None,
[36m(TaskRunner pid=379036)[0m                                        'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=379036)[0m                                        'cuda-memory-usage': 'true',
[36m(TaskRunner pid=379036)[0m                                        'kill': 'none',
[36m(TaskRunner pid=379036)[0m                                        'trace': 'cuda,nvtx,cublas,ucx'}}}
[36m(TaskRunner pid=379036)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=379036)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=379036)[0m dataset len: 1791700
[36m(TaskRunner pid=379036)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=379036)[0m dataset len: 960
[36m(TaskRunner pid=379036)[0m Size of train dataloader: 1166, Size of val dataloader: 1
[36m(TaskRunner pid=379036)[0m Total training steps: 50
[36m(TaskRunner pid=379036)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(WorkerDict pid=379911)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=379911)[0m   "architectures": [
[36m(WorkerDict pid=379911)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=379911)[0m   ],
[36m(WorkerDict pid=379911)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=379911)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=379911)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=379911)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=379911)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=379911)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=379911)[0m   "layer_types": [
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention",
[36m(WorkerDict pid=379911)[0m     "full_attention"
[36m(WorkerDict pid=379911)[0m   ],
[36m(WorkerDict pid=379911)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=379911)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=379911)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=379911)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=379911)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=379911)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=379911)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=379911)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=379911)[0m   "rope_scaling": null,
[36m(WorkerDict pid=379911)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=379911)[0m   "sliding_window": null,
[36m(WorkerDict pid=379911)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=379911)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=379911)[0m   "transformers_version": "4.53.0",
[36m(WorkerDict pid=379911)[0m   "use_cache": true,
[36m(WorkerDict pid=379911)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=379911)[0m   "vocab_size": 152064
[36m(WorkerDict pid=379911)[0m }
[36m(WorkerDict pid=379911)[0m 
[36m(WorkerDict pid=379911)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=379911)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=379911)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=379911)[0m wrap_policy: functools.partial(<function _or_policy at 0x7ee7194e6e60>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7ee7194e6d40>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=379911)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=379911)[0m Total steps: 50, num_warmup_steps: 10
[36m(WorkerDict pid=379911)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=379911)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=384150)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=384150)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=379911)[0m WARNING 07-22 18:33:33 [cuda.py:93] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=379911)[0m WARNING 07-22 18:33:33 [utils.py:2522] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7ee5add77cd0>
[36m(WorkerDict pid=379911)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 2048, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1.0, 'ignore_eos': False}
[36m(WorkerDict pid=384149)[0m WARNING 07-22 18:33:33 [cuda.py:93] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=384149)[0m WARNING 07-22 18:33:33 [utils.py:2522] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7fbcfb684190>[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=379036)[0m Saving tensorboard log to /workspace/log/tensorboard/DAPO/DAPO-Qwen2-7B-Test.
[36m(TaskRunner pid=379036)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 0}
[36m(TaskRunner pid=379036)[0m validation generation end
[36m(WorkerDict pid=384153)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 2048, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1.0, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=379036)[0m [prompt] system
[36m(TaskRunner pid=379036)[0m You are a helpful assistant.
[36m(TaskRunner pid=379036)[0m user
[36m(TaskRunner pid=379036)[0m Solve the following math problem step by step. The last line of your response should be of the form Answer: $Answer (without quotes) where $Answer is the answer to the problem.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Find the largest possible real part of \[(75+117i)z+\frac{96+144i}{z}\]where $z$ is a complex number with $|z|=4$.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Remember to put your answer on its own line after "Answer:".
[36m(TaskRunner pid=379036)[0m assistant
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m [response] To find the largest possible real part of the given expression, we consider the given equation:
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m \[A = 75z + 117iz + \frac{96}{z} + \frac{144i}{z}\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Given that \(|z| = 4\), we can use properties of complex numbers and conjugates. We want to express the given equation in a form where we can separate the real and imaginary parts easily to maximize the real part.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m \[A = 75z + 117iz + \frac{96}{z} + \frac{144i}{z}\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m \[A = z(75 + 117i) + \frac{96 + 144i}{z}\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Let's find the real part of \(A\), denoted as \(\Re(A)\):
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m \[\Re(A) = 75\Re(z) + 96\Re(\frac{1}{z})\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Since \(|z| = 4\), we know that \(\Re(z)^2 + \Im(z)^2 = 16\), which allows us to find bounds for \(\Re(z)\) and \(\Im(z)\).
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m The largest possible value for \(\Re(z)\) or \(-\Re(z)\) occurs when the other is 0. In such a case, points with positive/maximum real parts would be along the x-axis (certain points on the line \(x = 4\), for instance). 
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Next, consider \(\Re(\frac{1}{z})\). The reciprocal of any complex number also has that magnitude squared (\(|z|^2 = 16\)), thus \(\Re(\frac{1}{z})\) can equal 1 (when \(z\) is one of the points one unit out along the x-axis since \(|z| = 4\)), making \(\Re(\frac{96}{z}) = 96 \times \Re(\frac{1}{z}) = 96\).
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Therefore, to maximize \(\Re(A)\), maximize \(\Re(z)\) and thus \(\Re(\frac{1}{z})\) with this in mind. The maximum real value is essentially found when maximizing the coefficient of \(\Re(z)\):
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m \[A = 75 \cdot 4 + 96 = 300 + 96 = 396\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Thus, the largest possible value for the real part of the given equation is 396.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Answer: 396
[36m(TaskRunner pid=379036)[0m [ground_truth] 540
[36m(TaskRunner pid=379036)[0m [score] -1.0
[36m(TaskRunner pid=379036)[0m [acc] False
[36m(TaskRunner pid=379036)[0m [pred] 396
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['reward']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['score']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['acc']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['pred']: 960
[36m(TaskRunner pid=379036)[0m ("Initial validation metrics: {'val-aux/math_dapo/reward/mean@32': "
[36m(TaskRunner pid=379036)[0m  "-1.011981201171875, 'val-aux/math_dapo/reward/std@32': 0.16584373831620353, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@2/mean': -0.9711487630208333, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@2/std': 0.11719291605452892, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@2/mean': -1.0499709635416667, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@2/std': 0.15854580927674575, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@2/mean': -1.0109345703125, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@2/std': 0.16712599400284944, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@4/mean': -0.9441367187499999, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@4/std': 0.12257252578171521, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@4/mean': -1.0986387369791664, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@4/std': 0.20233826957466966, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@4/mean': -1.0185968749999998, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@4/std': 0.17571095183248792, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@8/mean': -0.9024000000000001, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@8/std': 0.14883395697027207, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@8/mean': -1.1759683593749999, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@8/std': 0.24608168988768347, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@8/mean': -1.0314412760416665, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@8/std': 0.1919513535615655, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@16/mean': -0.8340666666666666, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@16/std': 0.16174073790111101, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@16/mean': -1.2849637369791664, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@16/std': 0.26393847242977575, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@16/mean': -1.04282734375, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@16/std': 0.20037642741472048, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@32/mean': -0.7572, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@32/std': 0.14030970055555905, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@32/mean': -1.4153235677083333, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@32/std': 0.2319129082754917, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@32/mean': -1.0565229166666665, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@32/std': 0.20403524779766913, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/mean@32': -0.9854166666666667, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/std@32': 0.06707338848608278, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@2/mean': -0.9694, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@2/std': 0.09465785330915495, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@2/mean': -0.9993333333333333, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@2/std': 0.012939503204911657, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@2/mean': -0.9845333333333334, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@2/std': 0.0687283636983794, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@4/mean': -0.9441333333333333, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@4/std': 0.1224655230482878, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@4/mean': -1.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@4/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@4/mean': -0.9858, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@4/std': 0.06637185548260385, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@8/mean': -0.9024000000000001, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@8/std': 0.14883395697027207, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@8/mean': -1.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@8/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@8/mean': -0.9860000000000001, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@8/std': 0.06424752330905685, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@16/mean': -0.8340666666666666, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@16/std': 0.16174073790111101, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@16/mean': -1.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@16/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@16/mean': -0.9872666666666667, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@16/std': 0.0596997420025696, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@32/mean': -0.7572, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@32/std': 0.14030970055555905, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@32/mean': -1.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@32/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@32/mean': -0.9896666666666667, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@32/std': 0.04883325132607814, "
[36m(TaskRunner pid=379036)[0m  "'val-core/math_dapo/acc/mean@32': 0.007291666666666667, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/std@32': 0.03353669424304139, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/best@2/mean': 0.015300000000000001, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/best@2/std': 0.047328926654577476, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@2/mean': 0.0003333333333333334, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@2/std': 0.006469751602455828, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/maj@2/mean': 0.0077333333333333325, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/maj@2/std': 0.0343641818491897, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/best@4/mean': 0.02793333333333333, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/best@4/std': 0.0612327615241439, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@4/mean': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@4/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/maj@4/mean': 0.0070999999999999995, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/maj@4/std': 0.03318592774130193, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/best@8/mean': 0.048799999999999996, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/best@8/std': 0.07441697848513604, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@8/mean': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@8/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/maj@8/mean': 0.007, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/maj@8/std': 0.032123761654528425, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/best@16/mean': 0.08296666666666666, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/best@16/std': 0.08087036895055551, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@16/mean': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@16/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/maj@16/mean': 0.006366666666666667, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/maj@16/std': 0.0298498710012848, "
[36m(TaskRunner pid=379036)[0m  "'val-core/math_dapo/acc/best@32/mean': 0.12140000000000001, "
[36m(TaskRunner pid=379036)[0m  "'val-core/math_dapo/acc/best@32/std': 0.07015485027777953, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@32/mean': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@32/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-core/math_dapo/acc/maj@32/mean': 0.005166666666666667, "
[36m(TaskRunner pid=379036)[0m  "'val-core/math_dapo/acc/maj@32/std': 0.024416625663039062}")
[36m(TaskRunner pid=379036)[0m step:0 - val-aux/math_dapo/reward/mean@32:-1.011981201171875 - val-aux/math_dapo/reward/std@32:0.16584373831620353 - val-aux/math_dapo/reward/best@2/mean:-0.9711487630208333 - val-aux/math_dapo/reward/best@2/std:0.11719291605452892 - val-aux/math_dapo/reward/worst@2/mean:-1.0499709635416667 - val-aux/math_dapo/reward/worst@2/std:0.15854580927674575 - val-aux/math_dapo/reward/maj@2/mean:-1.0109345703125 - val-aux/math_dapo/reward/maj@2/std:0.16712599400284944 - val-aux/math_dapo/reward/best@4/mean:-0.9441367187499999 - val-aux/math_dapo/reward/best@4/std:0.12257252578171521 - val-aux/math_dapo/reward/worst@4/mean:-1.0986387369791664 - val-aux/math_dapo/reward/worst@4/std:0.20233826957466966 - val-aux/math_dapo/reward/maj@4/mean:-1.0185968749999998 - val-aux/math_dapo/reward/maj@4/std:0.17571095183248792 - val-aux/math_dapo/reward/best@8/mean:-0.9024000000000001 - val-aux/math_dapo/reward/best@8/std:0.14883395697027207 - val-aux/math_dapo/reward/worst@8/mean:-1.1759683593749999 - val-aux/math_dapo/reward/worst@8/std:0.24608168988768347 - val-aux/math_dapo/reward/maj@8/mean:-1.0314412760416665 - val-aux/math_dapo/reward/maj@8/std:0.1919513535615655 - val-aux/math_dapo/reward/best@16/mean:-0.8340666666666666 - val-aux/math_dapo/reward/best@16/std:0.16174073790111101 - val-aux/math_dapo/reward/worst@16/mean:-1.2849637369791664 - val-aux/math_dapo/reward/worst@16/std:0.26393847242977575 - val-aux/math_dapo/reward/maj@16/mean:-1.04282734375 - val-aux/math_dapo/reward/maj@16/std:0.20037642741472048 - val-aux/math_dapo/reward/best@32/mean:-0.7572 - val-aux/math_dapo/reward/best@32/std:0.14030970055555905 - val-aux/math_dapo/reward/worst@32/mean:-1.4153235677083333 - val-aux/math_dapo/reward/worst@32/std:0.2319129082754917 - val-aux/math_dapo/reward/maj@32/mean:-1.0565229166666665 - val-aux/math_dapo/reward/maj@32/std:0.20403524779766913 - val-aux/math_dapo/score/mean@32:-0.9854166666666667 - val-aux/math_dapo/score/std@32:0.06707338848608278 - val-aux/math_dapo/score/best@2/mean:-0.9694 - val-aux/math_dapo/score/best@2/std:0.09465785330915495 - val-aux/math_dapo/score/worst@2/mean:-0.9993333333333333 - val-aux/math_dapo/score/worst@2/std:0.012939503204911657 - val-aux/math_dapo/score/maj@2/mean:-0.9845333333333334 - val-aux/math_dapo/score/maj@2/std:0.0687283636983794 - val-aux/math_dapo/score/best@4/mean:-0.9441333333333333 - val-aux/math_dapo/score/best@4/std:0.1224655230482878 - val-aux/math_dapo/score/worst@4/mean:-1.0 - val-aux/math_dapo/score/worst@4/std:0.0 - val-aux/math_dapo/score/maj@4/mean:-0.9858 - val-aux/math_dapo/score/maj@4/std:0.06637185548260385 - val-aux/math_dapo/score/best@8/mean:-0.9024000000000001 - val-aux/math_dapo/score/best@8/std:0.14883395697027207 - val-aux/math_dapo/score/worst@8/mean:-1.0 - val-aux/math_dapo/score/worst@8/std:0.0 - val-aux/math_dapo/score/maj@8/mean:-0.9860000000000001 - val-aux/math_dapo/score/maj@8/std:0.06424752330905685 - val-aux/math_dapo/score/best@16/mean:-0.8340666666666666 - val-aux/math_dapo/score/best@16/std:0.16174073790111101 - val-aux/math_dapo/score/worst@16/mean:-1.0 - val-aux/math_dapo/score/worst@16/std:0.0 - val-aux/math_dapo/score/maj@16/mean:-0.9872666666666667 - val-aux/math_dapo/score/maj@16/std:0.0596997420025696 - val-aux/math_dapo/score/best@32/mean:-0.7572 - val-aux/math_dapo/score/best@32/std:0.14030970055555905 - val-aux/math_dapo/score/worst@32/mean:-1.0 - val-aux/math_dapo/score/worst@32/std:0.0 - val-aux/math_dapo/score/maj@32/mean:-0.9896666666666667 - val-aux/math_dapo/score/maj@32/std:0.04883325132607814 - val-core/math_dapo/acc/mean@32:0.007291666666666667 - val-aux/math_dapo/acc/std@32:0.03353669424304139 - val-aux/math_dapo/acc/best@2/mean:0.015300000000000001 - val-aux/math_dapo/acc/best@2/std:0.047328926654577476 - val-aux/math_dapo/acc/worst@2/mean:0.0003333333333333334 - val-aux/math_dapo/acc/worst@2/std:0.006469751602455828 - val-aux/math_dapo/acc/maj@2/mean:0.0077333333333333325 - val-aux/math_dapo/acc/maj@2/std:0.0343641818491897 - val-aux/math_dapo/acc/best@4/mean:0.02793333333333333 - val-aux/math_dapo/acc/best@4/std:0.0612327615241439 - val-aux/math_dapo/acc/worst@4/mean:0.0 - val-aux/math_dapo/acc/worst@4/std:0.0 - val-aux/math_dapo/acc/maj@4/mean:0.0070999999999999995 - val-aux/math_dapo/acc/maj@4/std:0.03318592774130193 - val-aux/math_dapo/acc/best@8/mean:0.048799999999999996 - val-aux/math_dapo/acc/best@8/std:0.07441697848513604 - val-aux/math_dapo/acc/worst@8/mean:0.0 - val-aux/math_dapo/acc/worst@8/std:0.0 - val-aux/math_dapo/acc/maj@8/mean:0.007 - val-aux/math_dapo/acc/maj@8/std:0.032123761654528425 - val-aux/math_dapo/acc/best@16/mean:0.08296666666666666 - val-aux/math_dapo/acc/best@16/std:0.08087036895055551 - val-aux/math_dapo/acc/worst@16/mean:0.0 - val-aux/math_dapo/acc/worst@16/std:0.0 - val-aux/math_dapo/acc/maj@16/mean:0.006366666666666667 - val-aux/math_dapo/acc/maj@16/std:0.0298498710012848 - val-core/math_dapo/acc/best@32/mean:0.12140000000000001 - val-core/math_dapo/acc/best@32/std:0.07015485027777953 - val-aux/math_dapo/acc/worst@32/mean:0.0 - val-aux/math_dapo/acc/worst@32/std:0.0 - val-core/math_dapo/acc/maj@32/mean:0.005166666666666667 - val-core/math_dapo/acc/maj@32/std:0.024416625663039062
[36m(TaskRunner pid=379036)[0m step:1 - global_seqlen/min:869769 - global_seqlen/max:932691 - global_seqlen/minmax_diff:62922 - global_seqlen/balanced_min:896777 - global_seqlen/balanced_max:896778 - global_seqlen/mean:896777.875 - actor/entropy:1.3548299074172974 - actor/pg_loss:0.20135506448843252 - actor/pg_clipfrac:1.9387662887754964e-05 - actor/ppo_kl:-7.012304535222702e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.49071616120636463 - perf/mfu/actor:0.389350007441482 - perf/max_memory_allocated_gb:82.31018924713135 - perf/max_memory_reserved_gb:105.609375 - perf/cpu_memory_used_gb:227.97089385986328 - actor/lr:0.0 - critic/score/mean:-0.8027489185333252 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.8027489185333252 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.193579763174057 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499847412109375 - critic/returns/mean:-0.193579763174057 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499847412109375 - response_length/mean:715.6990966796875 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0157470703125 - prompt_length/mean:160.060546875 - prompt_length/max:617.0 - prompt_length/min:86.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.0358169674873352e-05 - timing_s/generate_sequences:416.70233154296875 - timing_s/reshard:4.634781837463379 - timing_s/gen:454.98630315158516 - timing_s/reward:11.614959873259068 - timing_s/old_log_prob:83.68062861077487 - timing_s/adv:0.5147378742694855 - timing_s/update_actor:347.66132444888353 - timing_s/step:900.4576853066683 - timing_s/stop_profile:1.2442469596862793e-06 - timing_per_token_ms/gen:0.07760289270532769 - timing_per_token_ms/update_actor:0.04845978783331429 - timing_per_token_ms/adv:7.174824009087611e-05 - perf/total_num_tokens:7174223 - perf/time_per_step:900.4576853066683 - perf/throughput:995.913400077856 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:2 - global_seqlen/min:817891 - global_seqlen/max:920384 - global_seqlen/minmax_diff:102493 - global_seqlen/balanced_min:884004 - global_seqlen/balanced_max:884005 - global_seqlen/mean:884004.375 - actor/entropy:1.3453344106674194 - actor/pg_loss:0.16833920145791872 - actor/pg_clipfrac:0.00015051224312867176 - actor/ppo_kl:9.016880315098355e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.4791371300816536 - perf/mfu/actor:0.39694506941848495 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:105.90625 - perf/cpu_memory_used_gb:229.16016006469727 - actor/lr:1e-07 - critic/score/mean:-0.7877821922302246 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.7877821922302246 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.18663930892944336 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.18663930892944336 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:702.6292724609375 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.015380859375 - prompt_length/mean:160.65625 - prompt_length/max:1115.0 - prompt_length/min:86.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.7283247113227844e-06 - timing_s/generate_sequences:415.2803649902344 - timing_s/reshard:4.092172622680664 - timing_s/gen:454.20743176713586 - timing_s/reward:11.40845650061965 - timing_s/old_log_prob:82.04248535912484 - timing_s/adv:0.23450180888175964 - timing_s/update_actor:335.8559595514089 - timing_s/step:885.6098190369084 - timing_s/stop_profile:1.2218952178955078e-06 - timing_per_token_ms/gen:0.07891109196381961 - timing_per_token_ms/update_actor:0.047490709470669884 - timing_per_token_ms/adv:3.3159028325193474e-05 - perf/total_num_tokens:7072035 - perf/time_per_step:885.6098190369084 - perf/throughput:998.1871880794475 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:3 - global_seqlen/min:833489 - global_seqlen/max:916047 - global_seqlen/minmax_diff:82558 - global_seqlen/balanced_min:881462 - global_seqlen/balanced_max:881462 - global_seqlen/mean:881462.0 - actor/entropy:1.3571768999099731 - actor/pg_loss:0.23436907625024314 - actor/pg_clipfrac:0.00017036210920196027 - actor/ppo_kl:2.599659006539353e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5085882097482681 - perf/mfu/actor:0.3927856881760141 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:110.068359375 - perf/cpu_memory_used_gb:229.03218841552734 - actor/lr:2e-07 - critic/score/mean:-0.8021564483642578 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.8021564483642578 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.20409424602985382 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.20409424602985382 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:700.431640625 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0150146484375 - prompt_length/mean:160.37109375 - prompt_length/max:787.0 - prompt_length/min:84.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.3527612686157227e-06 - timing_s/generate_sequences:418.7208557128906 - timing_s/reshard:3.679055690765381 - timing_s/gen:443.94013350550085 - timing_s/reward:11.622534055262804 - timing_s/old_log_prob:82.19791200198233 - timing_s/adv:0.2401402685791254 - timing_s/update_actor:338.7029917445034 - timing_s/step:878.6131375702098 - timing_s/stop_profile:1.321546733379364e-06 - timing_per_token_ms/gen:0.07736930727451488 - timing_per_token_ms/update_actor:0.04803142275907858 - timing_per_token_ms/adv:3.4054257100579124e-05 - perf/total_num_tokens:7051696 - perf/time_per_step:878.6131375702098 - perf/throughput:1003.2424537125278 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:4 - global_seqlen/min:833733 - global_seqlen/max:914787 - global_seqlen/minmax_diff:81054 - global_seqlen/balanced_min:869754 - global_seqlen/balanced_max:869755 - global_seqlen/mean:869754.375 - actor/entropy:1.319869875907898 - actor/pg_loss:0.13486894198273855 - actor/pg_clipfrac:0.0004752153756331714 - actor/ppo_kl:0.00018532606599710712 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.486602034419775 - perf/mfu/actor:0.3942085610670555 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:110.068359375 - perf/cpu_memory_used_gb:229.16399002075195 - actor/lr:3e-07 - critic/score/mean:-0.7839868068695068 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.7839868068695068 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.1684534102678299 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499847412109375 - critic/returns/mean:-0.1684534102678299 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499847412109375 - response_length/mean:682.8382568359375 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.01171875 - prompt_length/mean:166.53125 - prompt_length/max:1115.0 - prompt_length/min:86.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.21120023727417e-06 - timing_s/generate_sequences:400.4308776855469 - timing_s/reshard:3.456441879272461 - timing_s/gen:422.39712367393076 - timing_s/reward:11.608250571414828 - timing_s/old_log_prob:83.01356370840222 - timing_s/adv:0.22040238976478577 - timing_s/update_actor:332.52463918179274 - timing_s/step:851.6351422872394 - timing_s/stop_profile:1.1641532182693481e-06 - timing_per_token_ms/gen:0.07551151150332587 - timing_per_token_ms/update_actor:0.047790021059364134 - timing_per_token_ms/adv:3.167595301903278e-05 - perf/total_num_tokens:6958035 - perf/time_per_step:851.6351422872394 - perf/throughput:1021.2758161483305 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:5 - global_seqlen/min:742661 - global_seqlen/max:811925 - global_seqlen/minmax_diff:69264 - global_seqlen/balanced_min:780875 - global_seqlen/balanced_max:780876 - global_seqlen/mean:780875.75 - actor/entropy:1.1609777212142944 - actor/pg_loss:0.1644645447008379 - actor/pg_clipfrac:0.0008358549126750491 - actor/ppo_kl:0.0002557767993818138 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.4684839826077223 - perf/mfu/actor:0.38703732935899626 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:228.9772071838379 - actor/lr:4e-07 - critic/score/mean:-0.6959691047668457 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.6959691047668457 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.13105864822864532 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.13105864822864532 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:604.933349609375 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.0064697265625 - prompt_length/mean:157.640625 - prompt_length/max:602.0 - prompt_length/min:84.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.849156200885773e-06 - timing_s/generate_sequences:364.5533142089844 - timing_s/reshard:4.697788238525391 - timing_s/gen:381.6110492050648 - timing_s/reward:11.114954935386777 - timing_s/old_log_prob:73.129120785743 - timing_s/adv:0.23675766959786415 - timing_s/update_actor:303.2729651853442 - timing_s/step:771.2454159110785 - timing_s/stop_profile:1.4258548617362976e-06 - timing_per_token_ms/gen:0.07700580578008391 - timing_per_token_ms/update_actor:0.0485469303511705 - timing_per_token_ms/adv:3.78993824558299e-05 - perf/total_num_tokens:6247006 - perf/time_per_step:771.2454159110785 - perf/throughput:1012.4867310589394 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:6 - global_seqlen/min:643732 - global_seqlen/max:730656 - global_seqlen/minmax_diff:86924 - global_seqlen/balanced_min:680346 - global_seqlen/balanced_max:680346 - global_seqlen/mean:680346.0 - actor/entropy:0.9796378016471863 - actor/pg_loss:0.03864207744137735 - actor/pg_clipfrac:0.0007845747066468942 - actor/ppo_kl:0.00017760013274441283 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.47311597876250744 - perf/mfu/actor:0.3989847990832215 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:228.95126724243164 - actor/lr:5e-07 - critic/score/mean:-0.5843284130096436 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.5843284130096436 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.06772062182426453 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.06772062182426453 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:504.958984375 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0013427734375 - prompt_length/mean:159.44140625 - prompt_length/max:1241.0 - prompt_length/min:83.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.0351802706718445e-06 - timing_s/generate_sequences:318.4513854980469 - timing_s/reshard:3.5921449661254883 - timing_s/gen:342.2749428767711 - timing_s/reward:10.42379004880786 - timing_s/old_log_prob:63.99527600873262 - timing_s/adv:0.2563781049102545 - timing_s/update_actor:255.5713746380061 - timing_s/step:674.2758139288053 - timing_s/stop_profile:1.3671815395355225e-06 - timing_per_token_ms/gen:0.08274258015153688 - timing_per_token_ms/update_actor:0.0469561397138379 - timing_per_token_ms/adv:4.710436030164329e-05 - perf/total_num_tokens:5442768 - perf/time_per_step:674.2758139288053 - perf/throughput:1009.0025267788052 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:7 - global_seqlen/min:619198 - global_seqlen/max:668414 - global_seqlen/minmax_diff:49216 - global_seqlen/balanced_min:649230 - global_seqlen/balanced_max:649231 - global_seqlen/mean:649230.875 - actor/entropy:0.9063263535499573 - actor/pg_loss:0.008260853687501409 - actor/pg_clipfrac:0.0013766101487255602 - actor/ppo_kl:0.0002640976046442641 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.47859132289886475 - perf/mfu/actor:0.3972871220414509 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:228.83105850219727 - actor/lr:6e-07 - critic/score/mean:-0.5851070880889893 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.5851070880889893 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.03758014738559723 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.03758014738559723 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:476.2879638671875 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.00048828125 - prompt_length/mean:157.7265625 - prompt_length/max:540.0 - prompt_length/min:84.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.3229589462280273e-06 - timing_s/generate_sequences:289.471923828125 - timing_s/reshard:3.5780837535858154 - timing_s/gen:309.30985556542873 - timing_s/reward:10.47697551175952 - timing_s/old_log_prob:62.76707799360156 - timing_s/adv:0.24340810999274254 - timing_s/update_actor:244.5853356057778 - timing_s/step:629.0486451014876 - timing_s/stop_profile:1.3541430234909058e-06 - timing_per_token_ms/gen:0.07927462710086541 - timing_per_token_ms/update_actor:0.047091363223787264 - timing_per_token_ms/adv:4.686470548569154e-05 - perf/total_num_tokens:5193847 - perf/time_per_step:629.0486451014876 - perf/throughput:1032.0837347885174 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:8 - global_seqlen/min:606578 - global_seqlen/max:659639 - global_seqlen/minmax_diff:53061 - global_seqlen/balanced_min:630170 - global_seqlen/balanced_max:630171 - global_seqlen/mean:630170.75 - actor/entropy:0.8156071305274963 - actor/pg_loss:0.061343802265730836 - actor/pg_clipfrac:0.0007639246815774957 - actor/ppo_kl:6.487769080167233e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.47440702840685844 - perf/mfu/actor:0.4046102580538521 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:229.21647262573242 - actor/lr:7e-07 - critic/score/mean:-0.5848050117492676 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.5848050117492676 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.04754570126533508 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.04754570126533508 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:455.973388671875 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.0025634765625 - prompt_length/mean:159.427734375 - prompt_length/max:788.0 - prompt_length/min:83.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.8889626264572144e-06 - timing_s/generate_sequences:277.75006103515625 - timing_s/reshard:3.405134677886963 - timing_s/gen:302.01483329199255 - timing_s/reward:9.99614738766104 - timing_s/old_log_prob:59.738359534181654 - timing_s/adv:0.23773734085261822 - timing_s/update_actor:233.05581043567508 - timing_s/step:606.7395575959235 - timing_s/stop_profile:1.1986121535301208e-06 - timing_per_token_ms/gen:0.08085350153212338 - timing_per_token_ms/update_actor:0.04622870278326848 - timing_per_token_ms/adv:4.715732617957479e-05 - perf/total_num_tokens:5041366 - perf/time_per_step:606.7395575959235 - perf/throughput:1038.6182046493186 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:9 - global_seqlen/min:585510 - global_seqlen/max:646975 - global_seqlen/minmax_diff:61465 - global_seqlen/balanced_min:614062 - global_seqlen/balanced_max:614063 - global_seqlen/mean:614062.125 - actor/entropy:0.770089328289032 - actor/pg_loss:0.03662472156784768 - actor/pg_clipfrac:0.0012618369066838694 - actor/ppo_kl:0.0002185481618618914 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.49197095073759556 - perf/mfu/actor:0.4008475329065278 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:228.78036499023438 - actor/lr:8e-07 - critic/score/mean:-0.548828125 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.548828125 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.03677862510085106 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.03677862510085106 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:440.4708251953125 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0018310546875 - prompt_length/mean:159.19921875 - prompt_length/max:787.0 - prompt_length/min:85.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.9616057872772217e-06 - timing_s/generate_sequences:267.5331726074219 - timing_s/reshard:4.143799304962158 - timing_s/gen:293.1605053842068 - timing_s/reward:9.616044806316495 - timing_s/old_log_prob:57.87420118693262 - timing_s/adv:0.25511972792446613 - timing_s/update_actor:229.10544055327773 - timing_s/step:591.6934785395861 - timing_s/stop_profile:1.109205186367035e-06 - timing_per_token_ms/gen:0.08124532309044492 - timing_per_token_ms/update_actor:0.046637268288057525 - timing_per_token_ms/adv:5.193280075783581e-05 - perf/total_num_tokens:4912497 - perf/time_per_step:591.6934785395861 - perf/throughput:1037.8044498912243 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 10}
[36m(TaskRunner pid=379036)[0m validation generation end
[36m(TaskRunner pid=379036)[0m [prompt] system
[36m(TaskRunner pid=379036)[0m You are a helpful assistant.
[36m(TaskRunner pid=379036)[0m user
[36m(TaskRunner pid=379036)[0m Solve the following math problem step by step. The last line of your response should be of the form Answer: $Answer (without quotes) where $Answer is the answer to the problem.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Find the largest possible real part of \[(75+117i)z+\frac{96+144i}{z}\]where $z$ is a complex number with $|z|=4$.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Remember to put your answer on its own line after "Answer:".
[36m(TaskRunner pid=379036)[0m assistant
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m [response] To solve this problem, we first rewrite the expression as a single real part maxima optimization problem involving a complex number $z$. We start with the given expression \[(75+117i)z+\frac{96+144i}{z}\].
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Given that $|z|=4$, let's express $z = x + yi$, where $x$ and $y$ are real numbers. It's important to note that since the modulus of $z$ is 4, we have $|z|^2 = x^2 + y^2 = 16$.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m We can rewrite the expression as:
[36m(TaskRunner pid=379036)[0m \[(75z + \frac{96+144i}{z}) = (75x + 96)i + 75y + (117x - 144)i + 117y\]
[36m(TaskRunner pid=379036)[0m Combining like terms:
[36m(TaskRunner pid=379036)[0m \[= (75x + 117y) + (75y - 144)i\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m The real part of this expression is: 
[36m(TaskRunner pid=379036)[0m \[75x + 117y\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m This is an optimization problem with respect to $x$ and $y$ subject to the constraint $x^2 + y^2 = 16$. We wish to maximize $75x + 117y$ under this constraint.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m To simplify this optimization problem, we recognize that the maximum value of the expression is achieved when the two coefficients of $x$ and $y$ are equal to the maximum slope attainable on the circle $x^2 + y^2 = 16$, which can be represented as the projection of the vector $(117, 75)$ onto the circle's tangent at any point on the circle.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m The angle $\theta$ that the tangent vector $(117, 75)$ makes with the positive x-axis can be found using the slope $m = \frac{75}{117}$, thus $\tan(\theta) = m$. The cosine of this angle gives us the proportion of the maximum real part we can achieve out of 16 in our constraint, because of how it relates to projecting the vector onto the available circle's radius.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m So, $\cos(\theta) = \frac{1}{\sqrt{1+m^2}}$. Calculate $\cos(\theta)$:
[36m(TaskRunner pid=379036)[0m \[\cos(\theta) = \frac{1}{\sqrt{1+\left(\frac{75}{117}\right)^2}} = \frac{1}{\sqrt{1+\left(\frac{25}{39}\right)^2}} = \frac{1}{\sqrt{1+\frac{625}{1521}}} = \frac{1}{\sqrt{\frac{2146}{1521}}} = \frac{39}{\sqrt{2146}}\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Considering $|z|^2 = 16$, the maximum value we can achieve is:
[36m(TaskRunner pid=379036)[0m \[16 \cdot \cos(\theta) = 16 \cdot \frac{39}{\sqrt{2146}}\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Simplify and calculate the value:
[36m(TaskRunner pid=379036)[0m \[\frac{624}{\sqrt{2146}} = \frac{624}{\sqrt{2146}}\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Answer: $624$
[36m(TaskRunner pid=379036)[0m [ground_truth] 540
[36m(TaskRunner pid=379036)[0m [score] -1.0
[36m(TaskRunner pid=379036)[0m [acc] False
[36m(TaskRunner pid=379036)[0m [pred] 624
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['reward']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['score']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['acc']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['pred']: 960
[36m(TaskRunner pid=379036)[0m step:10 - global_seqlen/min:599176 - global_seqlen/max:678242 - global_seqlen/minmax_diff:79066 - global_seqlen/balanced_min:642800 - global_seqlen/balanced_max:642801 - global_seqlen/mean:642800.375 - actor/entropy:0.7378507256507874 - actor/pg_loss:0.03602388552171358 - actor/pg_clipfrac:0.0008552399099269336 - actor/ppo_kl:0.00016929250734935237 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.47427961975336075 - perf/mfu/actor:0.3941535462022066 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:229.57101440429688 - actor/lr:9e-07 - val-aux/math_dapo/reward/mean@32:-0.975 - val-aux/math_dapo/reward/std@32:0.07704943758927256 - val-aux/math_dapo/reward/best@2/mean:-0.9544666666666667 - val-aux/math_dapo/reward/best@2/std:0.09937795485239939 - val-aux/math_dapo/reward/worst@2/mean:-0.9973333333333333 - val-aux/math_dapo/reward/worst@2/std:0.025566056728605274 - val-aux/math_dapo/reward/maj@2/mean:-0.9760000000000001 - val-aux/math_dapo/reward/maj@2/std:0.07583204176976732 - val-aux/math_dapo/reward/best@4/mean:-0.9150666666666667 - val-aux/math_dapo/reward/best@4/std:0.12276829357793867 - val-aux/math_dapo/reward/worst@4/mean:-1.0 - val-aux/math_dapo/reward/worst@4/std:0.0 - val-aux/math_dapo/reward/maj@4/mean:-0.9736666666666667 - val-aux/math_dapo/reward/maj@4/std:0.07845993923992627 - val-aux/math_dapo/reward/best@8/mean:-0.8564 - val-aux/math_dapo/reward/best@8/std:0.1307235208224097 - val-aux/math_dapo/reward/worst@8/mean:-1.0 - val-aux/math_dapo/reward/worst@8/std:0.0 - val-aux/math_dapo/reward/maj@8/mean:-0.9655333333333332 - val-aux/math_dapo/reward/maj@8/std:0.08772212151551147 - val-aux/math_dapo/reward/best@16/mean:-0.7925333333333333 - val-aux/math_dapo/reward/best@16/std:0.10691882400398754 - val-aux/math_dapo/reward/worst@16/mean:-1.0 - val-aux/math_dapo/reward/worst@16/std:0.0 - val-aux/math_dapo/reward/maj@16/mean:-0.9597333333333334 - val-aux/math_dapo/reward/maj@16/std:0.09211085217248967 - val-aux/math_dapo/reward/best@32/mean:-0.7494 - val-aux/math_dapo/reward/best@32/std:0.058182945143404226 - val-aux/math_dapo/reward/worst@32/mean:-1.0 - val-aux/math_dapo/reward/worst@32/std:0.0 - val-aux/math_dapo/reward/maj@32/mean:-0.9504666666666668 - val-aux/math_dapo/reward/maj@32/std:0.09521095404543085 - val-aux/math_dapo/score/mean@32:-0.975 - val-aux/math_dapo/score/std@32:0.07704943758927256 - val-aux/math_dapo/score/best@2/mean:-0.9544666666666667 - val-aux/math_dapo/score/best@2/std:0.09937795485239939 - val-aux/math_dapo/score/worst@2/mean:-0.9973333333333333 - val-aux/math_dapo/score/worst@2/std:0.025566056728605274 - val-aux/math_dapo/score/maj@2/mean:-0.9760000000000001 - val-aux/math_dapo/score/maj@2/std:0.07583204176976732 - val-aux/math_dapo/score/best@4/mean:-0.9150666666666667 - val-aux/math_dapo/score/best@4/std:0.12276829357793867 - val-aux/math_dapo/score/worst@4/mean:-1.0 - val-aux/math_dapo/score/worst@4/std:0.0 - val-aux/math_dapo/score/maj@4/mean:-0.9736666666666667 - val-aux/math_dapo/score/maj@4/std:0.07845993923992627 - val-aux/math_dapo/score/best@8/mean:-0.8564 - val-aux/math_dapo/score/best@8/std:0.1307235208224097 - val-aux/math_dapo/score/worst@8/mean:-1.0 - val-aux/math_dapo/score/worst@8/std:0.0 - val-aux/math_dapo/score/maj@8/mean:-0.9655333333333332 - val-aux/math_dapo/score/maj@8/std:0.08772212151551147 - val-aux/math_dapo/score/best@16/mean:-0.7925333333333333 - val-aux/math_dapo/score/best@16/std:0.10691882400398754 - val-aux/math_dapo/score/worst@16/mean:-1.0 - val-aux/math_dapo/score/worst@16/std:0.0 - val-aux/math_dapo/score/maj@16/mean:-0.9597333333333334 - val-aux/math_dapo/score/maj@16/std:0.09211085217248967 - val-aux/math_dapo/score/best@32/mean:-0.7494 - val-aux/math_dapo/score/best@32/std:0.058182945143404226 - val-aux/math_dapo/score/worst@32/mean:-1.0 - val-aux/math_dapo/score/worst@32/std:0.0 - val-aux/math_dapo/score/maj@32/mean:-0.9504666666666668 - val-aux/math_dapo/score/maj@32/std:0.09521095404543085 - val-core/math_dapo/acc/mean@32:0.0125 - val-aux/math_dapo/acc/std@32:0.03852471879463628 - val-aux/math_dapo/acc/best@2/mean:0.022766666666666668 - val-aux/math_dapo/acc/best@2/std:0.049688977426199696 - val-aux/math_dapo/acc/worst@2/mean:0.0013333333333333333 - val-aux/math_dapo/acc/worst@2/std:0.012783028364302637 - val-aux/math_dapo/acc/maj@2/mean:0.012 - val-aux/math_dapo/acc/maj@2/std:0.03791602088488366 - val-aux/math_dapo/acc/best@4/mean:0.042466666666666666 - val-aux/math_dapo/acc/best@4/std:0.06138414678896935 - val-aux/math_dapo/acc/worst@4/mean:0.0 - val-aux/math_dapo/acc/worst@4/std:0.0 - val-aux/math_dapo/acc/maj@4/mean:0.013166666666666667 - val-aux/math_dapo/acc/maj@4/std:0.03922996961996313 - val-aux/math_dapo/acc/best@8/mean:0.0718 - val-aux/math_dapo/acc/best@8/std:0.06536176041120485 - val-aux/math_dapo/acc/worst@8/mean:0.0 - val-aux/math_dapo/acc/worst@8/std:0.0 - val-aux/math_dapo/acc/maj@8/mean:0.017233333333333333 - val-aux/math_dapo/acc/maj@8/std:0.043861060757755733 - val-aux/math_dapo/acc/best@16/mean:0.10373333333333333 - val-aux/math_dapo/acc/best@16/std:0.05345941200199377 - val-aux/math_dapo/acc/worst@16/mean:0.0 - val-aux/math_dapo/acc/worst@16/std:0.0 - val-aux/math_dapo/acc/maj@16/mean:0.020133333333333333 - val-aux/math_dapo/acc/maj@16/std:0.046055426086244834 - val-core/math_dapo/acc/best@32/mean:0.1253 - val-core/math_dapo/acc/best@32/std:0.029091472571702113 - val-aux/math_dapo/acc/worst@32/mean:0.0 - val-aux/math_dapo/acc/worst@32/std:0.0 - val-core/math_dapo/acc/maj@32/mean:0.024766666666666666 - val-core/math_dapo/acc/maj@32/std:0.04760547702271543 - critic/score/mean:-0.5475802421569824 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.5475802421569824 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.026904381811618805 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.026904381811618805 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:462.7015380859375 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0008544921875 - prompt_length/mean:165.033203125 - prompt_length/max:920.0 - prompt_length/min:89.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.0938535928726196e-06 - timing_s/generate_sequences:273.2535095214844 - timing_s/reshard:3.6207501888275146 - timing_s/gen:295.58113472443074 - timing_s/reward:9.805552338249981 - timing_s/old_log_prob:61.2133605601266 - timing_s/adv:0.27062740735709667 - timing_s/update_actor:244.009696546942 - timing_s/testing:45.04757490288466 - timing_s/step:657.7952813562006 - timing_s/stop_profile:1.2870877981185913e-06 - timing_per_token_ms/gen:0.07798046584019441 - timing_per_token_ms/update_actor:0.04745052002866014 - timing_per_token_ms/adv:5.262664309994699e-05 - perf/total_num_tokens:5142403 - perf/time_per_step:657.7952813562006 - perf/throughput:977.2042962587311 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:11 - global_seqlen/min:610910 - global_seqlen/max:670236 - global_seqlen/minmax_diff:59326 - global_seqlen/balanced_min:634804 - global_seqlen/balanced_max:634805 - global_seqlen/mean:634804.5 - actor/entropy:0.7079728841781616 - actor/pg_loss:0.052994918453888123 - actor/pg_clipfrac:0.0013165258035521467 - actor/ppo_kl:0.00018775914799882477 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.4710818789899349 - perf/mfu/actor:0.4025806274309162 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:229.8317527770996 - actor/lr:1e-06 - critic/score/mean:-0.5422999858856201 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.5422999858856201 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.03877551481127739 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.03877551481127739 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:458.03955078125 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0015869140625 - prompt_length/mean:161.88671875 - prompt_length/max:844.0 - prompt_length/min:83.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.1106173992156982e-06 - timing_s/generate_sequences:276.9302978515625 - timing_s/reshard:3.238208293914795 - timing_s/gen:301.1488590380177 - timing_s/reward:9.854483269155025 - timing_s/old_log_prob:59.354360098950565 - timing_s/adv:0.2555313156917691 - timing_s/update_actor:235.89492619689554 - timing_s/step:608.0880044931546 - timing_s/stop_profile:1.4118850231170654e-06 - timing_per_token_ms/gen:0.08025799359266621 - timing_per_token_ms/update_actor:0.04645030993733022 - timing_per_token_ms/adv:5.031693137252672e-05 - perf/total_num_tokens:5078436 - perf/time_per_step:608.0880044931546 - perf/throughput:1043.9352450787346 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:12 - global_seqlen/min:585590 - global_seqlen/max:648083 - global_seqlen/minmax_diff:62493 - global_seqlen/balanced_min:607308 - global_seqlen/balanced_max:607309 - global_seqlen/mean:607308.75 - actor/entropy:0.7174740433692932 - actor/pg_loss:-0.006200607018881893 - actor/pg_clipfrac:0.00132521513252693 - actor/ppo_kl:0.00025233168807300944 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.49397239461541176 - perf/mfu/actor:0.40039902556724133 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:229.83223724365234 - actor/lr:1e-06 - critic/score/mean:-0.538982629776001 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.538982629776001 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.02473156340420246 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.02473156340420246 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:434.030029296875 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.00048828125 - prompt_length/mean:159.044921875 - prompt_length/max:587.0 - prompt_length/min:89.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.808868885040283e-06 - timing_s/generate_sequences:256.7734069824219 - timing_s/reshard:3.456324338912964 - timing_s/gen:275.85195192787796 - timing_s/reward:9.721768180839717 - timing_s/old_log_prob:57.785484499298036 - timing_s/adv:0.23679132387042046 - timing_s/update_actor:226.7577961711213 - timing_s/step:572.056653700769 - timing_s/stop_profile:1.1334195733070374e-06 - timing_per_token_ms/gen:0.07758295901811577 - timing_per_token_ms/update_actor:0.046672676001111725 - timing_per_token_ms/adv:4.87378380169931e-05 - perf/total_num_tokens:4858470 - perf/time_per_step:572.056653700769 - perf/throughput:1061.6234354957276 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:13 - global_seqlen/min:579788 - global_seqlen/max:642480 - global_seqlen/minmax_diff:62692 - global_seqlen/balanced_min:609608 - global_seqlen/balanced_max:609609 - global_seqlen/mean:609608.75 - actor/entropy:0.6993871927261353 - actor/pg_loss:0.02702910844808477 - actor/pg_clipfrac:0.0016238693052927327 - actor/ppo_kl:0.00025866889798124127 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.4853004142642021 - perf/mfu/actor:0.3915595473710787 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:230.34062957763672 - actor/lr:1e-06 - critic/score/mean:-0.5058314800262451 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.5058314800262451 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.030353456735610962 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.030353456735610962 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:438.498779296875 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0008544921875 - prompt_length/mean:156.822265625 - prompt_length/max:629.0 - prompt_length/min:86.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.320164978504181e-06 - timing_s/generate_sequences:271.4314270019531 - timing_s/reshard:4.830410480499268 - timing_s/gen:296.8970360821113 - timing_s/reward:9.778646608814597 - timing_s/old_log_prob:57.363063260912895 - timing_s/adv:0.2671221410855651 - timing_s/update_actor:232.77564725186676 - timing_s/step:598.8364365361631 - timing_s/stop_profile:1.1492520570755005e-06 - timing_per_token_ms/gen:0.08265088909251016 - timing_per_token_ms/update_actor:0.0477305417720519 - timing_per_token_ms/adv:5.477327488441666e-05 - perf/total_num_tokens:4876870 - perf/time_per_step:598.8364365361631 - perf/throughput:1017.9887408424026 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:14 - global_seqlen/min:595053 - global_seqlen/max:644471 - global_seqlen/minmax_diff:49418 - global_seqlen/balanced_min:621771 - global_seqlen/balanced_max:621772 - global_seqlen/mean:621771.5 - actor/entropy:0.6846650242805481 - actor/pg_loss:-0.04550331847210016 - actor/pg_clipfrac:0.001536474980613483 - actor/ppo_kl:0.00031263826534898596 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.4772070683538914 - perf/mfu/actor:0.39716877813122786 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:229.9249382019043 - actor/lr:1e-06 - critic/score/mean:-0.49664759635925293 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.49664759635925293 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.024117207154631615 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.024117207154631615 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:446.70849609375 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.000732421875 - prompt_length/mean:160.490234375 - prompt_length/max:893.0 - prompt_length/min:86.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.616325557231903e-06 - timing_s/generate_sequences:264.6282043457031 - timing_s/reshard:3.754718542098999 - timing_s/gen:286.9908367777243 - timing_s/reward:9.980810724198818 - timing_s/old_log_prob:58.701115789823234 - timing_s/adv:0.25665396358817816 - timing_s/update_actor:234.49037188384682 - timing_s/step:592.3122538141906 - timing_s/stop_profile:1.2489035725593567e-06 - timing_per_token_ms/gen:0.07842488207956755 - timing_per_token_ms/update_actor:0.04714158896874632 - timing_per_token_ms/adv:5.159732385373448e-05 - perf/total_num_tokens:4974172 - perf/time_per_step:592.3122538141906 - perf/throughput:1049.7360066351941 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:15 - global_seqlen/min:596387 - global_seqlen/max:674967 - global_seqlen/minmax_diff:78580 - global_seqlen/balanced_min:636384 - global_seqlen/balanced_max:636385 - global_seqlen/mean:636384.375 - actor/entropy:0.7127367258071899 - actor/pg_loss:0.0016459830255172718 - actor/pg_clipfrac:0.0014362275267913724 - actor/ppo_kl:0.0002451822807969798 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.4612007737159729 - perf/mfu/actor:0.40434905879313465 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:230.2707061767578 - actor/lr:1e-06 - critic/score/mean:-0.5292482376098633 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.5292482376098633 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.033534470945596695 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.033534470945596695 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:465.1273193359375 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.0010986328125 - prompt_length/mean:156.341796875 - prompt_length/max:451.0 - prompt_length/min:87.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.7995556592941284e-06 - timing_s/generate_sequences:272.55633544921875 - timing_s/reshard:4.159339427947998 - timing_s/gen:294.83977265190333 - timing_s/reward:9.800664436072111 - timing_s/old_log_prob:59.2165615092963 - timing_s/adv:0.2622960638254881 - timing_s/update_actor:235.52128052618355 - timing_s/step:601.5225755963475 - timing_s/stop_profile:1.3615936040878296e-06 - timing_per_token_ms/gen:0.07737920713070869 - timing_per_token_ms/update_actor:0.04626160104225209 - timing_per_token_ms/adv:5.152076208374225e-05 - perf/total_num_tokens:5091075 - perf/time_per_step:601.5225755963475 - perf/throughput:1057.955928535335 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:16 - global_seqlen/min:629604 - global_seqlen/max:677356 - global_seqlen/minmax_diff:47752 - global_seqlen/balanced_min:640326 - global_seqlen/balanced_max:640326 - global_seqlen/mean:640326.0 - actor/entropy:0.6809712648391724 - actor/pg_loss:0.07015243154071439 - actor/pg_clipfrac:0.0011781456043454556 - actor/ppo_kl:0.00035184311026609927 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.4578530993312597 - perf/mfu/actor:0.3988310129508669 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:230.47071075439453 - actor/lr:1e-06 - critic/score/mean:-0.4835388660430908 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.4835388660430908 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.036139726638793945 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.036139726638793945 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:465.10546875 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0015869140625 - prompt_length/mean:160.212890625 - prompt_length/max:629.0 - prompt_length/min:83.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.9886141419410706e-06 - timing_s/generate_sequences:283.0769958496094 - timing_s/reshard:3.4882044792175293 - timing_s/gen:309.0173769602552 - timing_s/reward:10.216661799699068 - timing_s/old_log_prob:61.18876554723829 - timing_s/adv:0.22769523039460182 - timing_s/update_actor:240.62372836563736 - timing_s/step:622.9932898180559 - timing_s/stop_profile:1.2945383787155151e-06 - timing_per_token_ms/gen:0.08110385774402626 - timing_per_token_ms/update_actor:0.04697289512795774 - timing_per_token_ms/adv:4.444908343457118e-05 - perf/total_num_tokens:5122608 - perf/time_per_step:622.9932898180559 - perf/throughput:1027.8216643184167 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:17 - global_seqlen/min:610389 - global_seqlen/max:647530 - global_seqlen/minmax_diff:37141 - global_seqlen/balanced_min:633930 - global_seqlen/balanced_max:633931 - global_seqlen/mean:633930.625 - actor/entropy:0.689122200012207 - actor/pg_loss:0.03913707625311376 - actor/pg_clipfrac:0.001588939252376969 - actor/ppo_kl:0.0002419177735181289 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.4690113700926304 - perf/mfu/actor:0.40035543946202506 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:230.35147857666016 - actor/lr:1e-06 - critic/score/mean:-0.4723842144012451 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.4723842144012451 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.03639453276991844 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.03639453276991844 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:457.9674072265625 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0020751953125 - prompt_length/mean:161.10546875 - prompt_length/max:602.0 - prompt_length/min:84.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.3266842365264893e-06 - timing_s/generate_sequences:276.896484375 - timing_s/reshard:3.5166640281677246 - timing_s/gen:300.3481022082269 - timing_s/reward:9.911807811819017 - timing_s/old_log_prob:61.019502721726894 - timing_s/adv:0.23349829576909542 - timing_s/update_actor:236.92047509923577 - timing_s/step:610.2210993384942 - timing_s/stop_profile:1.27498060464859e-06 - timing_per_token_ms/gen:0.0800571964659534 - timing_per_token_ms/update_actor:0.04671656206450741 - timing_per_token_ms/adv:4.604176832620593e-05 - perf/total_num_tokens:5071445 - perf/time_per_step:610.2210993384942 - perf/throughput:1038.8539919173688 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:18 - global_seqlen/min:601839 - global_seqlen/max:666789 - global_seqlen/minmax_diff:64950 - global_seqlen/balanced_min:633493 - global_seqlen/balanced_max:633494 - global_seqlen/mean:633493.375 - actor/entropy:0.6870095133781433 - actor/pg_loss:0.011534421485033159 - actor/pg_clipfrac:0.001865464160225412 - actor/ppo_kl:0.0002645760392306072 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.47301557287573814 - perf/mfu/actor:0.4044764695055038 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:230.31711959838867 - actor/lr:1e-06 - critic/score/mean:-0.4395918846130371 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.4395918846130371 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.03367100656032562 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.03367100656032562 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:461.4095458984375 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.0006103515625 - prompt_length/mean:157.236328125 - prompt_length/max:587.0 - prompt_length/min:84.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.6153942346572876e-06 - timing_s/generate_sequences:268.682373046875 - timing_s/reshard:3.6341989040374756 - timing_s/gen:287.85589760076255 - timing_s/reward:9.70955937821418 - timing_s/old_log_prob:59.43162809126079 - timing_s/adv:0.23709490709006786 - timing_s/update_actor:234.2671885918826 - timing_s/step:593.3980456087738 - timing_s/stop_profile:1.3364478945732117e-06 - timing_per_token_ms/gen:0.07615503339158826 - timing_per_token_ms/update_actor:0.0462252641142227 - timing_per_token_ms/adv:4.67832254540286e-05 - perf/total_num_tokens:5067947 - perf/time_per_step:593.3980456087738 - perf/throughput:1067.5690283915444 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:19 - global_seqlen/min:554539 - global_seqlen/max:628456 - global_seqlen/minmax_diff:73917 - global_seqlen/balanced_min:597909 - global_seqlen/balanced_max:597909 - global_seqlen/mean:597909.0 - actor/entropy:0.7067410945892334 - actor/pg_loss:0.04187978045669145 - actor/pg_clipfrac:0.001682552826363582 - actor/ppo_kl:0.0003889593258953866 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5019585620611906 - perf/mfu/actor:0.39800332469904925 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:230.25806427001953 - actor/lr:1e-06 - critic/score/mean:-0.4718770980834961 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.4718770980834961 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.0312212947756052 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.0312212947756052 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:425.2783203125 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0006103515625 - prompt_length/mean:158.6171875 - prompt_length/max:456.0 - prompt_length/min:83.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.439374268054962e-06 - timing_s/generate_sequences:253.03128051757812 - timing_s/reshard:3.482020616531372 - timing_s/gen:273.74350063316524 - timing_s/reward:9.812420612201095 - timing_s/old_log_prob:56.16259963810444 - timing_s/adv:0.25715680327266455 - timing_s/update_actor:224.50412114989012 - timing_s/step:566.4846185864881 - timing_s/stop_profile:1.0551884770393372e-06 - timing_per_token_ms/gen:0.078574319618691 - timing_per_token_ms/update_actor:0.046935261291829136 - timing_per_token_ms/adv:5.376169351704535e-05 - perf/total_num_tokens:4783272 - perf/time_per_step:566.4846185864881 - perf/throughput:1055.4726119341476 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 20}
[36m(TaskRunner pid=379036)[0m validation generation end
[36m(TaskRunner pid=379036)[0m [prompt] system
[36m(TaskRunner pid=379036)[0m You are a helpful assistant.
[36m(TaskRunner pid=379036)[0m user
[36m(TaskRunner pid=379036)[0m Solve the following math problem step by step. The last line of your response should be of the form Answer: $Answer (without quotes) where $Answer is the answer to the problem.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Find the largest possible real part of \[(75+117i)z+\frac{96+144i}{z}\]where $z$ is a complex number with $|z|=4$.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Remember to put your answer on its own line after "Answer:".
[36m(TaskRunner pid=379036)[0m assistant
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m [response] Let $z = a + bi$, where $a$ and $b$ are real numbers and $|z| = 4$ means $a^2 + b^2 = 16$. The expression becomes
[36m(TaskRunner pid=379036)[0m \[(75+117i)(a + bi) + \frac{96+144i}{a + bi} = (75a - 117b) + (117a + 75b)i + \frac{96}{a + bi} + \frac{144i}{a + bi}.\]
[36m(TaskRunner pid=379036)[0m Further simplification gives
[36m(TaskRunner pid=379036)[0m \[(75a - 117b + \frac{96a - 96b}{a^2 + b^2}) + (117a + 75b + \frac{144b + 144a}{a^2 + b^2})i.\]
[36m(TaskRunner pid=379036)[0m Since $a^2 + b^2 = 16$, we have
[36m(TaskRunner pid=379036)[0m \[(75a - 117b + \frac{96a - 96b}{16}) + (117a + 75b + \frac{144a + 144b}{16})i.\]
[36m(TaskRunner pid=379036)[0m This simplifies to
[36m(TaskRunner pid=379036)[0m \[(75a - 117b + 6a - 6b) + (117a + 75b + 9a + 9b)i,\]
[36m(TaskRunner pid=379036)[0m giving
[36m(TaskRunner pid=379036)[0m \[(81a - 123b) + (126a + 84b)i.\]
[36m(TaskRunner pid=379036)[0m The real part is $81a - 123b$. We maximize this by choosing $a$ and $b$ such that this expression is maximized, considering $a^2 + b^2 = 16$.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m By the Cauchy-Schwarz inequality, for any real numbers $a$ and $b$,
[36m(TaskRunner pid=379036)[0m \[(a^2 + b^2)(81^2 + (-123)^2) \geq (81a - 123b)^2.\]
[36m(TaskRunner pid=379036)[0m Therefore, 
[36m(TaskRunner pid=379036)[0m \[(a^2 + b^2)(81^2 + 123^2) \geq (-123a + 81b)^2,\]
[36m(TaskRunner pid=379036)[0m so
[36m(TaskRunner pid=379036)[0m \[ (81^2 + 123^2) \geq \left(\frac{|-123a + 81b|}{|a^2 + b^2|}\right)^2.\]
[36m(TaskRunner pid=379036)[0m Since $a^2 + b^2 = 16$, we have
[36m(TaskRunner pid=379036)[0m \[(81^2 + 123^2) \geq \left(\frac{|-123a + 81b|}{4}\right)^2.\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m To maximize $-123a + 81b$, we follow the equality condition in the Cauchy-Schwarz inequality, leading to the unit vector in the direction of $(-123, 81)$. Normalizing this vector and considering $a^2 + b^2 = 16$, we find the maximum happens when $a = \frac{123}{16}\cos(\theta)$ and $b = \frac{81}{16}\sin(\theta)$ for some $\theta$.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Thus, the real part is maximized as
[36m(TaskRunner pid=379036)[0m \[\max(-123a + 81b) = \max(-123\cdot\frac{123}{16}\cos(\theta) + 81\cdot\frac{81}{16}\sin(\theta)) = \frac{123^2}{16} - \frac{81^2}{16} = 123^2 - 81^2.\]
[36m(TaskRunner pid=379036)[0m Calculating this, 
[36m(TaskRunner pid=379036)[0m \[Answer: 12480\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Answer: 12480
[36m(TaskRunner pid=379036)[0m [ground_truth] 540
[36m(TaskRunner pid=379036)[0m [score] -1.0
[36m(TaskRunner pid=379036)[0m [acc] False
[36m(TaskRunner pid=379036)[0m [pred] 12480
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['reward']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['score']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['acc']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['pred']: 960
[36m(TaskRunner pid=379036)[0m local_global_step_folder: /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_20
[36m(TaskRunner pid=379036)[0m step:20 - global_seqlen/min:590059 - global_seqlen/max:634131 - global_seqlen/minmax_diff:44072 - global_seqlen/balanced_min:612385 - global_seqlen/balanced_max:612386 - global_seqlen/mean:612385.75 - actor/entropy:0.6402928233146667 - actor/pg_loss:0.11124747401821845 - actor/pg_clipfrac:0.0015747364821909933 - actor/ppo_kl:0.0003727553968616853 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.47945390827953815 - perf/mfu/actor:0.4063197114843272 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:230.22260284423828 - actor/lr:1e-06 - val-aux/math_dapo/reward/mean@32:-0.9729166666666667 - val-aux/math_dapo/reward/std@32:0.09009537645637057 - val-aux/math_dapo/reward/best@2/mean:-0.9484 - val-aux/math_dapo/reward/best@2/std:0.12008836199441282 - val-aux/math_dapo/reward/worst@2/mean:-0.9950666666666667 - val-aux/math_dapo/reward/worst@2/std:0.03148181158723366 - val-aux/math_dapo/reward/maj@2/mean:-0.9722666666666667 - val-aux/math_dapo/reward/maj@2/std:0.0910603947815828 - val-aux/math_dapo/reward/best@4/mean:-0.9094000000000001 - val-aux/math_dapo/reward/best@4/std:0.1484266242161962 - val-aux/math_dapo/reward/worst@4/mean:-0.9996666666666666 - val-aux/math_dapo/reward/worst@4/std:0.004702245326555295 - val-aux/math_dapo/reward/maj@4/mean:-0.9692000000000002 - val-aux/math_dapo/reward/maj@4/std:0.09206194927256978 - val-aux/math_dapo/reward/best@8/mean:-0.8528 - val-aux/math_dapo/reward/best@8/std:0.16679248151029966 - val-aux/math_dapo/reward/worst@8/mean:-1.0 - val-aux/math_dapo/reward/worst@8/std:0.0 - val-aux/math_dapo/reward/maj@8/mean:-0.9684000000000001 - val-aux/math_dapo/reward/maj@8/std:0.08742709277508035 - val-aux/math_dapo/reward/best@16/mean:-0.7813333333333332 - val-aux/math_dapo/reward/best@16/std:0.1712503279812117 - val-aux/math_dapo/reward/worst@16/mean:-1.0 - val-aux/math_dapo/reward/worst@16/std:0.0 - val-aux/math_dapo/reward/maj@16/mean:-0.9708666666666665 - val-aux/math_dapo/reward/maj@16/std:0.07697762099294167 - val-aux/math_dapo/reward/best@32/mean:-0.7014666666666667 - val-aux/math_dapo/reward/best@32/std:0.14880513207173074 - val-aux/math_dapo/reward/worst@32/mean:-1.0 - val-aux/math_dapo/reward/worst@32/std:0.0 - val-aux/math_dapo/reward/maj@32/mean:-0.9768 - val-aux/math_dapo/reward/maj@32/std:0.058914536469566424 - val-aux/math_dapo/score/mean@32:-0.9729166666666667 - val-aux/math_dapo/score/std@32:0.09009537645637057 - val-aux/math_dapo/score/best@2/mean:-0.9484 - val-aux/math_dapo/score/best@2/std:0.12008836199441282 - val-aux/math_dapo/score/worst@2/mean:-0.9950666666666667 - val-aux/math_dapo/score/worst@2/std:0.03148181158723366 - val-aux/math_dapo/score/maj@2/mean:-0.9722666666666667 - val-aux/math_dapo/score/maj@2/std:0.0910603947815828 - val-aux/math_dapo/score/best@4/mean:-0.9094000000000001 - val-aux/math_dapo/score/best@4/std:0.1484266242161962 - val-aux/math_dapo/score/worst@4/mean:-0.9996666666666666 - val-aux/math_dapo/score/worst@4/std:0.004702245326555295 - val-aux/math_dapo/score/maj@4/mean:-0.9692000000000002 - val-aux/math_dapo/score/maj@4/std:0.09206194927256978 - val-aux/math_dapo/score/best@8/mean:-0.8528 - val-aux/math_dapo/score/best@8/std:0.16679248151029966 - val-aux/math_dapo/score/worst@8/mean:-1.0 - val-aux/math_dapo/score/worst@8/std:0.0 - val-aux/math_dapo/score/maj@8/mean:-0.9684000000000001 - val-aux/math_dapo/score/maj@8/std:0.08742709277508035 - val-aux/math_dapo/score/best@16/mean:-0.7813333333333332 - val-aux/math_dapo/score/best@16/std:0.1712503279812117 - val-aux/math_dapo/score/worst@16/mean:-1.0 - val-aux/math_dapo/score/worst@16/std:0.0 - val-aux/math_dapo/score/maj@16/mean:-0.9708666666666665 - val-aux/math_dapo/score/maj@16/std:0.07697762099294167 - val-aux/math_dapo/score/best@32/mean:-0.7014666666666667 - val-aux/math_dapo/score/best@32/std:0.14880513207173074 - val-aux/math_dapo/score/worst@32/mean:-1.0 - val-aux/math_dapo/score/worst@32/std:0.0 - val-aux/math_dapo/score/maj@32/mean:-0.9768 - val-aux/math_dapo/score/maj@32/std:0.058914536469566424 - val-core/math_dapo/acc/mean@32:0.013541666666666667 - val-aux/math_dapo/acc/std@32:0.045047688228185286 - val-aux/math_dapo/acc/best@2/mean:0.0258 - val-aux/math_dapo/acc/best@2/std:0.06004418099720641 - val-aux/math_dapo/acc/worst@2/mean:0.002466666666666667 - val-aux/math_dapo/acc/worst@2/std:0.01574090579361683 - val-aux/math_dapo/acc/maj@2/mean:0.013866666666666668 - val-aux/math_dapo/acc/maj@2/std:0.0455301973907914 - val-aux/math_dapo/acc/best@4/mean:0.0453 - val-aux/math_dapo/acc/best@4/std:0.0742133121080981 - val-aux/math_dapo/acc/worst@4/mean:0.00016666666666666666 - val-aux/math_dapo/acc/worst@4/std:0.0023511226632776474 - val-aux/math_dapo/acc/maj@4/mean:0.0154 - val-aux/math_dapo/acc/maj@4/std:0.046030974636284895 - val-aux/math_dapo/acc/best@8/mean:0.07360000000000001 - val-aux/math_dapo/acc/best@8/std:0.08339624075514983 - val-aux/math_dapo/acc/worst@8/mean:0.0 - val-aux/math_dapo/acc/worst@8/std:0.0 - val-aux/math_dapo/acc/maj@8/mean:0.015799999999999998 - val-aux/math_dapo/acc/maj@8/std:0.04371354638754017 - val-aux/math_dapo/acc/best@16/mean:0.10933333333333334 - val-aux/math_dapo/acc/best@16/std:0.08562516399060585 - val-aux/math_dapo/acc/worst@16/mean:0.0 - val-aux/math_dapo/acc/worst@16/std:0.0 - val-aux/math_dapo/acc/maj@16/mean:0.014566666666666669 - val-aux/math_dapo/acc/maj@16/std:0.038488810496470835 - val-core/math_dapo/acc/best@32/mean:0.14926666666666666 - val-core/math_dapo/acc/best@32/std:0.07440256603586537 - val-aux/math_dapo/acc/worst@32/mean:0.0 - val-aux/math_dapo/acc/worst@32/std:0.0 - val-core/math_dapo/acc/maj@32/mean:0.0116 - val-core/math_dapo/acc/maj@32/std:0.029457268234783212 - critic/score/mean:-0.4519355297088623 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.4519355297088623 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.040389008820056915 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.040389008820056915 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:439.331787109375 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0009765625 - prompt_length/mean:158.701171875 - prompt_length/max:766.0 - prompt_length/min:84.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.273598849773407e-06 - timing_s/generate_sequences:258.3683166503906 - timing_s/reshard:4.034632205963135 - timing_s/gen:282.59257507137954 - timing_s/reward:9.43403956759721 - timing_s/old_log_prob:57.614154912531376 - timing_s/adv:0.23251396138221025 - timing_s/update_actor:225.33089966140687 - timing_s/testing:44.277343722991645 - timing_s/save_checkpoint:50.761122583411634 - timing_s/step:671.946385378018 - timing_s/stop_profile:1.7778947949409485e-06 - timing_per_token_ms/gen:0.07851961765870341 - timing_per_token_ms/update_actor:0.04599447726808774 - timing_per_token_ms/adv:4.746068172353175e-05 - perf/total_num_tokens:4899086 - perf/time_per_step:671.946385378018 - perf/throughput:911.3610301742885 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:21 - global_seqlen/min:557852 - global_seqlen/max:605873 - global_seqlen/minmax_diff:48021 - global_seqlen/balanced_min:583256 - global_seqlen/balanced_max:583257 - global_seqlen/mean:583256.625 - actor/entropy:0.6708304286003113 - actor/pg_loss:0.013235503101941222 - actor/pg_clipfrac:0.0017524457286091765 - actor/ppo_kl:0.000304235293554107 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.500604409724474 - perf/mfu/actor:0.4003051389185598 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.06965255737305 - actor/lr:1e-06 - critic/score/mean:-0.4198305606842041 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.4198305606842041 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.021085374057292938 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.021085374057292938 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:415.5806884765625 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.000244140625 - prompt_length/mean:154.005859375 - prompt_length/max:591.0 - prompt_length/min:85.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.000511348247528e-06 - timing_s/generate_sequences:238.83421325683594 - timing_s/reshard:3.6407525539398193 - timing_s/gen:260.54115857649595 - timing_s/reward:9.461820558644831 - timing_s/old_log_prob:56.49836929794401 - timing_s/adv:0.2685946635901928 - timing_s/update_actor:217.87020815256983 - timing_s/step:546.4472971223295 - timing_s/stop_profile:1.166015863418579e-06 - timing_per_token_ms/gen:0.07652988102775758 - timing_per_token_ms/update_actor:0.046692613254193605 - timing_per_token_ms/adv:5.756356895007253e-05 - perf/total_num_tokens:4666053 - perf/time_per_step:546.4472971223295 - perf/throughput:1067.3611674383126 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:22 - global_seqlen/min:567846 - global_seqlen/max:619803 - global_seqlen/minmax_diff:51957 - global_seqlen/balanced_min:593049 - global_seqlen/balanced_max:593050 - global_seqlen/mean:593049.5 - actor/entropy:0.7074180841445923 - actor/pg_loss:0.04264537549408322 - actor/pg_clipfrac:0.0018421417230980075 - actor/ppo_kl:0.00035819553614415285 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5059101916849613 - perf/mfu/actor:0.40073629283790124 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.23025512695312 - actor/lr:1e-06 - critic/score/mean:-0.41213512420654297 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.41213512420654297 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.01698085106909275 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.01698085106909275 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:424.15380859375 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.00048828125 - prompt_length/mean:154.99609375 - prompt_length/max:749.0 - prompt_length/min:85.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.5446137189865112e-06 - timing_s/generate_sequences:248.23785400390625 - timing_s/reshard:3.9234931468963623 - timing_s/gen:266.88729440793395 - timing_s/reward:9.503307885490358 - timing_s/old_log_prob:56.51487893797457 - timing_s/adv:0.48387377616018057 - timing_s/update_actor:221.15905828308314 - timing_s/step:556.3651153696701 - timing_s/stop_profile:1.2088567018508911e-06 - timing_per_token_ms/gen:0.07680943745069571 - timing_per_token_ms/update_actor:0.046614797391086905 - timing_per_token_ms/adv:0.00010198848834713218 - perf/total_num_tokens:4744396 - perf/time_per_step:556.3651153696701 - perf/throughput:1065.9358101665944 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:23 - global_seqlen/min:581220 - global_seqlen/max:632391 - global_seqlen/minmax_diff:51171 - global_seqlen/balanced_min:604195 - global_seqlen/balanced_max:604195 - global_seqlen/mean:604195.0 - actor/entropy:0.7499793171882629 - actor/pg_loss:-0.012166432368834496 - actor/pg_clipfrac:0.001662831501491524 - actor/ppo_kl:0.00041514563852610093 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5007184315472841 - perf/mfu/actor:0.3974210203967413 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.00856399536133 - actor/lr:1e-06 - critic/score/mean:-0.40857958793640137 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.40857958793640137 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.01814405620098114 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.01814405620098114 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:431.2333984375 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.000244140625 - prompt_length/mean:158.80078125 - prompt_length/max:1284.0 - prompt_length/min:83.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.9923394322395325e-06 - timing_s/generate_sequences:248.09066772460938 - timing_s/reshard:3.409592628479004 - timing_s/gen:266.5413820669055 - timing_s/reward:9.405392620712519 - timing_s/old_log_prob:56.64700041990727 - timing_s/adv:0.22343648131936789 - timing_s/update_actor:227.22943821642548 - timing_s/step:561.6644769059494 - timing_s/stop_profile:1.2991949915885925e-06 - timing_per_token_ms/gen:0.07545053310105504 - timing_per_token_ms/update_actor:0.04701078257359492 - timing_per_token_ms/adv:4.6226069671084644e-05 - perf/total_num_tokens:4833560 - perf/time_per_step:561.6644769059494 - perf/throughput:1075.722294791259 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:24 - global_seqlen/min:583404 - global_seqlen/max:610965 - global_seqlen/minmax_diff:27561 - global_seqlen/balanced_min:594858 - global_seqlen/balanced_max:594859 - global_seqlen/mean:594858.25 - actor/entropy:0.7121070027351379 - actor/pg_loss:-0.018351650858587563 - actor/pg_clipfrac:0.001981024578193816 - actor/ppo_kl:0.0004722179165505289 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5030723996460438 - perf/mfu/actor:0.3965419137084907 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.4611358642578 - actor/lr:1e-06 - critic/score/mean:-0.3893909454345703 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.3893909454345703 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.020874319598078728 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.020874319598078728 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:420.353759765625 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0009765625 - prompt_length/mean:160.5625 - prompt_length/max:731.0 - prompt_length/min:83.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.8833746910095215e-06 - timing_s/generate_sequences:247.85153198242188 - timing_s/reshard:3.7949774265289307 - timing_s/gen:270.5951937381178 - timing_s/reward:9.531227354891598 - timing_s/old_log_prob:55.876016614958644 - timing_s/adv:0.2649627309292555 - timing_s/update_actor:224.15392428729683 - timing_s/step:562.1480154851452 - timing_s/stop_profile:1.323409378528595e-06 - timing_per_token_ms/gen:0.0785805743215605 - timing_per_token_ms/update_actor:0.047102382014391 - timing_per_token_ms/adv:5.567770366496041e-05 - perf/total_num_tokens:4758866 - perf/time_per_step:562.1480154851452 - perf/throughput:1058.1879391437951 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:25 - global_seqlen/min:560818 - global_seqlen/max:643488 - global_seqlen/minmax_diff:82670 - global_seqlen/balanced_min:602135 - global_seqlen/balanced_max:602136 - global_seqlen/mean:602135.625 - actor/entropy:0.7138615250587463 - actor/pg_loss:0.0055109133148410665 - actor/pg_clipfrac:0.0018704639417895426 - actor/ppo_kl:0.0004121794370565199 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.50419713370502 - perf/mfu/actor:0.39828904078879845 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.15299224853516 - actor/lr:1e-06 - critic/score/mean:-0.36644864082336426 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.36644864082336426 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.02779456414282322 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.02779456414282322 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:425.9410400390625 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.00048828125 - prompt_length/mean:162.08203125 - prompt_length/max:1559.0 - prompt_length/min:83.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.7727877497673035e-06 - timing_s/generate_sequences:245.11865234375 - timing_s/reshard:3.494097948074341 - timing_s/gen:276.05464480724186 - timing_s/reward:9.608321282081306 - timing_s/old_log_prob:56.90104897972196 - timing_s/adv:0.27869841549545527 - timing_s/update_actor:226.04460412170738 - timing_s/step:570.6960336808115 - timing_s/stop_profile:1.1874362826347351e-06 - timing_per_token_ms/gen:0.07911441629481421 - timing_per_token_ms/update_actor:0.04692560005100748 - timing_per_token_ms/adv:5.7856237848295234e-05 - perf/total_num_tokens:4817085 - perf/time_per_step:570.6960336808115 - perf/throughput:1055.0899068220483 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:26 - global_seqlen/min:554100 - global_seqlen/max:608958 - global_seqlen/minmax_diff:54858 - global_seqlen/balanced_min:593709 - global_seqlen/balanced_max:593710 - global_seqlen/mean:593709.875 - actor/entropy:0.7257553935050964 - actor/pg_loss:0.006692498728084418 - actor/pg_clipfrac:0.00255608417670831 - actor/ppo_kl:0.00047742362441869127 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5161899831146002 - perf/mfu/actor:0.4036980040173991 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.46854400634766 - actor/lr:1e-06 - critic/score/mean:-0.4001433849334717 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.4001433849334717 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.021318469196558 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.021318469196558 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:421.2635498046875 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.00048828125 - prompt_length/mean:158.53125 - prompt_length/max:766.0 - prompt_length/min:83.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.119930624961853e-06 - timing_s/generate_sequences:242.8560333251953 - timing_s/reshard:4.636509895324707 - timing_s/gen:264.8826487539336 - timing_s/reward:9.470917576923966 - timing_s/old_log_prob:57.522872117348015 - timing_s/adv:0.22548656351864338 - timing_s/update_actor:219.77344670053571 - timing_s/step:553.7145849429071 - timing_s/stop_profile:1.4221295714378357e-06 - timing_per_token_ms/gen:0.07675553160061374 - timing_per_token_ms/update_actor:0.04627122100262685 - timing_per_token_ms/adv:4.747406372486296e-05 - perf/total_num_tokens:4749679 - perf/time_per_step:553.7145849429071 - perf/throughput:1072.2308769620306 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:27 - global_seqlen/min:558255 - global_seqlen/max:590449 - global_seqlen/minmax_diff:32194 - global_seqlen/balanced_min:578456 - global_seqlen/balanced_max:578457 - global_seqlen/mean:578456.25 - actor/entropy:0.7362028956413269 - actor/pg_loss:0.007602679912336878 - actor/pg_clipfrac:0.002204655149997259 - actor/ppo_kl:0.0004811612994381339 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5231972746551037 - perf/mfu/actor:0.40440617188234895 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.31354141235352 - actor/lr:1e-06 - critic/score/mean:-0.37166643142700195 - critic/score/max:1.0 - critic/score/min:-1.36328125 - critic/rewards/mean:-0.37166643142700195 - critic/rewards/max:1.0 - critic/rewards/min:-1.36328125 - critic/advantages/mean:-0.019927265122532845 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.019927265122532845 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:405.847900390625 - response_length/max:1722.0 - response_length/min:4.0 - response_length/clip_ratio:0.0 - prompt_length/mean:159.05078125 - prompt_length/max:435.0 - prompt_length/min:87.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.1925737857818604e-06 - timing_s/generate_sequences:232.89662170410156 - timing_s/reshard:3.473182439804077 - timing_s/gen:256.7072574784979 - timing_s/reward:9.469590302556753 - timing_s/old_log_prob:54.70400395337492 - timing_s/adv:0.28769200295209885 - timing_s/update_actor:213.67041132040322 - timing_s/step:536.5243674069643 - timing_s/stop_profile:1.4435499906539917e-06 - timing_per_token_ms/gen:0.07721201738695029 - timing_per_token_ms/update_actor:0.04617255222854002 - timing_per_token_ms/adv:6.216805569826994e-05 - perf/total_num_tokens:4627650 - perf/time_per_step:536.5243674069643 - perf/throughput:1078.1546657343702 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:28 - global_seqlen/min:568139 - global_seqlen/max:627752 - global_seqlen/minmax_diff:59613 - global_seqlen/balanced_min:597023 - global_seqlen/balanced_max:597024 - global_seqlen/mean:597023.75 - actor/entropy:0.7208836078643799 - actor/pg_loss:0.05967680094303552 - actor/pg_clipfrac:0.0023827236909056805 - actor/ppo_kl:0.0004470620898670919 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5133458748459816 - perf/mfu/actor:0.39942533549977544 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.67676544189453 - actor/lr:1e-06 - critic/score/mean:-0.37795305252075195 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.37795305252075195 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.025652363896369934 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.025652363896369934 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:422.681396484375 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.0006103515625 - prompt_length/mean:160.349609375 - prompt_length/max:623.0 - prompt_length/min:88.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.8116628527641296e-06 - timing_s/generate_sequences:239.7010498046875 - timing_s/reshard:3.6211400032043457 - timing_s/gen:260.40603934787214 - timing_s/reward:9.73380617145449 - timing_s/old_log_prob:56.68176633119583 - timing_s/adv:0.439618774689734 - timing_s/update_actor:223.3346171490848 - timing_s/step:552.3574516680092 - timing_s/stop_profile:1.12876296043396e-06 - timing_per_token_ms/gen:0.07520521807790784 - timing_per_token_ms/update_actor:0.046759994294423964 - timing_per_token_ms/adv:9.204382042794235e-05 - perf/total_num_tokens:4776190 - perf/time_per_step:552.3574516680092 - perf/throughput:1080.864842498472 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:29 - global_seqlen/min:570286 - global_seqlen/max:601882 - global_seqlen/minmax_diff:31596 - global_seqlen/balanced_min:585036 - global_seqlen/balanced_max:585037 - global_seqlen/mean:585036.375 - actor/entropy:0.71330326795578 - actor/pg_loss:0.020826002812827937 - actor/pg_clipfrac:0.0020688875738414936 - actor/ppo_kl:0.0004274857283672162 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5229265987873077 - perf/mfu/actor:0.4057183096549721 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.4720458984375 - actor/lr:1e-06 - critic/score/mean:-0.38072824478149414 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.38072824478149414 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.018152566626667976 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.018152566626667976 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:410.5980224609375 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:160.7265625 - prompt_length/max:659.0 - prompt_length/min:87.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.618188202381134e-06 - timing_s/generate_sequences:233.9911346435547 - timing_s/reshard:3.7579495906829834 - timing_s/gen:255.09233180619776 - timing_s/reward:9.500652096234262 - timing_s/old_log_prob:55.74813872855157 - timing_s/adv:0.2751279901713133 - timing_s/update_actor:215.46122936718166 - timing_s/step:537.8753539733589 - timing_s/stop_profile:1.2284144759178162e-06 - timing_per_token_ms/gen:0.0758386522986693 - timing_per_token_ms/update_actor:0.04603586173748206 - timing_per_token_ms/adv:5.8784376905477306e-05 - perf/total_num_tokens:4680291 - perf/time_per_step:537.8753539733589 - perf/throughput:1087.680204490234 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 30}
[36m(TaskRunner pid=379036)[0m validation generation end
[36m(TaskRunner pid=379036)[0m [prompt] system
[36m(TaskRunner pid=379036)[0m You are a helpful assistant.
[36m(TaskRunner pid=379036)[0m user
[36m(TaskRunner pid=379036)[0m Solve the following math problem step by step. The last line of your response should be of the form Answer: $Answer (without quotes) where $Answer is the answer to the problem.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Find the largest possible real part of \[(75+117i)z+\frac{96+144i}{z}\]where $z$ is a complex number with $|z|=4$.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Remember to put your answer on its own line after "Answer:".
[36m(TaskRunner pid=379036)[0m assistant
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m [response] Let $z = x + yi$, where $x$ and $y$ are real numbers. Given $|z|=4$, we have $x^2 + y^2 = 16$. We are asked to maximize the real part of \[(75 + 117i)z + \frac{96 + 144i}{z} = (75x - 117y + \frac{96}{x} - \frac{144y}{x^2+y^2}) + (117x + 75y + \frac{144}{x} + \frac{96y}{x^2+y^2})i\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Focus on the real part: \[75x - 117y + \frac{96}{x} - \frac{144y}{x^2+y^2}\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Consider the term $\frac{96}{x} - \frac{144y}{x^2+y^2}$. This can be simplified by considering bounds and optimization with the constraint $x^2 + y^2 = 16$. For the sake of a rigorous but straightforward argument, we'll look at properties and extrema considering $x^2 + y^2 = 16$. The optimization process reveals that the maximum of the expression happens when $z$ aligns with the vector that makes the real part of the equation as large as possible under the given constraint. We know intuitively or through calculus that maximum value for the real part would occur when $z$ points in a specific direction based on coefficients and the given $|z|=4$ constraint.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m After some calculations or using optimization techniques, we can deduce the maximum.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Answer: 123
[36m(TaskRunner pid=379036)[0m [ground_truth] 540
[36m(TaskRunner pid=379036)[0m [score] -1.0
[36m(TaskRunner pid=379036)[0m [acc] False
[36m(TaskRunner pid=379036)[0m [pred] 123
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['reward']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['score']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['acc']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['pred']: 960
[36m(TaskRunner pid=379036)[0m step:30 - global_seqlen/min:558742 - global_seqlen/max:610445 - global_seqlen/minmax_diff:51703 - global_seqlen/balanced_min:583987 - global_seqlen/balanced_max:583988 - global_seqlen/mean:583987.875 - actor/entropy:0.726446270942688 - actor/pg_loss:0.003687207702755558 - actor/pg_clipfrac:0.002124306500161946 - actor/ppo_kl:0.0004431068534601837 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.524558873847127 - perf/mfu/actor:0.40287075468973726 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.27268600463867 - actor/lr:1e-06 - val-aux/math_dapo/reward/mean@32:-0.9666666666666667 - val-aux/math_dapo/reward/std@32:0.08081059907170443 - val-aux/math_dapo/reward/best@2/mean:-0.9391999999999999 - val-aux/math_dapo/reward/best@2/std:0.10166103515853435 - val-aux/math_dapo/reward/worst@2/mean:-0.9934666666666666 - val-aux/math_dapo/reward/worst@2/std:0.031234616747155698 - val-aux/math_dapo/reward/maj@2/mean:-0.9668666666666665 - val-aux/math_dapo/reward/maj@2/std:0.08084377994163296 - val-aux/math_dapo/reward/best@4/mean:-0.8969333333333332 - val-aux/math_dapo/reward/best@4/std:0.11477700332283589 - val-aux/math_dapo/reward/worst@4/mean:-0.9998 - val-aux/math_dapo/reward/worst@4/std:0.0036460023770334186 - val-aux/math_dapo/reward/maj@4/mean:-0.9593333333333333 - val-aux/math_dapo/reward/maj@4/std:0.08554159322724576 - val-aux/math_dapo/reward/best@8/mean:-0.8467333333333333 - val-aux/math_dapo/reward/best@8/std:0.10965999603726387 - val-aux/math_dapo/reward/worst@8/mean:-1.0 - val-aux/math_dapo/reward/worst@8/std:0.0 - val-aux/math_dapo/reward/maj@8/mean:-0.9418666666666666 - val-aux/math_dapo/reward/maj@8/std:0.09199517846811407 - val-aux/math_dapo/reward/best@16/mean:-0.8016000000000001 - val-aux/math_dapo/reward/best@16/std:0.08964642317386447 - val-aux/math_dapo/reward/worst@16/mean:-1.0 - val-aux/math_dapo/reward/worst@16/std:0.0 - val-aux/math_dapo/reward/maj@16/mean:-0.9260666666666666 - val-aux/math_dapo/reward/maj@16/std:0.09040188390725735 - val-aux/math_dapo/reward/best@32/mean:-0.765 - val-aux/math_dapo/reward/best@32/std:0.0566163572388372 - val-aux/math_dapo/reward/worst@32/mean:-1.0 - val-aux/math_dapo/reward/worst@32/std:0.0 - val-aux/math_dapo/reward/maj@32/mean:-0.9093333333333332 - val-aux/math_dapo/reward/maj@32/std:0.08365444774758636 - val-aux/math_dapo/score/mean@32:-0.9666666666666667 - val-aux/math_dapo/score/std@32:0.08081059907170443 - val-aux/math_dapo/score/best@2/mean:-0.9391999999999999 - val-aux/math_dapo/score/best@2/std:0.10166103515853435 - val-aux/math_dapo/score/worst@2/mean:-0.9934666666666666 - val-aux/math_dapo/score/worst@2/std:0.031234616747155698 - val-aux/math_dapo/score/maj@2/mean:-0.9668666666666665 - val-aux/math_dapo/score/maj@2/std:0.08084377994163296 - val-aux/math_dapo/score/best@4/mean:-0.8969333333333332 - val-aux/math_dapo/score/best@4/std:0.11477700332283589 - val-aux/math_dapo/score/worst@4/mean:-0.9998 - val-aux/math_dapo/score/worst@4/std:0.0036460023770334186 - val-aux/math_dapo/score/maj@4/mean:-0.9593333333333333 - val-aux/math_dapo/score/maj@4/std:0.08554159322724576 - val-aux/math_dapo/score/best@8/mean:-0.8467333333333333 - val-aux/math_dapo/score/best@8/std:0.10965999603726387 - val-aux/math_dapo/score/worst@8/mean:-1.0 - val-aux/math_dapo/score/worst@8/std:0.0 - val-aux/math_dapo/score/maj@8/mean:-0.9418666666666666 - val-aux/math_dapo/score/maj@8/std:0.09199517846811407 - val-aux/math_dapo/score/best@16/mean:-0.8016000000000001 - val-aux/math_dapo/score/best@16/std:0.08964642317386447 - val-aux/math_dapo/score/worst@16/mean:-1.0 - val-aux/math_dapo/score/worst@16/std:0.0 - val-aux/math_dapo/score/maj@16/mean:-0.9260666666666666 - val-aux/math_dapo/score/maj@16/std:0.09040188390725735 - val-aux/math_dapo/score/best@32/mean:-0.765 - val-aux/math_dapo/score/best@32/std:0.0566163572388372 - val-aux/math_dapo/score/worst@32/mean:-1.0 - val-aux/math_dapo/score/worst@32/std:0.0 - val-aux/math_dapo/score/maj@32/mean:-0.9093333333333332 - val-aux/math_dapo/score/maj@32/std:0.08365444774758636 - val-core/math_dapo/acc/mean@32:0.016666666666666666 - val-aux/math_dapo/acc/std@32:0.040405299535852215 - val-aux/math_dapo/acc/best@2/mean:0.030399999999999996 - val-aux/math_dapo/acc/best@2/std:0.05083051757926718 - val-aux/math_dapo/acc/worst@2/mean:0.003266666666666667 - val-aux/math_dapo/acc/worst@2/std:0.015617308373577849 - val-aux/math_dapo/acc/maj@2/mean:0.016566666666666667 - val-aux/math_dapo/acc/maj@2/std:0.04042188997081648 - val-aux/math_dapo/acc/best@4/mean:0.05153333333333333 - val-aux/math_dapo/acc/best@4/std:0.05738850166141794 - val-aux/math_dapo/acc/worst@4/mean:0.0001 - val-aux/math_dapo/acc/worst@4/std:0.0018230011885167093 - val-aux/math_dapo/acc/maj@4/mean:0.020333333333333335 - val-aux/math_dapo/acc/maj@4/std:0.04277079661362288 - val-aux/math_dapo/acc/best@8/mean:0.07663333333333333 - val-aux/math_dapo/acc/best@8/std:0.054829998018631934 - val-aux/math_dapo/acc/worst@8/mean:0.0 - val-aux/math_dapo/acc/worst@8/std:0.0 - val-aux/math_dapo/acc/maj@8/mean:0.02906666666666667 - val-aux/math_dapo/acc/maj@8/std:0.045997589234057036 - val-aux/math_dapo/acc/best@16/mean:0.0992 - val-aux/math_dapo/acc/best@16/std:0.044823211586932234 - val-aux/math_dapo/acc/worst@16/mean:0.0 - val-aux/math_dapo/acc/worst@16/std:0.0 - val-aux/math_dapo/acc/maj@16/mean:0.03696666666666667 - val-aux/math_dapo/acc/maj@16/std:0.04520094195362868 - val-core/math_dapo/acc/best@32/mean:0.1175 - val-core/math_dapo/acc/best@32/std:0.0283081786194186 - val-aux/math_dapo/acc/worst@32/mean:0.0 - val-aux/math_dapo/acc/worst@32/std:0.0 - val-core/math_dapo/acc/maj@32/mean:0.04533333333333334 - val-core/math_dapo/acc/maj@32/std:0.04182722387379318 - critic/score/mean:-0.331362247467041 - critic/score/max:1.0 - critic/score/min:-1.353515625 - critic/rewards/mean:-0.331362247467041 - critic/rewards/max:1.0 - critic/rewards/min:-1.353515625 - critic/advantages/mean:-0.010345950722694397 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.010345950722694397 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:407.1014404296875 - response_length/max:1717.0 - response_length/min:5.0 - response_length/clip_ratio:0.0 - prompt_length/mean:163.19921875 - prompt_length/max:920.0 - prompt_length/min:84.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.9709190130233765e-06 - timing_s/generate_sequences:230.08712768554688 - timing_s/reshard:4.274367809295654 - timing_s/gen:253.57587896566838 - timing_s/reward:10.399002894759178 - timing_s/old_log_prob:56.38824131246656 - timing_s/adv:0.2579471981152892 - timing_s/update_actor:216.5596768995747 - timing_s/testing:44.708594226278365 - timing_s/step:584.1173183340579 - timing_s/stop_profile:1.2461096048355103e-06 - timing_per_token_ms/gen:0.07603531629642453 - timing_per_token_ms/update_actor:0.04635363296275087 - timing_per_token_ms/adv:5.521244728653168e-05 - perf/total_num_tokens:4671903 - perf/time_per_step:584.1173183340579 - perf/throughput:999.778394973073 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:31 - global_seqlen/min:553818 - global_seqlen/max:623200 - global_seqlen/minmax_diff:69382 - global_seqlen/balanced_min:583722 - global_seqlen/balanced_max:583723 - global_seqlen/mean:583722.125 - actor/entropy:0.7478702068328857 - actor/pg_loss:0.025304728193369545 - actor/pg_clipfrac:0.0022833284745524627 - actor/ppo_kl:0.00043217895561605316 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5303120296448469 - perf/mfu/actor:0.3994589742730183 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.54771041870117 - actor/lr:1e-06 - critic/score/mean:-0.35677123069763184 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.35677123069763184 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.019079506397247314 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.019079506397247314 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:406.2286376953125 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.000244140625 - prompt_length/mean:163.8125 - prompt_length/max:1440.0 - prompt_length/min:86.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.4924596548080444e-06 - timing_s/generate_sequences:233.09046936035156 - timing_s/reshard:3.3262643814086914 - timing_s/gen:257.1103394413367 - timing_s/reward:10.048980405554175 - timing_s/old_log_prob:55.66342728585005 - timing_s/adv:0.24103826750069857 - timing_s/update_actor:218.2800885969773 - timing_s/step:543.913436267525 - timing_s/stop_profile:1.3820827007293701e-06 - timing_per_token_ms/gen:0.07726077526352398 - timing_per_token_ms/update_actor:0.0467431503896176 - timing_per_token_ms/adv:5.1616654821139974e-05 - perf/total_num_tokens:4669777 - perf/time_per_step:543.913436267525 - perf/throughput:1073.1893828651348 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:32 - global_seqlen/min:545973 - global_seqlen/max:589296 - global_seqlen/minmax_diff:43323 - global_seqlen/balanced_min:571474 - global_seqlen/balanced_max:571474 - global_seqlen/mean:571474.0 - actor/entropy:0.7614189982414246 - actor/pg_loss:0.03361550362963418 - actor/pg_clipfrac:0.0024972417052169156 - actor/ppo_kl:0.0006627050923348582 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5332227796316147 - perf/mfu/actor:0.40094104349528087 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.59369277954102 - actor/lr:1e-06 - critic/score/mean:-0.33234405517578125 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.33234405517578125 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.015750400722026825 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.015750400722026825 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:398.994140625 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0003662109375 - prompt_length/mean:159.0859375 - prompt_length/max:567.0 - prompt_length/min:83.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.2009556889533997e-06 - timing_s/generate_sequences:224.54934692382812 - timing_s/reshard:4.032937049865723 - timing_s/gen:250.0751308593899 - timing_s/reward:9.42326682806015 - timing_s/old_log_prob:54.15489540062845 - timing_s/adv:0.2644862486049533 - timing_s/update_actor:212.84871431067586 - timing_s/step:528.9849884733558 - timing_s/stop_profile:1.2526288628578186e-06 - timing_per_token_ms/gen:0.07650926734078306 - timing_per_token_ms/update_actor:0.04655695497753963 - timing_per_token_ms/adv:5.785176766680402e-05 - perf/total_num_tokens:4571792 - perf/time_per_step:528.9849884733558 - perf/throughput:1080.3217717940674 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:33 - global_seqlen/min:560602 - global_seqlen/max:604100 - global_seqlen/minmax_diff:43498 - global_seqlen/balanced_min:577954 - global_seqlen/balanced_max:577955 - global_seqlen/mean:577954.875 - actor/entropy:0.7536289095878601 - actor/pg_loss:0.010737220936091675 - actor/pg_clipfrac:0.0027495258791246247 - actor/ppo_kl:0.000522610275605893 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5245750825852156 - perf/mfu/actor:0.4036633284410906 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.30234909057617 - actor/lr:1e-06 - critic/score/mean:-0.30589818954467773 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.30589818954467773 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.024409787729382515 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.024409787729382515 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:404.3055419921875 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0003662109375 - prompt_length/mean:160.103515625 - prompt_length/max:711.0 - prompt_length/min:84.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.5050477385520935e-06 - timing_s/generate_sequences:229.6136474609375 - timing_s/reshard:4.983334064483643 - timing_s/gen:252.24929114989936 - timing_s/reward:9.425225310958922 - timing_s/old_log_prob:53.96565333288163 - timing_s/adv:0.25788941513746977 - timing_s/update_actor:213.89293080940843 - timing_s/step:531.479831609875 - timing_s/stop_profile:1.3122335076332092e-06 - timing_per_token_ms/gen:0.07616059291902237 - timing_per_token_ms/update_actor:0.04626073333350818 - timing_per_token_ms/adv:5.577628684624162e-05 - perf/total_num_tokens:4623639 - perf/time_per_step:531.479831609875 - perf/throughput:1087.4446039642748 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:34 - global_seqlen/min:543944 - global_seqlen/max:590007 - global_seqlen/minmax_diff:46063 - global_seqlen/balanced_min:571616 - global_seqlen/balanced_max:571617 - global_seqlen/mean:571616.25 - actor/entropy:0.7655074596405029 - actor/pg_loss:-0.022475559207668992 - actor/pg_clipfrac:0.0021641209332301514 - actor/ppo_kl:0.00043153672779538965 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5419812202453613 - perf/mfu/actor:0.3978020085107506 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.73165893554688 - actor/lr:1e-06 - critic/score/mean:-0.29486775398254395 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.29486775398254395 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.0171714685857296 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.0171714685857296 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:398.131103515625 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:160.087890625 - prompt_length/max:503.0 - prompt_length/min:83.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.316439688205719e-06 - timing_s/generate_sequences:224.32888793945312 - timing_s/reshard:4.383241176605225 - timing_s/gen:255.98708801623434 - timing_s/reward:9.440759697929025 - timing_s/old_log_prob:54.47280802950263 - timing_s/adv:0.24429353512823582 - timing_s/update_actor:214.58588773570955 - timing_s/step:536.5276373680681 - timing_s/stop_profile:1.1296942830085754e-06 - timing_per_token_ms/gen:0.07848777338462921 - timing_per_token_ms/update_actor:0.046925250930084116 - timing_per_token_ms/adv:5.342166513116007e-05 - perf/total_num_tokens:4572930 - perf/time_per_step:536.5276373680681 - perf/throughput:1065.3994504440793 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:35 - global_seqlen/min:534557 - global_seqlen/max:580347 - global_seqlen/minmax_diff:45790 - global_seqlen/balanced_min:562525 - global_seqlen/balanced_max:562526 - global_seqlen/mean:562525.25 - actor/entropy:0.7518789172172546 - actor/pg_loss:-0.010503919993574093 - actor/pg_clipfrac:0.002626745406620251 - actor/ppo_kl:0.000609351941674584 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5532671809196472 - perf/mfu/actor:0.39225084831265367 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.6593780517578 - actor/lr:1e-06 - critic/score/mean:-0.27225518226623535 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.27225518226623535 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.016781898215413094 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.016781898215413094 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:391.016845703125 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:158.32421875 - prompt_length/max:633.0 - prompt_length/min:84.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.1460076570510864e-06 - timing_s/generate_sequences:216.01646423339844 - timing_s/reshard:5.657977104187012 - timing_s/gen:239.8113893745467 - timing_s/reward:9.498135988600552 - timing_s/old_log_prob:53.806938126683235 - timing_s/adv:0.21365000028163195 - timing_s/update_actor:214.42153014801443 - timing_s/step:519.5849055508152 - timing_s/stop_profile:1.1837109923362732e-06 - timing_per_token_ms/gen:0.07486595926415898 - timing_per_token_ms/update_actor:0.04764709009684775 - timing_per_token_ms/adv:4.7475646711332505e-05 - perf/total_num_tokens:4500202 - perf/time_per_step:519.5849055508152 - perf/throughput:1082.6435564052106 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:36 - global_seqlen/min:532851 - global_seqlen/max:582386 - global_seqlen/minmax_diff:49535 - global_seqlen/balanced_min:565552 - global_seqlen/balanced_max:565694 - global_seqlen/mean:565569.875 - actor/entropy:0.759629487991333 - actor/pg_loss:-0.06822229029398554 - actor/pg_clipfrac:0.0021805088503634015 - actor/ppo_kl:0.0005210745468641015 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5575863756239414 - perf/mfu/actor:0.3992239836738228 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.8968620300293 - actor/lr:1e-06 - critic/score/mean:-0.23132801055908203 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.23132801055908203 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.021175896748900414 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.021175896748900414 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:391.0096435546875 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:161.3046875 - prompt_length/max:731.0 - prompt_length/min:86.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.041699528694153e-06 - timing_s/generate_sequences:216.77340698242188 - timing_s/reshard:3.807354211807251 - timing_s/gen:240.95417154207826 - timing_s/reward:9.350065964274108 - timing_s/old_log_prob:52.12445805221796 - timing_s/adv:0.26399781834334135 - timing_s/update_actor:211.53955708630383 - timing_s/step:516.1417659102008 - timing_s/stop_profile:1.1781230568885803e-06 - timing_per_token_ms/gen:0.07522410636965858 - timing_per_token_ms/update_actor:0.04675362993085157 - timing_per_token_ms/adv:5.834774578988612e-05 - perf/total_num_tokens:4524559 - perf/time_per_step:516.1417659102008 - perf/throughput:1095.7645987098801 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:37 - global_seqlen/min:541419 - global_seqlen/max:620772 - global_seqlen/minmax_diff:79353 - global_seqlen/balanced_min:572885 - global_seqlen/balanced_max:572886 - global_seqlen/mean:572885.25 - actor/entropy:0.7917264699935913 - actor/pg_loss:0.024960146362709393 - actor/pg_clipfrac:0.0026414808913602667 - actor/ppo_kl:0.0005221374091112463 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5464293416589499 - perf/mfu/actor:0.405813496934293 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.5042266845703 - actor/lr:1e-06 - critic/score/mean:-0.2820608615875244 - critic/score/max:1.0 - critic/score/min:-1.24609375 - critic/rewards/mean:-0.2820608615875244 - critic/rewards/max:1.0 - critic/rewards/min:-1.24609375 - critic/advantages/mean:-0.014964482747018337 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.014964482747018337 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:398.589111328125 - response_length/max:1662.0 - response_length/min:4.0 - response_length/clip_ratio:0.0 - prompt_length/mean:160.869140625 - prompt_length/max:609.0 - prompt_length/min:84.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.2512471079826355e-06 - timing_s/generate_sequences:224.6986846923828 - timing_s/reshard:3.65154767036438 - timing_s/gen:242.6403039144352 - timing_s/reward:9.473530896008015 - timing_s/old_log_prob:54.083795407786965 - timing_s/adv:0.27158360183238983 - timing_s/update_actor:210.86191699746996 - timing_s/step:519.1216306285933 - timing_s/stop_profile:1.5012919902801514e-06 - timing_per_token_ms/gen:0.07431005233744856 - timing_per_token_ms/update_actor:0.04600875938887193 - timing_per_token_ms/adv:5.925785352136179e-05 - perf/total_num_tokens:4583082 - perf/time_per_step:519.1216306285933 - perf/throughput:1103.5665173618474 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:38 - global_seqlen/min:559880 - global_seqlen/max:590696 - global_seqlen/minmax_diff:30816 - global_seqlen/balanced_min:579521 - global_seqlen/balanced_max:579521 - global_seqlen/mean:579521.0 - actor/entropy:0.8138226866722107 - actor/pg_loss:0.03282000985636842 - actor/pg_clipfrac:0.002669059214895242 - actor/ppo_kl:0.0006572648113547074 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.544300889596343 - perf/mfu/actor:0.3982652519064117 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.64033126831055 - actor/lr:1e-06 - critic/score/mean:-0.24257469177246094 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.24257469177246094 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.026691921055316925 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.026691921055316925 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:408.0205078125 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.000244140625 - prompt_length/mean:157.91796875 - prompt_length/max:792.0 - prompt_length/min:85.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.417262971401215e-06 - timing_s/generate_sequences:229.51641845703125 - timing_s/reshard:3.741055965423584 - timing_s/gen:249.93222846463323 - timing_s/reward:9.646289633587003 - timing_s/old_log_prob:53.69126420840621 - timing_s/adv:0.22673331759870052 - timing_s/update_actor:217.31479348707944 - timing_s/step:532.5850819759071 - timing_s/stop_profile:1.4007091522216797e-06 - timing_per_token_ms/gen:0.0747739504469204 - timing_per_token_ms/update_actor:0.0468737960934719 - timing_per_token_ms/adv:4.890532819317603e-05 - perf/total_num_tokens:4636168 - perf/time_per_step:532.5850819759071 - perf/throughput:1088.1284880341732 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:39 - global_seqlen/min:514157 - global_seqlen/max:582990 - global_seqlen/minmax_diff:68833 - global_seqlen/balanced_min:558324 - global_seqlen/balanced_max:558490 - global_seqlen/mean:558344.75 - actor/entropy:0.8101252913475037 - actor/pg_loss:0.02782958104545551 - actor/pg_clipfrac:0.0026286696647143653 - actor/ppo_kl:0.0005893453590150814 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5621252879500389 - perf/mfu/actor:0.3990139696043546 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.98931503295898 - actor/lr:1e-06 - critic/score/mean:-0.23670649528503418 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.23670649528503418 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.0264716949313879 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.0264716949313879 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:383.465576171875 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:161.79296875 - prompt_length/max:749.0 - prompt_length/min:83.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.394670784473419e-06 - timing_s/generate_sequences:215.00559997558594 - timing_s/reshard:3.4372572898864746 - timing_s/gen:236.88489322643727 - timing_s/reward:9.409423475153744 - timing_s/old_log_prob:53.04996362794191 - timing_s/adv:0.26797263883054256 - timing_s/update_actor:208.8662580344826 - timing_s/step:510.38353830669075 - timing_s/stop_profile:1.2246891856193542e-06 - timing_per_token_ms/gen:0.07540862789133247 - timing_per_token_ms/update_actor:0.04676014640472634 - timing_per_token_ms/adv:5.9992647649714305e-05 - perf/total_num_tokens:4466758 - perf/time_per_step:510.38353830669075 - perf/throughput:1093.970922048997 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 40}
[36m(TaskRunner pid=379036)[0m validation generation end
[36m(TaskRunner pid=379036)[0m [prompt] system
[36m(TaskRunner pid=379036)[0m You are a helpful assistant.
[36m(TaskRunner pid=379036)[0m user
[36m(TaskRunner pid=379036)[0m Solve the following math problem step by step. The last line of your response should be of the form Answer: $Answer (without quotes) where $Answer is the answer to the problem.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Find the largest possible real part of \[(75+117i)z+\frac{96+144i}{z}\]where $z$ is a complex number with $|z|=4$.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Remember to put your answer on its own line after "Answer:".
[36m(TaskRunner pid=379036)[0m assistant
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m [response] To maximize the real part of the complex number expression \[(75+117i)z+\frac{96+144i}{z}\] given that $|z|=4$, we can use the AM-GM inequality (Arithmetic Mean-Geometric Mean inequality), which states that the arithmetic mean of a set of non-negative numbers is always greater than or equal to the geometric mean, with equality holding if and only if all the numbers are equal.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Let's consider the function 
[36m(TaskRunner pid=379036)[0m \[f(z) = (75+117i)z+\frac{96+144i}{z}\].
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Our goal is to maximize the real part of $f(z)$.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m First, let $z = x + yi$, where $x$ and $y$ are real numbers, and $|z| = \sqrt{x^2 + y^2} = 4$. Thus, $x^2 + y^2 = 16$.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m The real part of $f(z)$ is then:
[36m(TaskRunner pid=379036)[0m \[
[36m(TaskRunner pid=379036)[0m \text{Re}(f(z)) = \text{Re}([(75+117i)(x+yi)+\frac{96+144i}{x+yi}]).
[36m(TaskRunner pid=379036)[0m \]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Simplify $f(z)$ and find its real part:
[36m(TaskRunner pid=379036)[0m \[
[36m(TaskRunner pid=379036)[0m f(z) = (75x - 117y) + (117x + 75y)i + \frac{96x - 144y}{x^2 + y^2} + \frac{96y + 144x}{x^2 + y^2}i.
[36m(TaskRunner pid=379036)[0m \]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Combine the real and imaginary parts:
[36m(TaskRunner pid=379036)[0m \[
[36m(TaskRunner pid=379036)[0m f(z) = (75x - 117y + \frac{96x - 144y}{16}) + (117x + 75y + \frac{96y + 144x}{16})i.
[36m(TaskRunner pid=379036)[0m \]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m The real part simplifies to:
[36m(TaskRunner pid=379036)[0m \[
[36m(TaskRunner pid=379036)[0m 75x - 117y + \frac{96x - 144y}{16} = (75x - 117y) + \frac{96x - 144y}{16}.
[36m(TaskRunner pid=379036)[0m \]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m We apply AM-GM to:
[36m(TaskRunner pid=379036)[0m \[
[36m(TaskRunner pid=379036)[0m \frac{(75x - 117y) + \frac{96x - 144y}{16}}{2} \ge \sqrt{(75x - 117y) \cdot \frac{96x - 144y}{16}}.
[36m(TaskRunner pid=379036)[0m \]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Simplify the expression and note that the equality will hold when the terms are equal, reaching maximum real part given constraints.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m After simplification and finding the critical parts, we maximize the expression given constraints. The result, after simplification and careful examination, leads to the biggest real part value calculated.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Answer: 241
[36m(TaskRunner pid=379036)[0m [ground_truth] 540
[36m(TaskRunner pid=379036)[0m [score] -1.0
[36m(TaskRunner pid=379036)[0m [acc] False
[36m(TaskRunner pid=379036)[0m [pred] 241
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['reward']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['score']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['acc']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['pred']: 960
[36m(TaskRunner pid=379036)[0m local_global_step_folder: /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_40
[36m(TaskRunner pid=379036)[0m step:40 - global_seqlen/min:534976 - global_seqlen/max:581457 - global_seqlen/minmax_diff:46481 - global_seqlen/balanced_min:566653 - global_seqlen/balanced_max:566691 - global_seqlen/mean:566672.125 - actor/entropy:0.7962008118629456 - actor/pg_loss:0.031500150842568395 - actor/pg_clipfrac:0.002592421322727315 - actor/ppo_kl:0.0005021438487665653 - actor/pg_clipfrac_lower:2.2919852268781252e-06 - actor/grad_norm:0.5457814186811447 - perf/mfu/actor:0.4014118786384368 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.82038116455078 - actor/lr:1e-06 - val-aux/math_dapo/reward/mean@32:-0.96875 - val-aux/math_dapo/reward/std@32:0.09342305289836308 - val-aux/math_dapo/reward/best@2/mean:-0.9392666666666667 - val-aux/math_dapo/reward/best@2/std:0.12233805675972696 - val-aux/math_dapo/reward/worst@2/mean:-0.9964000000000001 - val-aux/math_dapo/reward/worst@2/std:0.030771200958492128 - val-aux/math_dapo/reward/maj@2/mean:-0.9687333333333333 - val-aux/math_dapo/reward/maj@2/std:0.09286236195639633 - val-aux/math_dapo/reward/best@4/mean:-0.8933333333333333 - val-aux/math_dapo/reward/best@4/std:0.14668131642405574 - val-aux/math_dapo/reward/worst@4/mean:-1.0 - val-aux/math_dapo/reward/worst@4/std:0.0 - val-aux/math_dapo/reward/maj@4/mean:-0.9662666666666666 - val-aux/math_dapo/reward/maj@4/std:0.094267367421465 - val-aux/math_dapo/reward/best@8/mean:-0.8258666666666666 - val-aux/math_dapo/reward/best@8/std:0.15345296156061441 - val-aux/math_dapo/reward/worst@8/mean:-1.0 - val-aux/math_dapo/reward/worst@8/std:0.0 - val-aux/math_dapo/reward/maj@8/mean:-0.9603333333333333 - val-aux/math_dapo/reward/maj@8/std:0.0936537784643656 - val-aux/math_dapo/reward/best@16/mean:-0.7582000000000001 - val-aux/math_dapo/reward/best@16/std:0.12985299539949088 - val-aux/math_dapo/reward/worst@16/mean:-1.0 - val-aux/math_dapo/reward/worst@16/std:0.0 - val-aux/math_dapo/reward/maj@16/mean:-0.957 - val-aux/math_dapo/reward/maj@16/std:0.0921112797606263 - val-aux/math_dapo/reward/best@32/mean:-0.7025333333333332 - val-aux/math_dapo/reward/best@32/std:0.07869312990056873 - val-aux/math_dapo/reward/worst@32/mean:-1.0 - val-aux/math_dapo/reward/worst@32/std:0.0 - val-aux/math_dapo/reward/maj@32/mean:-0.9548000000000001 - val-aux/math_dapo/reward/maj@32/std:0.07722910883911957 - val-aux/math_dapo/score/mean@32:-0.96875 - val-aux/math_dapo/score/std@32:0.09342305289836308 - val-aux/math_dapo/score/best@2/mean:-0.9392666666666667 - val-aux/math_dapo/score/best@2/std:0.12233805675972696 - val-aux/math_dapo/score/worst@2/mean:-0.9964000000000001 - val-aux/math_dapo/score/worst@2/std:0.030771200958492128 - val-aux/math_dapo/score/maj@2/mean:-0.9687333333333333 - val-aux/math_dapo/score/maj@2/std:0.09286236195639633 - val-aux/math_dapo/score/best@4/mean:-0.8933333333333333 - val-aux/math_dapo/score/best@4/std:0.14668131642405574 - val-aux/math_dapo/score/worst@4/mean:-1.0 - val-aux/math_dapo/score/worst@4/std:0.0 - val-aux/math_dapo/score/maj@4/mean:-0.9662666666666666 - val-aux/math_dapo/score/maj@4/std:0.094267367421465 - val-aux/math_dapo/score/best@8/mean:-0.8258666666666666 - val-aux/math_dapo/score/best@8/std:0.15345296156061441 - val-aux/math_dapo/score/worst@8/mean:-1.0 - val-aux/math_dapo/score/worst@8/std:0.0 - val-aux/math_dapo/score/maj@8/mean:-0.9603333333333333 - val-aux/math_dapo/score/maj@8/std:0.0936537784643656 - val-aux/math_dapo/score/best@16/mean:-0.7582000000000001 - val-aux/math_dapo/score/best@16/std:0.12985299539949088 - val-aux/math_dapo/score/worst@16/mean:-1.0 - val-aux/math_dapo/score/worst@16/std:0.0 - val-aux/math_dapo/score/maj@16/mean:-0.957 - val-aux/math_dapo/score/maj@16/std:0.0921112797606263 - val-aux/math_dapo/score/best@32/mean:-0.7025333333333332 - val-aux/math_dapo/score/best@32/std:0.07869312990056873 - val-aux/math_dapo/score/worst@32/mean:-1.0 - val-aux/math_dapo/score/worst@32/std:0.0 - val-aux/math_dapo/score/maj@32/mean:-0.9548000000000001 - val-aux/math_dapo/score/maj@32/std:0.07722910883911957 - val-core/math_dapo/acc/mean@32:0.015625 - val-aux/math_dapo/acc/std@32:0.04671152644918154 - val-aux/math_dapo/acc/best@2/mean:0.030366666666666667 - val-aux/math_dapo/acc/best@2/std:0.06116902837986348 - val-aux/math_dapo/acc/worst@2/mean:0.0017999999999999997 - val-aux/math_dapo/acc/worst@2/std:0.01538560047924606 - val-aux/math_dapo/acc/maj@2/mean:0.015633333333333336 - val-aux/math_dapo/acc/maj@2/std:0.04643118097819816 - val-aux/math_dapo/acc/best@4/mean:0.05333333333333334 - val-aux/math_dapo/acc/best@4/std:0.07334065821202787 - val-aux/math_dapo/acc/worst@4/mean:0.0 - val-aux/math_dapo/acc/worst@4/std:0.0 - val-aux/math_dapo/acc/maj@4/mean:0.016866666666666665 - val-aux/math_dapo/acc/maj@4/std:0.0471336837107325 - val-aux/math_dapo/acc/best@8/mean:0.08706666666666667 - val-aux/math_dapo/acc/best@8/std:0.07672648078030721 - val-aux/math_dapo/acc/worst@8/mean:0.0 - val-aux/math_dapo/acc/worst@8/std:0.0 - val-aux/math_dapo/acc/maj@8/mean:0.01983333333333333 - val-aux/math_dapo/acc/maj@8/std:0.0468268892321828 - val-aux/math_dapo/acc/best@16/mean:0.12090000000000001 - val-aux/math_dapo/acc/best@16/std:0.06492649769974544 - val-aux/math_dapo/acc/worst@16/mean:0.0 - val-aux/math_dapo/acc/worst@16/std:0.0 - val-aux/math_dapo/acc/maj@16/mean:0.021500000000000002 - val-aux/math_dapo/acc/maj@16/std:0.04605563988031315 - val-core/math_dapo/acc/best@32/mean:0.14873333333333333 - val-core/math_dapo/acc/best@32/std:0.039346564950284366 - val-aux/math_dapo/acc/worst@32/mean:0.0 - val-aux/math_dapo/acc/worst@32/std:0.0 - val-core/math_dapo/acc/maj@32/mean:0.022600000000000002 - val-core/math_dapo/acc/maj@32/std:0.038614554419559785 - critic/score/mean:-0.239501953125 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.239501953125 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.025769082829356194 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.025769082829356194 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:392.4102783203125 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.00048828125 - prompt_length/mean:160.98046875 - prompt_length/max:920.0 - prompt_length/min:84.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.538094460964203e-06 - timing_s/generate_sequences:214.94741821289062 - timing_s/reshard:4.189626693725586 - timing_s/gen:237.84957200381905 - timing_s/reward:9.395959479734302 - timing_s/old_log_prob:54.56471394561231 - timing_s/adv:0.23012451641261578 - timing_s/update_actor:210.79802123177797 - timing_s/testing:43.70456599071622 - timing_s/save_checkpoint:51.87367781158537 - timing_s/step:610.2293028878048 - timing_s/stop_profile:3.0603259801864624e-06 - timing_per_token_ms/gen:0.07398983458531526 - timing_per_token_ms/update_actor:0.046499115611116824 - timing_per_token_ms/adv:5.0762272013251e-05 - perf/total_num_tokens:4533377 - perf/time_per_step:610.2293028878048 - perf/throughput:928.6216219351021 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:41 - global_seqlen/min:527703 - global_seqlen/max:579172 - global_seqlen/minmax_diff:51469 - global_seqlen/balanced_min:552401 - global_seqlen/balanced_max:552497 - global_seqlen/mean:552425.125 - actor/entropy:0.8342915773391724 - actor/pg_loss:0.029093441177536948 - actor/pg_clipfrac:0.002655952114473383 - actor/ppo_kl:0.0006941151971903286 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.568850927054882 - perf/mfu/actor:0.4001705527192862 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.73340606689453 - actor/lr:1e-06 - critic/score/mean:-0.1689453125 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.1689453125 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.021026859059929848 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.021026859059929848 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:380.1593017578125 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.000244140625 - prompt_length/mean:159.318359375 - prompt_length/max:599.0 - prompt_length/min:85.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.8489157557487488e-06 - timing_s/generate_sequences:207.4425811767578 - timing_s/reshard:3.8525888919830322 - timing_s/gen:231.67366128787398 - timing_s/reward:9.320905762724578 - timing_s/old_log_prob:51.27558248769492 - timing_s/adv:0.2837645411491394 - timing_s/update_actor:206.1147680915892 - timing_s/step:500.5006868420169 - timing_s/stop_profile:1.1166557669639587e-06 - timing_per_token_ms/gen:0.07439111998750074 - timing_per_token_ms/update_actor:0.04663862095600495 - timing_per_token_ms/adv:6.420882403500823e-05 - perf/total_num_tokens:4419401 - perf/time_per_step:500.5006868420169 - perf/throughput:1103.7449888143171 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:42 - global_seqlen/min:530303 - global_seqlen/max:551849 - global_seqlen/minmax_diff:21546 - global_seqlen/balanced_min:541140 - global_seqlen/balanced_max:541258 - global_seqlen/mean:541154.75 - actor/entropy:0.8079299330711365 - actor/pg_loss:0.015623182536666693 - actor/pg_clipfrac:0.0033648323931344815 - actor/ppo_kl:0.0006382831812766663 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5787050686776638 - perf/mfu/actor:0.40400422073310915 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.81011581420898 - actor/lr:1e-06 - critic/score/mean:-0.21374154090881348 - critic/score/max:1.0 - critic/score/min:-1.798828125 - critic/rewards/mean:-0.21374154090881348 - critic/rewards/max:1.0 - critic/rewards/min:-1.798828125 - critic/advantages/mean:-0.01807940937578678 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.01807940937578678 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:368.979248046875 - response_length/max:1945.0 - response_length/min:5.0 - response_length/clip_ratio:0.0 - prompt_length/mean:159.4921875 - prompt_length/max:609.0 - prompt_length/min:83.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.8063153624534607e-06 - timing_s/generate_sequences:206.70571899414062 - timing_s/reshard:5.518145561218262 - timing_s/gen:233.5879200529307 - timing_s/reward:9.19447885453701 - timing_s/old_log_prob:51.89896456152201 - timing_s/adv:0.23098347522318363 - timing_s/update_actor:199.85928222164512 - timing_s/step:496.49282148107886 - timing_s/stop_profile:1.1129304766654968e-06 - timing_per_token_ms/gen:0.07727846633115758 - timing_per_token_ms/update_actor:0.046165002298705946 - timing_per_token_ms/adv:5.335430281799791e-05 - perf/total_num_tokens:4329238 - perf/time_per_step:496.49282148107886 - perf/throughput:1089.954832349219 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:43 - global_seqlen/min:518849 - global_seqlen/max:568892 - global_seqlen/minmax_diff:50043 - global_seqlen/balanced_min:547746 - global_seqlen/balanced_max:547747 - global_seqlen/mean:547746.25 - actor/entropy:0.8476353883743286 - actor/pg_loss:0.03416759278671203 - actor/pg_clipfrac:0.002545626008022258 - actor/ppo_kl:0.0006641002423120163 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5803981237113476 - perf/mfu/actor:0.3994715872610896 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.71780395507812 - actor/lr:1e-06 - critic/score/mean:-0.17722058296203613 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.17722058296203613 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.027825165539979935 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.027825165539979935 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:374.488525390625 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0006103515625 - prompt_length/mean:160.419921875 - prompt_length/max:788.0 - prompt_length/min:86.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.037974238395691e-06 - timing_s/generate_sequences:207.13580322265625 - timing_s/reshard:3.8196334838867188 - timing_s/gen:223.26392840314656 - timing_s/reward:9.38208228442818 - timing_s/old_log_prob:52.577799825929105 - timing_s/adv:0.2708337502554059 - timing_s/update_actor:204.6991762733087 - timing_s/step:492.079168102704 - timing_s/stop_profile:1.194886863231659e-06 - timing_per_token_ms/gen:0.07277632200271417 - timing_per_token_ms/update_actor:0.04671396113467429 - timing_per_token_ms/adv:6.180639079122082e-05 - perf/total_num_tokens:4381970 - perf/time_per_step:492.079168102704 - perf/throughput:1113.1262721645585 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:44 - global_seqlen/min:534363 - global_seqlen/max:579476 - global_seqlen/minmax_diff:45113 - global_seqlen/balanced_min:567508 - global_seqlen/balanced_max:567509 - global_seqlen/mean:567508.25 - actor/entropy:0.879273533821106 - actor/pg_loss:0.03175013810715039 - actor/pg_clipfrac:0.002963857263864973 - actor/ppo_kl:0.000883930621196547 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5637566931545734 - perf/mfu/actor:0.39770696477707285 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.97716903686523 - actor/lr:1e-06 - critic/score/mean:-0.21149659156799316 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.21149659156799316 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.02906152606010437 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.02906152606010437 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:388.318603515625 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.000244140625 - prompt_length/mean:165.888671875 - prompt_length/max:766.0 - prompt_length/min:83.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.244036972522736e-06 - timing_s/generate_sequences:207.79867553710938 - timing_s/reshard:3.4640865325927734 - timing_s/gen:226.64809488970786 - timing_s/reward:9.42655067704618 - timing_s/old_log_prob:52.94813902489841 - timing_s/adv:0.23609165288507938 - timing_s/update_actor:213.10307021904737 - timing_s/step:504.00344101991504 - timing_s/stop_profile:1.4333054423332214e-06 - timing_per_token_ms/gen:0.07124820577802433 - timing_per_token_ms/update_actor:0.046938319887650834 - timing_per_token_ms/adv:5.200181074131508e-05 - perf/total_num_tokens:4540066 - perf/time_per_step:504.00344101991504 - perf/throughput:1126.000744859152 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:45 - global_seqlen/min:509650 - global_seqlen/max:558515 - global_seqlen/minmax_diff:48865 - global_seqlen/balanced_min:534768 - global_seqlen/balanced_max:534769 - global_seqlen/mean:534768.625 - actor/entropy:0.8610504269599915 - actor/pg_loss:0.001750076339648874 - actor/pg_clipfrac:0.002779624783301151 - actor/ppo_kl:0.0006422613892668504 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5799033232033253 - perf/mfu/actor:0.3983172240277044 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:232.16422653198242 - actor/lr:1e-06 - critic/score/mean:-0.20839548110961914 - critic/score/max:1.0 - critic/score/min:-1.8125 - critic/rewards/mean:-0.20839548110961914 - critic/rewards/max:1.0 - critic/rewards/min:-1.8125 - critic/advantages/mean:-0.015233553014695644 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.015233553014695644 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:361.8541259765625 - response_length/max:1952.0 - response_length/min:5.0 - response_length/clip_ratio:0.0 - prompt_length/mean:160.380859375 - prompt_length/max:788.0 - prompt_length/min:88.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:4.071742296218872e-06 - timing_s/generate_sequences:207.4021759033203 - timing_s/reshard:4.3056840896606445 - timing_s/gen:229.23491023574024 - timing_s/reward:9.434471165761352 - timing_s/old_log_prob:50.26383001450449 - timing_s/adv:0.26539065409451723 - timing_s/update_actor:200.41428370401263 - timing_s/step:491.4157456429675 - timing_s/stop_profile:1.1967495083808899e-06 - timing_per_token_ms/gen:0.07733165140197605 - timing_per_token_ms/update_actor:0.04684602703272201 - timing_per_token_ms/adv:6.203399042308185e-05 - perf/total_num_tokens:4278149 - perf/time_per_step:491.4157456429675 - perf/throughput:1088.2203709209798 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:46 - global_seqlen/min:535489 - global_seqlen/max:571919 - global_seqlen/minmax_diff:36430 - global_seqlen/balanced_min:553382 - global_seqlen/balanced_max:553437 - global_seqlen/mean:553416.625 - actor/entropy:0.908408522605896 - actor/pg_loss:-0.007230038183978668 - actor/pg_clipfrac:0.002909401391162628 - actor/ppo_kl:0.0007801368664052289 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5747527666389942 - perf/mfu/actor:0.4034530835344728 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.82509994506836 - actor/lr:1e-06 - critic/score/mean:-0.1522216796875 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.1522216796875 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.019280554726719856 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.019280554726719856 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:382.2427978515625 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0006103515625 - prompt_length/mean:158.203125 - prompt_length/max:893.0 - prompt_length/min:86.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.4961849451065063e-06 - timing_s/generate_sequences:208.14651489257812 - timing_s/reshard:3.9284353256225586 - timing_s/gen:230.98240432608873 - timing_s/reward:9.43030227534473 - timing_s/old_log_prob:52.128783071413636 - timing_s/adv:0.4100027559325099 - timing_s/update_actor:204.7465750509873 - timing_s/step:499.39217640273273 - timing_s/stop_profile:1.084059476852417e-06 - timing_per_token_ms/gen:0.07376488042826768 - timing_per_token_ms/update_actor:0.04624603007069658 - timing_per_token_ms/adv:9.260716461411642e-05 - perf/total_num_tokens:4427333 - perf/time_per_step:499.39217640273273 - perf/throughput:1108.1804064020807 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:47 - global_seqlen/min:519368 - global_seqlen/max:557578 - global_seqlen/minmax_diff:38210 - global_seqlen/balanced_min:536781 - global_seqlen/balanced_max:536782 - global_seqlen/mean:536781.5 - actor/entropy:0.9062356948852539 - actor/pg_loss:-0.0132831218494039 - actor/pg_clipfrac:0.0024202417863016554 - actor/ppo_kl:0.0007435476081005296 - actor/pg_clipfrac_lower:2.414881422811625e-06 - actor/grad_norm:0.5763007551431656 - perf/mfu/actor:0.4057525041596889 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:231.85813903808594 - actor/lr:1e-06 - critic/score/mean:-0.15339422225952148 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.15339422225952148 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.0244537852704525 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.0244537852704525 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:365.32568359375 - response_length/max:2048.0 - response_length/min:11.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:158.875 - prompt_length/max:1158.0 - prompt_length/min:87.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.9494985938072205e-06 - timing_s/generate_sequences:200.59841918945312 - timing_s/reshard:3.3954827785491943 - timing_s/gen:221.10012060776353 - timing_s/reward:8.89343546051532 - timing_s/old_log_prob:51.14063857868314 - timing_s/adv:0.2283778078854084 - timing_s/update_actor:197.41566904261708 - timing_s/step:480.2808959269896 - timing_s/stop_profile:1.2191012501716614e-06 - timing_per_token_ms/gen:0.07387862947624174 - timing_per_token_ms/update_actor:0.045972073609703644 - timing_per_token_ms/adv:5.3182209121730254e-05 - perf/total_num_tokens:4294252 - perf/time_per_step:480.2808959269896 - perf/throughput:1117.6407484706604 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:48 - global_seqlen/min:512692 - global_seqlen/max:563198 - global_seqlen/minmax_diff:50506 - global_seqlen/balanced_min:538004 - global_seqlen/balanced_max:538005 - global_seqlen/mean:538004.375 - actor/entropy:0.8332432508468628 - actor/pg_loss:-0.006117026988618277 - actor/pg_clipfrac:0.002998875323887537 - actor/ppo_kl:0.0007618604591510956 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.56730055809021 - perf/mfu/actor:0.40151256571543303 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:232.08697891235352 - actor/lr:1e-06 - critic/score/mean:-0.18070459365844727 - critic/score/max:1.0 - critic/score/min:-2.0 - critic/rewards/mean:-0.18070459365844727 - critic/rewards/max:1.0 - critic/rewards/min:-2.0 - critic/advantages/mean:-0.015821164473891258 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.015821164473891258 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:367.5101318359375 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0003662109375 - prompt_length/mean:157.884765625 - prompt_length/max:1440.0 - prompt_length/min:84.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.7243589758872986e-06 - timing_s/generate_sequences:202.53427124023438 - timing_s/reshard:3.7978529930114746 - timing_s/gen:225.93068468850106 - timing_s/reward:9.272289175540209 - timing_s/old_log_prob:50.57638277951628 - timing_s/adv:0.26735189836472273 - timing_s/update_actor:200.04732705652714 - timing_s/step:487.72914644051343 - timing_s/stop_profile:1.3513490557670593e-06 - timing_per_token_ms/gen:0.07504399714230517 - timing_per_token_ms/update_actor:0.046479019584303366 - timing_per_token_ms/adv:6.211657162748973e-05 - perf/total_num_tokens:4304035 - perf/time_per_step:487.72914644051343 - perf/throughput:1103.0802217304404 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m step:49 - global_seqlen/min:524249 - global_seqlen/max:568832 - global_seqlen/minmax_diff:44583 - global_seqlen/balanced_min:544302 - global_seqlen/balanced_max:544303 - global_seqlen/mean:544302.75 - actor/entropy:0.8675228953361511 - actor/pg_loss:-0.0029175570855538052 - actor/pg_clipfrac:0.002370556867487418 - actor/ppo_kl:0.0006905382065087906 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5644085630774498 - perf/mfu/actor:0.4014029778277346 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:232.02360916137695 - actor/lr:1e-06 - critic/score/mean:-0.14504003524780273 - critic/score/max:1.0 - critic/score/min:-1.103515625 - critic/rewards/mean:-0.14504003524780273 - critic/rewards/max:1.0 - critic/rewards/min:-1.103515625 - critic/advantages/mean:-0.015584956854581833 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.015584956854581833 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:369.768310546875 - response_length/max:1589.0 - response_length/min:5.0 - response_length/clip_ratio:0.0 - prompt_length/mean:161.77734375 - prompt_length/max:1158.0 - prompt_length/min:84.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.0640512704849243e-06 - timing_s/generate_sequences:201.88294982910156 - timing_s/reshard:3.6958532333374023 - timing_s/gen:220.04080359637737 - timing_s/reward:9.245292222127318 - timing_s/old_log_prob:52.72654811665416 - timing_s/adv:0.24997397791594267 - timing_s/update_actor:202.9013771470636 - timing_s/step:487.03415609896183 - timing_s/stop_profile:1.3569369912147522e-06 - timing_per_token_ms/gen:0.0726412969733269 - timing_per_token_ms/update_actor:0.0465966268650727 - timing_per_token_ms/adv:5.740692517076725e-05 - perf/total_num_tokens:4354422 - perf/time_per_step:487.03415609896183 - perf/throughput:1117.5864016596847 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 50}
[36m(TaskRunner pid=379036)[0m validation generation end
[36m(TaskRunner pid=379036)[0m [prompt] system
[36m(TaskRunner pid=379036)[0m You are a helpful assistant.
[36m(TaskRunner pid=379036)[0m user
[36m(TaskRunner pid=379036)[0m Solve the following math problem step by step. The last line of your response should be of the form Answer: $Answer (without quotes) where $Answer is the answer to the problem.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Find the largest possible real part of \[(75+117i)z+\frac{96+144i}{z}\]where $z$ is a complex number with $|z|=4$.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Remember to put your answer on its own line after "Answer:".
[36m(TaskRunner pid=379036)[0m assistant
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m [response] First, let $z = x + yi$, where $x$ and $y$ are real numbers, and $|z| = 4$ gives us $x^2 + y^2 = 16$. Our goal is to maximize \[(75+117i)z + \frac{96+144i}{z} = (75+117i)(x + yi) + \frac{96+144i}{x + yi}.\] 
[36m(TaskRunner pid=379036)[0m Expanding the terms, we get \[(75x - 117y) + (75y + 117x)i + \frac{96x - 144y}{x^2+y^2} + \frac{96y + 144x i}{x^2+y^2}.\]
[36m(TaskRunner pid=379036)[0m Simplifying because $x^2 + y^2 = 16$ further simplifies \[\begin{aligned}
[36m(TaskRunner pid=379036)[0m     (75x - 117y) + (75y + 117x)i + \frac{96x - 144y}{16} + \frac{96y + 144x i}{16},\\
[36m(TaskRunner pid=379036)[0m     = (75x - 117y) + (75y + 117x)i + 6x - 9y + \frac{96y + 144x i}{16}.
[36m(TaskRunner pid=379036)[0m \end{aligned}\]
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m We focus on the real part \[(75x - 117y) + 6x - 9y\] which simplifies to \[ (75 + 6)x - (117 + 9)y = 81x - 126y.\]
[36m(TaskRunner pid=379036)[0m We maximize this $81x - 126y$ under the constraint $x^2 + y^2 = 16$.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Likewise, the imaginary part is not asked for optimization in finding the maximum real part.
[36m(TaskRunner pid=379036)[0m Lastly, by maximizing  $81x - 126y$ under the constraint $x^2 + y^2 = 16$ (consider the direction and magnitude optimization using the constraint), we obtain the maximum value of $81x - 126y$ given the variable optimization.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m The maximum possible value for the expression occurs when $x$ and $y$ satisfy the constraint $x^2 + y^2 = 16$ yields the maximum real part of our function.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Finding and verifying the maximum value follows calculus optimization methods or using the AM-GM inequality potentially without any missing step step details for brevity.
[36m(TaskRunner pid=379036)[0m 
[36m(TaskRunner pid=379036)[0m Answer: 243
[36m(TaskRunner pid=379036)[0m [ground_truth] 540
[36m(TaskRunner pid=379036)[0m [score] -1.0
[36m(TaskRunner pid=379036)[0m [acc] False
[36m(TaskRunner pid=379036)[0m [pred] 243
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['reward']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['score']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['acc']: 960
[36m(TaskRunner pid=379036)[0m len reward_extra_infos_dict['pred']: 960
[36m(TaskRunner pid=379036)[0m local_global_step_folder: /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_50
[36m(TaskRunner pid=379036)[0m Training Progress:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 49/50 [8:11:01<10:01, 601.26s/it]
[36m(WorkerDict pid=384154)[0m INFO:2025-07-23 02:45:47,641:[Rank 7] Saved optim to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_50/actor/optim_world_size_8_rank_7.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=384154)[0m INFO:2025-07-23 02:45:47,650:[Rank 7] Saved extra_state to /workspace/ckpts/DAPO/DAPO-Qwen2-7B-Test/global_step_50/actor/extra_state_world_size_8_rank_7.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=379036)[0m step:50 - global_seqlen/min:542758 - global_seqlen/max:561411 - global_seqlen/minmax_diff:18653 - global_seqlen/balanced_min:552206 - global_seqlen/balanced_max:552207 - global_seqlen/mean:552206.25 - actor/entropy:0.8773270845413208 - actor/pg_loss:-0.052422754491042146 - actor/pg_clipfrac:0.0026768670753594243 - actor/ppo_kl:0.0008098246289861029 - actor/pg_clipfrac_lower:2.313272584854674e-06 - actor/grad_norm:0.5786840729415417 - perf/mfu/actor:0.4005124586741128 - perf/max_memory_allocated_gb:82.42260551452637 - perf/max_memory_reserved_gb:115.328125 - perf/cpu_memory_used_gb:232.1519775390625 - actor/lr:1e-06 - val-aux/math_dapo/reward/mean@32:-0.98125 - val-aux/math_dapo/reward/std@32:0.08196750666004944 - val-aux/math_dapo/reward/best@2/mean:-0.9634 - val-aux/math_dapo/reward/best@2/std:0.11045951162411637 - val-aux/math_dapo/reward/worst@2/mean:-0.9986666666666667 - val-aux/math_dapo/reward/worst@2/std:0.014924325290497779 - val-aux/math_dapo/reward/maj@2/mean:-0.9800666666666668 - val-aux/math_dapo/reward/maj@2/std:0.08322881124030142 - val-aux/math_dapo/reward/best@4/mean:-0.9294666666666667 - val-aux/math_dapo/reward/best@4/std:0.14682986535662923 - val-aux/math_dapo/reward/worst@4/mean:-1.0 - val-aux/math_dapo/reward/worst@4/std:0.0 - val-aux/math_dapo/reward/maj@4/mean:-0.9841333333333334 - val-aux/math_dapo/reward/maj@4/std:0.07555276541491455 - val-aux/math_dapo/reward/best@8/mean:-0.8721333333333333 - val-aux/math_dapo/reward/best@8/std:0.1790629605662225 - val-aux/math_dapo/reward/worst@8/mean:-1.0 - val-aux/math_dapo/reward/worst@8/std:0.0 - val-aux/math_dapo/reward/maj@8/mean:-0.9886666666666667 - val-aux/math_dapo/reward/maj@8/std:0.05923077610475242 - val-aux/math_dapo/reward/best@16/mean:-0.7925333333333333 - val-aux/math_dapo/reward/best@16/std:0.19037707239284127 - val-aux/math_dapo/reward/worst@16/mean:-1.0 - val-aux/math_dapo/reward/worst@16/std:0.0 - val-aux/math_dapo/reward/maj@16/mean:-0.9902000000000001 - val-aux/math_dapo/reward/maj@16/std:0.048463940457983724 - val-aux/math_dapo/reward/best@32/mean:-0.7047333333333333 - val-aux/math_dapo/reward/best@32/std:0.16310888990287872 - val-aux/math_dapo/reward/worst@32/mean:-1.0 - val-aux/math_dapo/reward/worst@32/std:0.0 - val-aux/math_dapo/reward/maj@32/mean:-0.9935999999999999 - val-aux/math_dapo/reward/maj@32/std:0.028528439818805016 - val-aux/math_dapo/score/mean@32:-0.98125 - val-aux/math_dapo/score/std@32:0.08196750666004944 - val-aux/math_dapo/score/best@2/mean:-0.9634 - val-aux/math_dapo/score/best@2/std:0.11045951162411637 - val-aux/math_dapo/score/worst@2/mean:-0.9986666666666667 - val-aux/math_dapo/score/worst@2/std:0.014924325290497779 - val-aux/math_dapo/score/maj@2/mean:-0.9800666666666668 - val-aux/math_dapo/score/maj@2/std:0.08322881124030142 - val-aux/math_dapo/score/best@4/mean:-0.9294666666666667 - val-aux/math_dapo/score/best@4/std:0.14682986535662923 - val-aux/math_dapo/score/worst@4/mean:-1.0 - val-aux/math_dapo/score/worst@4/std:0.0 - val-aux/math_dapo/score/maj@4/mean:-0.9841333333333334 - val-aux/math_dapo/score/maj@4/std:0.07555276541491455 - val-aux/math_dapo/score/best@8/mean:-0.8721333333333333 - val-aux/math_dapo/score/best@8/std:0.1790629605662225 - val-aux/math_dapo/score/worst@8/mean:-1.0 - val-aux/math_dapo/score/worst@8/std:0.0 - val-aux/math_dapo/score/maj@8/mean:-0.9886666666666667 - val-aux/math_dapo/score/maj@8/std:0.05923077610475242 - val-aux/math_dapo/score/best@16/mean:-0.7925333333333333 - val-aux/math_dapo/score/best@16/std:0.19037707239284127 - val-aux/math_dapo/score/worst@16/mean:-1.0 - val-aux/math_dapo/score/worst@16/std:0.0 - val-aux/math_dapo/score/maj@16/mean:-0.9902000000000001 - val-aux/math_dapo/score/maj@16/std:0.048463940457983724 - val-aux/math_dapo/score/best@32/mean:-0.7047333333333333 - val-aux/math_dapo/score/best@32/std:0.16310888990287872 - val-aux/math_dapo/score/worst@32/mean:-1.0 - val-aux/math_dapo/score/worst@32/std:0.0 - val-aux/math_dapo/score/maj@32/mean:-0.9935999999999999 - val-aux/math_dapo/score/maj@32/std:0.028528439818805016 - val-core/math_dapo/acc/mean@32:0.009375 - val-aux/math_dapo/acc/std@32:0.04098375333002472 - val-aux/math_dapo/acc/best@2/mean:0.018299999999999997 - val-aux/math_dapo/acc/best@2/std:0.05522975581205818 - val-aux/math_dapo/acc/worst@2/mean:0.0006666666666666666 - val-aux/math_dapo/acc/worst@2/std:0.0074621626452488895 - val-aux/math_dapo/acc/maj@2/mean:0.009966666666666667 - val-aux/math_dapo/acc/maj@2/std:0.0416144056201507 - val-aux/math_dapo/acc/best@4/mean:0.03526666666666666 - val-aux/math_dapo/acc/best@4/std:0.07341493267831461 - val-aux/math_dapo/acc/worst@4/mean:0.0 - val-aux/math_dapo/acc/worst@4/std:0.0 - val-aux/math_dapo/acc/maj@4/mean:0.007933333333333334 - val-aux/math_dapo/acc/maj@4/std:0.03777638270745727 - val-aux/math_dapo/acc/best@8/mean:0.06393333333333333 - val-aux/math_dapo/acc/best@8/std:0.08953148028311125 - val-aux/math_dapo/acc/worst@8/mean:0.0 - val-aux/math_dapo/acc/worst@8/std:0.0 - val-aux/math_dapo/acc/maj@8/mean:0.005666666666666667 - val-aux/math_dapo/acc/maj@8/std:0.02961538805237621 - val-aux/math_dapo/acc/best@16/mean:0.10373333333333333 - val-aux/math_dapo/acc/best@16/std:0.09518853619642063 - val-aux/math_dapo/acc/worst@16/mean:0.0 - val-aux/math_dapo/acc/worst@16/std:0.0 - val-aux/math_dapo/acc/maj@16/mean:0.004900000000000001 - val-aux/math_dapo/acc/maj@16/std:0.024231970228991862 - val-core/math_dapo/acc/best@32/mean:0.14763333333333334 - val-core/math_dapo/acc/best@32/std:0.08155444495143936 - val-aux/math_dapo/acc/worst@32/mean:0.0 - val-aux/math_dapo/acc/worst@32/std:0.0 - val-core/math_dapo/acc/maj@32/mean:0.0032 - val-core/math_dapo/acc/maj@32/std:0.014264219909402508 - critic/score/mean:-0.183349609375 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:-0.183349609375 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.008531542494893074 - critic/advantages/max:3.7499923706054688 - critic/advantages/min:-3.7499923706054688 - critic/returns/mean:-0.008531542494893074 - critic/returns/max:3.7499923706054688 - critic/returns/min:-3.7499923706054688 - response_length/mean:375.998291015625 - response_length/max:1170.0 - response_length/min:5.0 - response_length/clip_ratio:0.0 - prompt_length/mean:163.265625 - prompt_length/max:787.0 - prompt_length/min:91.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.345310688018799e-06 - timing_s/generate_sequences:202.73062133789062 - timing_s/reshard:3.6686809062957764 - timing_s/gen:219.25579231511801 - timing_s/reward:9.249210272915661 - timing_s/old_log_prob:51.7437874218449 - timing_s/adv:0.2518812492489815 - timing_s/update_actor:205.80663823429495 - timing_s/testing:39.334619050845504 - timing_s/save_checkpoint:50.70981413498521 - timing_s/step:578.1106887925416 - timing_s/stop_profile:2.5993213057518005e-06 - timing_per_token_ms/gen:0.07118283174385312 - timing_per_token_ms/update_actor:0.04658735713202607 - timing_per_token_ms/adv:5.70170224551473e-05 - perf/total_num_tokens:4417650 - perf/time_per_step:578.1106887925416 - perf/throughput:955.1912128685142 - train/num_gen_batches:1
[36m(TaskRunner pid=379036)[0m ("Final validation metrics: {'val-aux/math_dapo/reward/mean@32': -0.98125, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/std@32': 0.08196750666004944, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@2/mean': -0.9634, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@2/std': 0.11045951162411637, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@2/mean': -0.9986666666666667, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@2/std': 0.014924325290497779, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@2/mean': -0.9800666666666668, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@2/std': 0.08322881124030142, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@4/mean': -0.9294666666666667, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@4/std': 0.14682986535662923, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@4/mean': -1.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@4/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@4/mean': -0.9841333333333334, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@4/std': 0.07555276541491455, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@8/mean': -0.8721333333333333, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@8/std': 0.1790629605662225, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@8/mean': -1.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@8/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@8/mean': -0.9886666666666667, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@8/std': 0.05923077610475242, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@16/mean': -0.7925333333333333, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@16/std': 0.19037707239284127, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@16/mean': -1.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@16/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@16/mean': -0.9902000000000001, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@16/std': 0.048463940457983724, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@32/mean': -0.7047333333333333, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/best@32/std': 0.16310888990287872, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@32/mean': -1.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/worst@32/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@32/mean': -0.9935999999999999, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/reward/maj@32/std': 0.028528439818805016, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/mean@32': -0.98125, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/std@32': 0.08196750666004944, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@2/mean': -0.9634, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@2/std': 0.11045951162411637, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@2/mean': -0.9986666666666667, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@2/std': 0.014924325290497779, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@2/mean': -0.9800666666666668, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@2/std': 0.08322881124030142, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@4/mean': -0.9294666666666667, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@4/std': 0.14682986535662923, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@4/mean': -1.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@4/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@4/mean': -0.9841333333333334, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@4/std': 0.07555276541491455, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@8/mean': -0.8721333333333333, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@8/std': 0.1790629605662225, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@8/mean': -1.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@8/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@8/mean': -0.9886666666666667, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@8/std': 0.05923077610475242, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@16/mean': -0.7925333333333333, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@16/std': 0.19037707239284127, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@16/mean': -1.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@16/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@16/mean': -0.9902000000000001, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@16/std': 0.048463940457983724, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@32/mean': -0.7047333333333333, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/best@32/std': 0.16310888990287872, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@32/mean': -1.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/worst@32/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@32/mean': -0.9935999999999999, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/score/maj@32/std': 0.028528439818805016, "
[36m(TaskRunner pid=379036)[0m  "'val-core/math_dapo/acc/mean@32': 0.009375, 'val-aux/math_dapo/acc/std@32': "
[36m(TaskRunner pid=379036)[0m  "0.04098375333002472, 'val-aux/math_dapo/acc/best@2/mean': "
[36m(TaskRunner pid=379036)[0m  "0.018299999999999997, 'val-aux/math_dapo/acc/best@2/std': "
[36m(TaskRunner pid=379036)[0m  "0.05522975581205818, 'val-aux/math_dapo/acc/worst@2/mean': "
[36m(TaskRunner pid=379036)[0m  "0.0006666666666666666, 'val-aux/math_dapo/acc/worst@2/std': "
[36m(TaskRunner pid=379036)[0m  "0.0074621626452488895, 'val-aux/math_dapo/acc/maj@2/mean': "
[36m(TaskRunner pid=379036)[0m  "0.009966666666666667, 'val-aux/math_dapo/acc/maj@2/std': 0.0416144056201507, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/best@4/mean': 0.03526666666666666, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/best@4/std': 0.07341493267831461, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@4/mean': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@4/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/maj@4/mean': 0.007933333333333334, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/maj@4/std': 0.03777638270745727, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/best@8/mean': 0.06393333333333333, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/best@8/std': 0.08953148028311125, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@8/mean': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@8/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/maj@8/mean': 0.005666666666666667, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/maj@8/std': 0.02961538805237621, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/best@16/mean': 0.10373333333333333, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/best@16/std': 0.09518853619642063, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@16/mean': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@16/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/maj@16/mean': 0.004900000000000001, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/maj@16/std': 0.024231970228991862, "
[36m(TaskRunner pid=379036)[0m  "'val-core/math_dapo/acc/best@32/mean': 0.14763333333333334, "
[36m(TaskRunner pid=379036)[0m  "'val-core/math_dapo/acc/best@32/std': 0.08155444495143936, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@32/mean': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-aux/math_dapo/acc/worst@32/std': 0.0, "
[36m(TaskRunner pid=379036)[0m  "'val-core/math_dapo/acc/maj@32/mean': 0.0032, "
[36m(TaskRunner pid=379036)[0m  "'val-core/math_dapo/acc/maj@32/std': 0.014264219909402508}")
[33m(raylet)[0m A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: ffffffffffffffff447622a106975f42692a05ce01000000 Worker ID: c0144186cada5a258b4cc8b7cc31ab2bf326ba4a333f1bb467469880 Node ID: b290c96514c5e64ae7eafa40664b955534b19b7e9c76da9587b437d9 Worker IP address: 10.1.15.172 Worker port: 35333 Worker PID: 384153 Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly by a signal. SystemExit is raised (sys.exit is called). Exit code: 1. The process receives a SIGTERM.
[33m(raylet)[0m A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: ffffffffffffffffec8bd76d49116443766d0ffa01000000 Worker ID: 9b620d02b3729700c751012c5a6362f7b7ca10c870aeb4d18aba74f0 Node ID: b290c96514c5e64ae7eafa40664b955534b19b7e9c76da9587b437d9 Worker IP address: 10.1.15.172 Worker port: 36187 Worker PID: 384154 Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly by a signal. SystemExit is raised (sys.exit is called). Exit code: 1. The process receives a SIGTERM.[32m [repeated 2x across cluster][0m
