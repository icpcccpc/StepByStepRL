nohup: ignoring input
+ project_name=my_DAPO
+ exp_name=DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724
+ adv_estimator=grpo
+ use_kl_in_reward=False
+ kl_coef=0.0
+ use_kl_loss=False
+ kl_loss_coef=0.0
+ clip_ratio_low=0.2
+ clip_ratio_high=0.28
+ max_prompt_length=3072
+ max_response_length=2048
+ enable_overlong_buffer=True
+ overlong_buffer_len=512
+ overlong_penalty_factor=1.0
+ loss_agg_mode=token-mean
+ enable_filter_groups=True
+ filter_groups_metric=seq_reward
+ max_num_gen_batches=10
+ train_prompt_bsz=512
+ gen_prompt_bsz=512
+ train_prompt_mini_bsz=32
+ n_layer1=4
+ n_layer2=4
+ WORKING_DIR=/workspace/lujiahao/verl
+ RUNTIME_ENV=/workspace/lujiahao/verl/verl/trainer/runtime_env.yaml
+ NNODES=1
+ RAY_DATA_HOME=/workspace
+ MODEL_PATH=/workspace/models/Qwen/Qwen2.5-7B-Instruct-1M
+ CKPTS_DIR=/workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724
+ TRAIN_FILE=/workspace/data/math/train.parquet
+ TEST_FILE=/workspace/data/math/test.parquet
+ export TENSORBOARD_DIR=/workspace/log/tensorboard/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724
+ TENSORBOARD_DIR=/workspace/log/tensorboard/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724
+ temperature=1.0
+ top_p=1.0
+ top_k=-1
+ use_dynamic_bsz=True
+ infer_micro_batch_size=null
+ train_micro_batch_size=null
+ offload=False
+ python3 -m recipe.dapo.my_main_dapo data.train_files=/workspace/data/math/train.parquet data.val_files=/workspace/data/math/test.parquet data.prompt_key=prompt data.truncation=left data.max_prompt_length=3072 data.max_response_length=2048 data.gen_batch_size=512 data.train_batch_size=512 +actor_rollout_ref.rollout.n_layer1=4 +actor_rollout_ref.rollout.n_layer2=4 actor_rollout_ref.actor.use_kl_loss=False actor_rollout_ref.actor.kl_loss_coef=0.0 actor_rollout_ref.actor.clip_ratio_low=0.2 actor_rollout_ref.actor.clip_ratio_high=0.28 actor_rollout_ref.actor.clip_ratio_c=10.0 algorithm.adv_estimator=grpo algorithm.use_kl_in_reward=False algorithm.kl_ctrl.kl_coef=0.0 algorithm.filter_groups.enable=True algorithm.filter_groups.metric=seq_reward algorithm.filter_groups.max_num_gen_batches=10 actor_rollout_ref.model.use_remove_padding=True actor_rollout_ref.actor.use_dynamic_bsz=True actor_rollout_ref.ref.log_prob_use_dynamic_bsz=True actor_rollout_ref.rollout.log_prob_use_dynamic_bsz=True actor_rollout_ref.actor.ppo_max_token_len_per_gpu=5120 actor_rollout_ref.ref.log_prob_max_token_len_per_gpu=5120 actor_rollout_ref.rollout.log_prob_max_token_len_per_gpu=5120 actor_rollout_ref.model.path=/workspace/models/Qwen/Qwen2.5-7B-Instruct-1M actor_rollout_ref.model.enable_gradient_checkpointing=True actor_rollout_ref.actor.optim.lr=1e-6 actor_rollout_ref.actor.optim.lr_warmup_steps=10 actor_rollout_ref.actor.optim.weight_decay=0.1 actor_rollout_ref.actor.ppo_mini_batch_size=32 actor_rollout_ref.actor.ppo_micro_batch_size=null actor_rollout_ref.actor.fsdp_config.param_offload=False actor_rollout_ref.actor.fsdp_config.optimizer_offload=False actor_rollout_ref.actor.entropy_coeff=0 actor_rollout_ref.actor.grad_clip=1.0 actor_rollout_ref.actor.loss_agg_mode=token-mean actor_rollout_ref.actor.ulysses_sequence_parallel_size=1 actor_rollout_ref.rollout.gpu_memory_utilization=0.85 actor_rollout_ref.rollout.log_prob_micro_batch_size=null actor_rollout_ref.rollout.tensor_model_parallel_size=1 actor_rollout_ref.rollout.enable_chunked_prefill=True actor_rollout_ref.rollout.max_num_batched_tokens=5120 actor_rollout_ref.rollout.temperature=1.0 actor_rollout_ref.rollout.top_p=1.0 actor_rollout_ref.rollout.top_k=-1 actor_rollout_ref.rollout.val_kwargs.temperature=1.0 actor_rollout_ref.rollout.val_kwargs.top_p=1.0 actor_rollout_ref.rollout.val_kwargs.top_k=-1 actor_rollout_ref.rollout.val_kwargs.do_sample=True actor_rollout_ref.rollout.val_kwargs.n=1 actor_rollout_ref.ref.log_prob_micro_batch_size=null actor_rollout_ref.ref.fsdp_config.param_offload=False actor_rollout_ref.ref.ulysses_sequence_parallel_size=1 actor_rollout_ref.actor.fsdp_config.fsdp_size=-1 reward_model.reward_manager=dapo reward_model.overlong_buffer.enable=True reward_model.overlong_buffer.len=512 reward_model.overlong_buffer.penalty_factor=1.0 'trainer.logger=[console,tensorboard]' trainer.project_name=my_DAPO trainer.experiment_name=DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724 trainer.n_gpus_per_node=8 trainer.nnodes=1 trainer.val_before_train=True trainer.total_training_steps=100 trainer.test_freq=10 trainer.save_freq=20 trainer.total_epochs=100 trainer.default_local_dir=/workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724 trainer.resume_mode=disable
2025-07-28 13:08:41,938	INFO worker.py:1908 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=3494114)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=3494114)[0m WARNING:2025-07-28 13:08:51,683:Waiting for register center actor aDuzXx_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=3499180)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=3499180)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=3499180)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=3499180)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:09,  3.18s/it]
[36m(WorkerDict pid=3494990)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=3494990)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3494990)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3499180)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:09<00:03,  3.25s/it][32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=3499180)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.17s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.19s/it]
[36m(WorkerDict pid=3499181)[0m /root/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=3499181)[0m   warnings.warn(
[36m(WorkerDict pid=3499179)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:10<00:03,  3.55s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3499179)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.40s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.47s/it][32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3494114)[0m Training Progress:   0%|          | 0/100 [00:00<?, ?it/s]
[36m(WorkerDict pid=3499185)[0m /root/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3499185)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3494114)[0m Training Progress:   1%|          | 1/100 [01:24<2:19:36, 84.61s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:   2%|â–         | 2/100 [02:53<2:22:21, 87.16s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:   3%|â–Ž         | 3/100 [04:22<2:22:17, 88.02s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:   4%|â–         | 4/100 [05:48<2:19:40, 87.30s/it]
[36m(TaskRunner pid=3494114)[0m /workspace/lujiahao/verl/recipe/dapo/my_dapo_ray_trainer.py:633: FutureWarning: Warning: Function 'verl.trainer.ppo.metric_utils.reduce_metrics' is deprecated. Please use 'verl.utils.metric.reduce_metrics' instead.
[36m(TaskRunner pid=3494114)[0m   actor_output_metrics = reduce_metrics(actor_output.meta_info["metrics"])
[36m(TaskRunner pid=3494114)[0m Training Progress:   5%|â–Œ         | 5/100 [15:58<7:16:15, 275.53s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:   6%|â–Œ         | 6/100 [17:26<5:32:15, 212.08s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:   7%|â–‹         | 7/100 [18:55<4:25:54, 171.55s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:   8%|â–Š         | 8/100 [20:22<3:41:45, 144.62s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:   9%|â–‰         | 9/100 [21:51<3:13:03, 127.29s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  10%|â–ˆ         | 10/100 [31:57<6:52:32, 275.03s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  11%|â–ˆ         | 11/100 [33:26<5:23:53, 218.35s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  12%|â–ˆâ–        | 12/100 [34:59<4:24:08, 180.10s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  13%|â–ˆâ–Ž        | 13/100 [36:29<3:41:23, 152.68s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  14%|â–ˆâ–        | 14/100 [38:01<3:12:32, 134.33s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  15%|â–ˆâ–Œ        | 15/100 [48:15<6:35:31, 279.19s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  16%|â–ˆâ–Œ        | 16/100 [49:40<5:08:52, 220.63s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  17%|â–ˆâ–‹        | 17/100 [51:10<4:10:58, 181.43s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  18%|â–ˆâ–Š        | 18/100 [52:36<3:28:25, 152.50s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  19%|â–ˆâ–‰        | 19/100 [54:06<3:00:43, 133.87s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  20%|â–ˆâ–ˆ        | 20/100 [1:04:11<6:07:09, 275.37s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  21%|â–ˆâ–ˆ        | 21/100 [1:05:36<4:47:06, 218.06s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  22%|â–ˆâ–ˆâ–       | 22/100 [1:07:04<3:53:02, 179.27s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:08:30<3:14:09, 151.29s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  24%|â–ˆâ–ˆâ–       | 24/100 [1:09:59<2:47:58, 132.61s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:11:27<2:29:00, 119.21s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:21:32<5:26:31, 264.76s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:23:01<4:18:02, 212.10s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:24:27<3:29:06, 174.26s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:25:57<2:56:17, 148.98s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:27:25<2:32:25, 130.66s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:37:34<5:15:23, 274.25s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:39:06<4:08:38, 219.39s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:40:36<3:21:49, 180.73s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:42:03<2:47:43, 152.47s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:43:29<2:23:48, 132.74s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [1:53:59<5:00:34, 281.79s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [1:55:24<3:53:57, 222.81s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [1:56:50<3:07:42, 181.66s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [1:58:15<2:35:22, 152.83s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [1:59:45<2:14:02, 134.04s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [2:01:13<1:58:05, 120.09s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [2:11:54<4:27:15, 276.47s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [2:12:59<3:22:14, 212.88s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [2:14:00<2:36:19, 167.50s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [2:15:03<2:04:39, 135.98s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [2:16:08<1:43:16, 114.74s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [2:17:14<1:28:26, 100.13s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [2:25:23<3:07:52, 216.77s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [2:26:35<2:27:24, 173.43s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [2:27:46<1:58:54, 142.68s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [2:28:49<1:36:52, 118.63s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [2:29:54<1:22:04, 102.59s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [2:30:56<1:10:51, 90.46s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [2:41:05<3:08:40, 246.09s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 55/100 [2:42:18<2:25:36, 194.15s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 56/100 [2:43:27<1:54:49, 156.59s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 57/100 [2:44:41<1:34:18, 131.60s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 58/100 [2:45:49<1:18:53, 112.71s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 59/100 [2:46:59<1:08:13, 99.84s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 60/100 [2:48:07<1:00:13, 90.34s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 61/100 [2:57:14<2:27:41, 227.23s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 62/100 [2:58:22<1:53:41, 179.52s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 63/100 [2:59:35<1:30:55, 147.45s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 64/100 [3:00:46<1:14:51, 124.76s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 65/100 [3:01:55<1:02:52, 107.79s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 66/100 [3:03:01<54:00, 95.32s/it]   
[36m(TaskRunner pid=3494114)[0m Training Progress:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 67/100 [3:12:13<2:07:50, 232.45s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 68/100 [3:13:31<1:39:13, 186.05s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 69/100 [3:14:46<1:18:55, 152.76s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 70/100 [3:16:00<1:04:34, 129.16s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 71/100 [3:17:19<55:06, 114.03s/it]  
[36m(TaskRunner pid=3494114)[0m Training Progress:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 72/100 [3:18:39<48:26, 103.80s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 73/100 [3:19:56<43:04, 95.74s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/100 [3:29:10<1:41:08, 233.40s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 75/100 [3:30:30<1:18:01, 187.27s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 76/100 [3:31:51<1:02:06, 155.25s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 77/100 [3:33:10<50:45, 132.43s/it]  
[36m(TaskRunner pid=3494114)[0m Training Progress:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 78/100 [3:34:20<41:42, 113.73s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 79/100 [3:35:34<35:37, 101.78s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 80/100 [3:36:49<31:13, 93.66s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 81/100 [3:46:12<1:14:20, 234.75s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 82/100 [3:47:27<56:00, 186.70s/it]  
[36m(TaskRunner pid=3494114)[0m Training Progress:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 83/100 [3:48:42<43:24, 153.22s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 84/100 [3:49:54<34:22, 128.88s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 85/100 [3:51:09<28:10, 112.67s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 86/100 [3:52:18<23:13, 99.50s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 87/100 [3:53:28<19:38, 90.67s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 88/100 [4:02:42<45:54, 229.56s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 89/100 [4:03:52<33:19, 181.78s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 90/100 [4:05:06<24:53, 149.36s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 91/100 [4:06:21<19:05, 127.25s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 92/100 [4:07:38<14:56, 112.09s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 93/100 [4:08:55<11:50, 101.50s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 94/100 [4:10:11<09:23, 93.99s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 95/100 [4:19:30<19:26, 233.36s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 96/100 [4:20:43<12:20, 185.18s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 97/100 [4:21:52<07:31, 150.51s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 98/100 [4:22:57<04:09, 124.89s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 99/100 [4:24:06<01:47, 107.93s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [4:25:18<00:00, 97.14s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 101it [4:26:33, 90.61s/it]                         
[36m(TaskRunner pid=3494114)[0m Training Progress: 102it [4:35:44, 228.72s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 103it [4:37:05, 184.33s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 104it [4:38:19, 151.30s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 105it [4:39:31, 127.52s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 106it [4:40:48, 112.24s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 107it [4:42:11, 103.54s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 108it [4:43:32, 96.74s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 109it [4:53:03, 239.24s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 110it [4:54:22, 191.16s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 111it [4:55:40, 157.10s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 112it [4:56:53, 131.84s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 113it [4:58:10, 115.40s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 114it [4:59:30, 104.87s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 115it [5:00:43, 95.24s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 116it [5:09:48, 230.31s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 117it [5:11:02, 183.42s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 118it [5:12:09, 148.38s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 119it [5:13:28, 127.46s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 120it [5:14:42, 111.50s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 121it [5:16:03, 102.35s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 122it [5:17:15, 93.12s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 123it [5:18:29, 87.62s/it]
[36m(WorkerDict pid=3499185)[0m INFO:2025-07-28 18:40:50,968:[Rank 6] Saved model to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=3499185)[0m INFO:2025-07-28 18:41:20,951:[Rank 6] Saved optim to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=3499185)[0m INFO:2025-07-28 18:41:20,977:[Rank 6] Saved extra_state to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=3499184)[0m INFO:2025-07-28 18:40:52,058:[Rank 5] Saved model to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20/actor/model_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3494990)[0m INFO:2025-07-28 18:41:24,813:[Rank 0] Saved model config and tokenizer class to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20/actor/huggingface
[36m(TaskRunner pid=3494114)[0m Training Progress: 124it [5:30:03, 269.38s/it]
[36m(WorkerDict pid=3499184)[0m INFO:2025-07-28 18:41:25,597:[Rank 5] Saved optim to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20/actor/optim_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3499184)[0m INFO:2025-07-28 18:41:25,603:[Rank 5] Saved extra_state to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20/actor/extra_state_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3494114)[0m Training Progress: 125it [5:31:21, 212.14s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 126it [5:32:33, 170.03s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 127it [5:33:41, 139.47s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 128it [5:34:47, 117.44s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 129it [5:36:00, 104.02s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 130it [5:37:15, 95.35s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 131it [5:38:26, 88.00s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 132it [5:47:19, 221.59s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 133it [5:48:26, 174.96s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 134it [5:49:40, 144.79s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 135it [5:50:57, 124.60s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 136it [5:52:18, 111.48s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 137it [5:53:34, 100.82s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 138it [5:54:47, 92.35s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 139it [5:55:55, 85.23s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 140it [6:05:10, 225.96s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 141it [6:06:21, 179.51s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 142it [6:07:36, 148.20s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 143it [6:08:55, 127.42s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 144it [6:10:09, 111.31s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 145it [6:11:27, 101.47s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 146it [6:12:44, 93.96s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 147it [6:13:55, 87.25s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 148it [6:23:11, 227.76s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 149it [6:24:25, 181.61s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 150it [6:25:41, 149.87s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 151it [6:26:52, 126.23s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 152it [6:28:02, 109.49s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 153it [6:29:15, 98.41s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 154it [6:30:27, 90.67s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 155it [6:31:42, 85.97s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 156it [6:40:59, 227.18s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 157it [6:42:13, 181.38s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 158it [6:43:20, 146.89s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 159it [6:44:23, 121.70s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 160it [6:45:40, 108.40s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 161it [6:46:57, 99.01s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 162it [6:48:06, 90.04s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 163it [6:49:24, 86.42s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 164it [6:50:35, 81.56s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 165it [6:59:50, 223.76s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 166it [7:01:06, 179.49s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 167it [7:02:18, 147.18s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 168it [7:03:32, 125.15s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 169it [7:04:51, 111.21s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 170it [7:06:09, 101.36s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 171it [7:07:26, 94.14s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 172it [7:08:31, 85.34s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 173it [7:18:08, 232.81s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 174it [7:19:24, 185.76s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 175it [7:20:39, 152.57s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 176it [7:21:56, 129.82s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 177it [7:23:19, 115.74s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 178it [7:24:41, 105.60s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 179it [7:26:00, 97.88s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 180it [7:27:20, 92.35s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 181it [7:37:04, 239.82s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 182it [7:38:19, 190.44s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 183it [7:39:36, 156.31s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 184it [7:40:51, 132.05s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 185it [7:42:09, 115.79s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 186it [7:43:19, 102.11s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 187it [7:44:36, 94.57s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 188it [7:45:55, 89.85s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 189it [7:47:13, 86.24s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 190it [7:56:33, 228.28s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 191it [7:57:42, 180.53s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 192it [7:59:02, 150.39s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 193it [8:00:11, 125.92s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 194it [8:01:18, 108.37s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 195it [8:02:34, 98.53s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 196it [8:03:44, 90.24s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 197it [8:04:56, 84.58s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 198it [8:06:13, 82.25s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 199it [8:07:20, 77.81s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 200it [8:16:51, 225.77s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 201it [8:18:05, 180.15s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 202it [8:19:23, 149.67s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 203it [8:20:38, 127.07s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 204it [8:21:49, 110.22s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 205it [8:23:00, 98.48s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 206it [8:24:13, 90.86s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 207it [8:25:34, 88.03s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 208it [8:26:51, 84.56s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 209it [8:37:44, 255.08s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 210it [8:39:06, 203.37s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 211it [8:40:31, 167.77s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 212it [8:41:44, 139.34s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 213it [8:42:56, 119.06s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 214it [8:44:14, 106.84s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 215it [8:45:32, 98.27s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 216it [8:46:51, 92.53s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 217it [8:48:14, 89.61s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 218it [8:57:58, 237.77s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 219it [8:59:09, 187.90s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 220it [9:00:23, 153.55s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 221it [9:01:34, 129.01s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 222it [9:02:47, 112.03s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 223it [9:04:02, 100.84s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 224it [9:05:13, 92.04s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 225it [9:06:32, 88.17s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 226it [9:07:46, 83.93s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 227it [9:09:05, 82.46s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 228it [9:18:35, 228.52s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 229it [9:19:46, 181.40s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 230it [9:20:59, 148.98s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 231it [9:22:18, 127.85s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 232it [9:23:26, 109.90s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 233it [9:24:41, 99.36s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 234it [9:26:02, 93.85s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 235it [9:27:14, 87.48s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 236it [9:28:24, 82.22s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 237it [9:29:35, 78.64s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 238it [9:39:03, 225.51s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 239it [9:40:21, 181.44s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 240it [9:41:36, 149.41s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 241it [9:42:54, 128.03s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 242it [9:44:12, 113.05s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 243it [9:45:31, 102.79s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 244it [9:46:50, 95.51s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 245it [9:47:59, 87.78s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 246it [9:49:15, 84.03s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 247it [9:50:26, 80.23s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 248it [10:00:05, 229.90s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 249it [10:01:25, 184.99s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 250it [10:02:39, 151.65s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 251it [10:03:59, 129.99s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 252it [10:05:15, 113.91s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 253it [10:06:33, 103.01s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 254it [10:07:53, 96.30s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 255it [10:08:58, 86.87s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 256it [10:10:14, 83.66s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 257it [10:11:26, 80.04s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 258it [10:20:47, 224.32s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 259it [10:22:06, 180.78s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 260it [10:23:20, 148.82s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 261it [10:24:29, 124.78s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 262it [10:25:39, 108.41s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 263it [10:26:45, 95.72s/it] 
[36m(TaskRunner pid=3494114)[0m Training Progress: 264it [10:27:56, 88.28s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 265it [10:29:12, 84.46s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 266it [10:30:24, 80.80s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 267it [10:31:44, 80.62s/it]
[36m(TaskRunner pid=3494114)[0m Training Progress: 267it [10:32:56, 142.23s/it]
[36m(TaskRunner pid=3494114)[0m TaskRunner hostname: p-phy-zy-daxing-kt-lc-a800-node-prod-15-172, PID: 3494114
[36m(TaskRunner pid=3494114)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'load_contents': ['model',
[36m(TaskRunner pid=3494114)[0m                                                                   'optimizer',
[36m(TaskRunner pid=3494114)[0m                                                                   'extra'],
[36m(TaskRunner pid=3494114)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=3494114)[0m                                                                   'optimizer',
[36m(TaskRunner pid=3494114)[0m                                                                   'extra']},
[36m(TaskRunner pid=3494114)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=3494114)[0m                                  'clip_ratio_c': 10.0,
[36m(TaskRunner pid=3494114)[0m                                  'clip_ratio_high': 0.28,
[36m(TaskRunner pid=3494114)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=3494114)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=3494114)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=3494114)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=3494114)[0m                                  'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3494114)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=3494114)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=3494114)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=3494114)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=3494114)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=3494114)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3494114)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=3494114)[0m                                  'kl_loss_coef': 0.0,
[36m(TaskRunner pid=3494114)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=3494114)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=3494114)[0m                                  'optim': {'lr': 1e-06,
[36m(TaskRunner pid=3494114)[0m                                            'lr_warmup_steps': 10,
[36m(TaskRunner pid=3494114)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=3494114)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=3494114)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=3494114)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=3494114)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=3494114)[0m                                            'weight_decay': 0.1},
[36m(TaskRunner pid=3494114)[0m                                  'policy_loss': {'clip_cov_lb': 1.0,
[36m(TaskRunner pid=3494114)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=3494114)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=3494114)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=3494114)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=3494114)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=3494114)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=3494114)[0m                                  'ppo_max_token_len_per_gpu': 5120,
[36m(TaskRunner pid=3494114)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=3494114)[0m                                  'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3494114)[0m                                  'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=3494114)[0m                                  'shuffle': False,
[36m(TaskRunner pid=3494114)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=3494114)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3494114)[0m                                  'use_dynamic_bsz': True,
[36m(TaskRunner pid=3494114)[0m                                  'use_kl_loss': False,
[36m(TaskRunner pid=3494114)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=3494114)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=3494114)[0m                        'model': {'custom_chat_template': None,
[36m(TaskRunner pid=3494114)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=3494114)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=3494114)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=3494114)[0m                                  'external_lib': None,
[36m(TaskRunner pid=3494114)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=3494114)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=3494114)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=3494114)[0m                                  'override_config': {},
[36m(TaskRunner pid=3494114)[0m                                  'path': '/workspace/models/Qwen/Qwen2.5-7B-Instruct-1M',
[36m(TaskRunner pid=3494114)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=3494114)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=3494114)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=3494114)[0m                                  'use_liger': False,
[36m(TaskRunner pid=3494114)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=3494114)[0m                                  'use_shm': False},
[36m(TaskRunner pid=3494114)[0m                        'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=3494114)[0m                                     'all_ranks': False,
[36m(TaskRunner pid=3494114)[0m                                     'discrete': False,
[36m(TaskRunner pid=3494114)[0m                                     'ranks': []},
[36m(TaskRunner pid=3494114)[0m                        'ref': {'entropy_checkpointing': False,
[36m(TaskRunner pid=3494114)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=3494114)[0m                                'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3494114)[0m                                                'param_offload': False,
[36m(TaskRunner pid=3494114)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=3494114)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3494114)[0m                                'log_prob_max_token_len_per_gpu': 5120,
[36m(TaskRunner pid=3494114)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=3494114)[0m                                'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3494114)[0m                                'log_prob_use_dynamic_bsz': True,
[36m(TaskRunner pid=3494114)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=3494114)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3494114)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=3494114)[0m                        'rollout': {'agent': {'agent_loop_config_path': None,
[36m(TaskRunner pid=3494114)[0m                                              'custom_async_server': {'name': None,
[36m(TaskRunner pid=3494114)[0m                                                                      'path': None},
[36m(TaskRunner pid=3494114)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=3494114)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=3494114)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=3494114)[0m                                    'do_sample': True,
[36m(TaskRunner pid=3494114)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=3494114)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=3494114)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=3494114)[0m                                    'engine_kwargs': {'sglang': {'attention_backend': None},
[36m(TaskRunner pid=3494114)[0m                                                      'vllm': {'disable_mm_preprocessor_cache': False,
[36m(TaskRunner pid=3494114)[0m                                                               'swap_space': None}},
[36m(TaskRunner pid=3494114)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=3494114)[0m                                    'gpu_memory_utilization': 0.85,
[36m(TaskRunner pid=3494114)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=3494114)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=3494114)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=3494114)[0m                                    'log_prob_max_token_len_per_gpu': 5120,
[36m(TaskRunner pid=3494114)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=3494114)[0m                                    'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3494114)[0m                                    'log_prob_use_dynamic_bsz': True,
[36m(TaskRunner pid=3494114)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=3494114)[0m                                    'max_num_batched_tokens': 5120,
[36m(TaskRunner pid=3494114)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=3494114)[0m                                    'mode': 'sync',
[36m(TaskRunner pid=3494114)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=3494114)[0m                                    'multi_turn': {'completion_callback': None,
[36m(TaskRunner pid=3494114)[0m                                                   'enable': False,
[36m(TaskRunner pid=3494114)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=3494114)[0m                                                   'interaction_config_path': None,
[36m(TaskRunner pid=3494114)[0m                                                   'max_assistant_turns': None,
[36m(TaskRunner pid=3494114)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=3494114)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=3494114)[0m                                                   'max_user_turns': None,
[36m(TaskRunner pid=3494114)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=3494114)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=3494114)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=3494114)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=3494114)[0m                                    'n': 1,
[36m(TaskRunner pid=3494114)[0m                                    'n_layer1': 4,
[36m(TaskRunner pid=3494114)[0m                                    'n_layer2': 4,
[36m(TaskRunner pid=3494114)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=3494114)[0m                                    'prompt_length': 3072,
[36m(TaskRunner pid=3494114)[0m                                    'response_length': 2048,
[36m(TaskRunner pid=3494114)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=3494114)[0m                                    'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=3494114)[0m                                    'top_k': -1,
[36m(TaskRunner pid=3494114)[0m                                    'top_p': 1.0,
[36m(TaskRunner pid=3494114)[0m                                    'trace': {'backend': None,
[36m(TaskRunner pid=3494114)[0m                                              'token2text': False},
[36m(TaskRunner pid=3494114)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=3494114)[0m                                    'val_kwargs': {'do_sample': True,
[36m(TaskRunner pid=3494114)[0m                                                   'n': 1,
[36m(TaskRunner pid=3494114)[0m                                                   'temperature': 1.0,
[36m(TaskRunner pid=3494114)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=3494114)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=3494114)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=3494114)[0m                'adv_estimator': 'grpo',
[36m(TaskRunner pid=3494114)[0m                'filter_groups': {'_target_': 'verl.trainer.config.FilterGroupsConfig',
[36m(TaskRunner pid=3494114)[0m                                  'enable': True,
[36m(TaskRunner pid=3494114)[0m                                  'max_num_gen_batches': 10,
[36m(TaskRunner pid=3494114)[0m                                  'metric': 'seq_reward'},
[36m(TaskRunner pid=3494114)[0m                'gamma': 1.0,
[36m(TaskRunner pid=3494114)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=3494114)[0m                            'horizon': 10000,
[36m(TaskRunner pid=3494114)[0m                            'kl_coef': 0.0,
[36m(TaskRunner pid=3494114)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=3494114)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=3494114)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=3494114)[0m                'lam': 1.0,
[36m(TaskRunner pid=3494114)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=3494114)[0m                'pf_ppo': {'_target_': 'verl.trainer.config.PFPPOConfig',
[36m(TaskRunner pid=3494114)[0m                           'reweight_method': 'pow',
[36m(TaskRunner pid=3494114)[0m                           'weight_pow': 2.0},
[36m(TaskRunner pid=3494114)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=3494114)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=3494114)[0m  'critic': {'_target_': 'verl.trainer.config.FSDPCriticConfig',
[36m(TaskRunner pid=3494114)[0m             'checkpoint': {'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=3494114)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=3494114)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=3494114)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3494114)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=3494114)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3494114)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=3494114)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=3494114)[0m             'model': {'enable_activation_offload': False,
[36m(TaskRunner pid=3494114)[0m                       'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=3494114)[0m                       'external_lib': None,
[36m(TaskRunner pid=3494114)[0m                       'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3494114)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=3494114)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=3494114)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=3494114)[0m                                       'param_offload': False,
[36m(TaskRunner pid=3494114)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=3494114)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3494114)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=3494114)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=3494114)[0m                       'override_config': {},
[36m(TaskRunner pid=3494114)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=3494114)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=3494114)[0m                       'tokenizer_path': '/workspace/models/Qwen/Qwen2.5-7B-Instruct-1M',
[36m(TaskRunner pid=3494114)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=3494114)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=3494114)[0m                       'use_shm': False},
[36m(TaskRunner pid=3494114)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=3494114)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=3494114)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=3494114)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=3494114)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=3494114)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=3494114)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=3494114)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3494114)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=3494114)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3494114)[0m             'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=3494114)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=3494114)[0m                          'all_ranks': False,
[36m(TaskRunner pid=3494114)[0m                          'discrete': False,
[36m(TaskRunner pid=3494114)[0m                          'ranks': []},
[36m(TaskRunner pid=3494114)[0m             'rollout_n': 1,
[36m(TaskRunner pid=3494114)[0m             'shuffle': False,
[36m(TaskRunner pid=3494114)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=3494114)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3494114)[0m             'use_dynamic_bsz': True},
[36m(TaskRunner pid=3494114)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=3494114)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=3494114)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=3494114)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=3494114)[0m           'filter_overlong_prompts': False,
[36m(TaskRunner pid=3494114)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=3494114)[0m           'gen_batch_size': 512,
[36m(TaskRunner pid=3494114)[0m           'image_key': 'images',
[36m(TaskRunner pid=3494114)[0m           'max_prompt_length': 3072,
[36m(TaskRunner pid=3494114)[0m           'max_response_length': 2048,
[36m(TaskRunner pid=3494114)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=3494114)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=3494114)[0m           'return_multi_modal_inputs': True,
[36m(TaskRunner pid=3494114)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=3494114)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=3494114)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=3494114)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=3494114)[0m           'shuffle': True,
[36m(TaskRunner pid=3494114)[0m           'tokenizer': None,
[36m(TaskRunner pid=3494114)[0m           'train_batch_size': 512,
[36m(TaskRunner pid=3494114)[0m           'train_files': '/workspace/data/math/train.parquet',
[36m(TaskRunner pid=3494114)[0m           'truncation': 'left',
[36m(TaskRunner pid=3494114)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=3494114)[0m           'use_shm': False,
[36m(TaskRunner pid=3494114)[0m           'val_batch_size': None,
[36m(TaskRunner pid=3494114)[0m           'val_files': '/workspace/data/math/test.parquet',
[36m(TaskRunner pid=3494114)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=3494114)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=3494114)[0m  'ray_init': {'num_cpus': None, 'timeline_json_file': None},
[36m(TaskRunner pid=3494114)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=3494114)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3494114)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=3494114)[0m                   'max_length': None,
[36m(TaskRunner pid=3494114)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=3494114)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3494114)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=3494114)[0m                             'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3494114)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=3494114)[0m                                             'param_offload': False,
[36m(TaskRunner pid=3494114)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=3494114)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3494114)[0m                             'input_tokenizer': '/workspace/models/Qwen/Qwen2.5-7B-Instruct-1M',
[36m(TaskRunner pid=3494114)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=3494114)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=3494114)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=3494114)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=3494114)[0m                             'use_shm': False},
[36m(TaskRunner pid=3494114)[0m                   'overlong_buffer': {'enable': True,
[36m(TaskRunner pid=3494114)[0m                                       'len': 512,
[36m(TaskRunner pid=3494114)[0m                                       'log': False,
[36m(TaskRunner pid=3494114)[0m                                       'penalty_factor': 1.0},
[36m(TaskRunner pid=3494114)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=3494114)[0m                                'all_ranks': False,
[36m(TaskRunner pid=3494114)[0m                                'discrete': False,
[36m(TaskRunner pid=3494114)[0m                                'ranks': []},
[36m(TaskRunner pid=3494114)[0m                   'reward_manager': 'dapo',
[36m(TaskRunner pid=3494114)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=3494114)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=3494114)[0m                                      'url': None},
[36m(TaskRunner pid=3494114)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=3494114)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3494114)[0m                   'use_dynamic_bsz': True},
[36m(TaskRunner pid=3494114)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=3494114)[0m              'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=3494114)[0m                                            'cuda-memory-usage': 'true',
[36m(TaskRunner pid=3494114)[0m                                            'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=3494114)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=3494114)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=3494114)[0m              'default_local_dir': '/workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724',
[36m(TaskRunner pid=3494114)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=3494114)[0m              'device': 'cuda',
[36m(TaskRunner pid=3494114)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=3494114)[0m              'experiment_name': 'DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724',
[36m(TaskRunner pid=3494114)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=3494114)[0m              'logger': ['console', 'tensorboard'],
[36m(TaskRunner pid=3494114)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=3494114)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=3494114)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=3494114)[0m              'nnodes': 1,
[36m(TaskRunner pid=3494114)[0m              'npu_profile': {'options': {'analysis': True,
[36m(TaskRunner pid=3494114)[0m                                          'level': 'level1',
[36m(TaskRunner pid=3494114)[0m                                          'record_shapes': False,
[36m(TaskRunner pid=3494114)[0m                                          'save_path': './profiler_data',
[36m(TaskRunner pid=3494114)[0m                                          'with_cpu': True,
[36m(TaskRunner pid=3494114)[0m                                          'with_memory': False,
[36m(TaskRunner pid=3494114)[0m                                          'with_module': False,
[36m(TaskRunner pid=3494114)[0m                                          'with_npu': True,
[36m(TaskRunner pid=3494114)[0m                                          'with_stack': False}},
[36m(TaskRunner pid=3494114)[0m              'profile_steps': None,
[36m(TaskRunner pid=3494114)[0m              'project_name': 'my_DAPO',
[36m(TaskRunner pid=3494114)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=3494114)[0m              'resume_from_path': None,
[36m(TaskRunner pid=3494114)[0m              'resume_mode': 'disable',
[36m(TaskRunner pid=3494114)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=3494114)[0m              'save_freq': 20,
[36m(TaskRunner pid=3494114)[0m              'test_freq': 10,
[36m(TaskRunner pid=3494114)[0m              'total_epochs': 100,
[36m(TaskRunner pid=3494114)[0m              'total_training_steps': 100,
[36m(TaskRunner pid=3494114)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=3494114)[0m              'val_before_train': True,
[36m(TaskRunner pid=3494114)[0m              'val_only': False,
[36m(TaskRunner pid=3494114)[0m              'validation_data_dir': None,
[36m(TaskRunner pid=3494114)[0m              'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=3494114)[0m                                        'capture-range-end': None,
[36m(TaskRunner pid=3494114)[0m                                        'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=3494114)[0m                                        'cuda-memory-usage': 'true',
[36m(TaskRunner pid=3494114)[0m                                        'kill': 'none',
[36m(TaskRunner pid=3494114)[0m                                        'trace': 'cuda,nvtx,cublas,ucx'}}}
[36m(TaskRunner pid=3494114)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=3494114)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=3494114)[0m dataset len: 7500
[36m(TaskRunner pid=3494114)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=3494114)[0m dataset len: 5000
[36m(TaskRunner pid=3494114)[0m Size of train dataloader: 14, Size of val dataloader: 1
[36m(TaskRunner pid=3494114)[0m Total training steps: 100
[36m(TaskRunner pid=3494114)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(WorkerDict pid=3494990)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=3494990)[0m   "architectures": [
[36m(WorkerDict pid=3494990)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=3494990)[0m   ],
[36m(WorkerDict pid=3494990)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=3494990)[0m   "dual_chunk_attention_config": {
[36m(WorkerDict pid=3494990)[0m     "chunk_size": 262144,
[36m(WorkerDict pid=3494990)[0m     "local_size": 8192,
[36m(WorkerDict pid=3494990)[0m     "original_max_position_embeddings": 262144
[36m(WorkerDict pid=3494990)[0m   },
[36m(WorkerDict pid=3494990)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=3494990)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=3494990)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=3494990)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=3494990)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=3494990)[0m   "layer_types": [
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention",
[36m(WorkerDict pid=3494990)[0m     "full_attention"
[36m(WorkerDict pid=3494990)[0m   ],
[36m(WorkerDict pid=3494990)[0m   "max_position_embeddings": 1010000,
[36m(WorkerDict pid=3494990)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=3494990)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=3494990)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=3494990)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=3494990)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=3494990)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=3494990)[0m   "rms_norm_eps": 1e-05,
[36m(WorkerDict pid=3494990)[0m   "rope_scaling": null,
[36m(WorkerDict pid=3494990)[0m   "rope_theta": 10000000.0,
[36m(WorkerDict pid=3494990)[0m   "sliding_window": null,
[36m(WorkerDict pid=3494990)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=3494990)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=3494990)[0m   "transformers_version": "4.53.0",
[36m(WorkerDict pid=3494990)[0m   "use_cache": true,
[36m(WorkerDict pid=3494990)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=3494990)[0m   "vocab_size": 152064
[36m(WorkerDict pid=3494990)[0m }
[36m(WorkerDict pid=3494990)[0m 
[36m(WorkerDict pid=3499180)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=3499180)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=3494990)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=3494990)[0m wrap_policy: functools.partial(<function _or_policy at 0x7ecf30f36f80>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7ecf30f36e60>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=3494990)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=3494990)[0m Total steps: 100, num_warmup_steps: 10
[36m(WorkerDict pid=3494990)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=3494990)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=3499179)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3499179)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3499180)[0m WARNING 07-28 13:09:35 [cuda.py:93] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=3499180)[0m WARNING 07-28 13:09:36 [utils.py:2522] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7eeeca56f5e0>
[36m(WorkerDict pid=3499180)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 2048, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1.0, 'ignore_eos': False}
[36m(WorkerDict pid=3499179)[0m WARNING 07-28 13:09:36 [cuda.py:93] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3499179)[0m WARNING 07-28 13:09:36 [utils.py:2522] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7fb42d5e7580>[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3494114)[0m Saving tensorboard log to /workspace/log/tensorboard/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724.
[36m(TaskRunner pid=3494114)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 0}
[36m(WorkerDict pid=3499185)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 2048, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1.0, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3494114)[0m validation generation end
[36m(TaskRunner pid=3494114)[0m [prompt] system
[36m(TaskRunner pid=3494114)[0m You are a helpful assistant.
[36m(TaskRunner pid=3494114)[0m user
[36m(TaskRunner pid=3494114)[0m How many vertical asymptotes does the graph of $y=\frac{2}{x^2+x-6}$ have? Let's think step by step and output the final answer within \boxed{}.
[36m(TaskRunner pid=3494114)[0m assistant
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m [response] To determine the number of vertical asymptotes for the function \( y = \frac{2}{x^2 + x - 6} \), we need to identify the values of \( x \) that make the denominator zero. Vertical asymptotes occur where the function is undefined due to division by zero.
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m Step 1: Factor the denominator.
[36m(TaskRunner pid=3494114)[0m The denominator of the function is \( x^2 + x - 6 \). To factor this quadratic expression, we look for two numbers that multiply to \(-6\) and add up to \(1\). These numbers are \(3\) and \(-2\).
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m Thus, we can factor the quadratic as:
[36m(TaskRunner pid=3494114)[0m \[
[36m(TaskRunner pid=3494114)[0m x^2 + x - 6 = (x + 3)(x - 2)
[36m(TaskRunner pid=3494114)[0m \]
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m Step 2: Set the denominator equal to zero.
[36m(TaskRunner pid=3494114)[0m The function becomes:
[36m(TaskRunner pid=3494114)[0m \[
[36m(TaskRunner pid=3494114)[0m y = \frac{2}{(x + 3)(x - 2)}
[36m(TaskRunner pid=3494114)[0m \]
[36m(TaskRunner pid=3494114)[0m To find the values of \( x \) that make the function undefined, we set the denominator equal to zero:
[36m(TaskRunner pid=3494114)[0m \[
[36m(TaskRunner pid=3494114)[0m (x + 3)(x - 2) = 0
[36m(TaskRunner pid=3494114)[0m \]
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m Step 3: Solve for \( x \).
[36m(TaskRunner pid=3494114)[0m We solve the equation using the zero product property:
[36m(TaskRunner pid=3494114)[0m \[
[36m(TaskRunner pid=3494114)[0m x + 3 = 0 \quad \text{or} \quad x - 2 = 0
[36m(TaskRunner pid=3494114)[0m \]
[36m(TaskRunner pid=3494114)[0m \[
[36m(TaskRunner pid=3494114)[0m x = -3 \quad \text{or} \quad x = 2
[36m(TaskRunner pid=3494114)[0m \]
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m Step 4: Verify that these values are within the domain of the function.
[36m(TaskRunner pid=3494114)[0m The values \( x = -3 \) and \( x = 2 \) make the denominator zero, which causes the function to be undefined at these points. Therefore, these are the locations of the vertical asymptotes.
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m Step 5: Count the number of vertical asymptotes.
[36m(TaskRunner pid=3494114)[0m Since we found two distinct values (\(x = -3\) and \(x = 2\)) that make the denominator zero, there are two vertical asymptotes.
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m Thus, the graph of \( y = \frac{2}{x^2 + x - 6} \) has \(\boxed{2}\) vertical asymptotes.
[36m(TaskRunner pid=3494114)[0m [ground_truth] 2
[36m(TaskRunner pid=3494114)[0m [score] 1.0
[36m(TaskRunner pid=3494114)[0m len reward_extra_infos_dict['reward']: 5000
[36m(TaskRunner pid=3494114)[0m len reward_extra_infos_dict['acc']: 5000
[36m(TaskRunner pid=3494114)[0m ('Initial validation metrics: '
[36m(TaskRunner pid=3494114)[0m  "{'val-aux/DigitalLearningGmbH/MATH-lighteval/reward/mean@1': 0.664378125, "
[36m(TaskRunner pid=3494114)[0m  "'val-core/DigitalLearningGmbH/MATH-lighteval/acc/mean@1': 0.6702}")
[36m(TaskRunner pid=3494114)[0m step:0 - val-aux/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:0.664378125 - val-core/DigitalLearningGmbH/MATH-lighteval/acc/mean@1:0.6702
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.2421875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5423387096774194
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1614 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.263671875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5145061728395062
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3281 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.263671875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5228395061728395
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4975 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.26953125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5027173913043478
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6640 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.24609375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5591931216931217
[36m(TaskRunner pid=3494114)[0m step:1 - train/true_reward_mean:0.7295255661010742 - train/kept_rate_layer1:0.24609375 - train/kept_rate_layer2:0.5591931216931217 - global_seqlen/min:787055 - global_seqlen/max:899514 - global_seqlen/minmax_diff:112459 - global_seqlen/balanced_min:830457 - global_seqlen/balanced_max:830458 - global_seqlen/mean:830457.125 - actor/entropy:0.10984506458044052 - actor/pg_loss:0.029134460137991685 - actor/pg_clipfrac:0.00013179020624133874 - actor/ppo_kl:3.630471050760557e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1025618414860219 - perf/mfu/actor:0.27871911828358303 - perf/max_memory_allocated_gb:82.25094699859619 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:220.79621505737305 - actor/lr:0.0 - critic/score/mean:0.504927933216095 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.504927933216095 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.04929126054048538 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.04929126054048538 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:426.9261474609375 - response_length/max:2048.0 - response_length/min:31.0 - response_length/clip_ratio:0.00830078125 - prompt_length/mean:384.067138671875 - prompt_length/max:1316.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.662038266658783e-05 - timing_s/generate_sequences:32.366981506347656 - timing_s/reshard:2.0034520626068115 - timing_s/gen:205.87969236448407 - timing_s/reward filter:4.1268300004303455 - timing_s/gen_layer2:207.77315579168499 - timing_s/process_data:214.73859389219433 - timing_s/reward:7.695943205617368 - timing_s/step:956.7604759084061 - timing_s/old_log_prob:75.01089471764863 - timing_s/adv:0.25967853423208 - timing_s/update_actor:448.8633044445887 - timing_s/stop_profile:1.3671815395355225e-06 - timing_per_token_ms/adv:3.9086685876781414e-05 - timing_per_token_ms/gen:0.058866852109675294 - timing_per_token_ms/update_actor:0.06756268489547078 - perf/total_num_tokens:6643657 - perf/time_per_step:956.7604759084061 - perf/throughput:867.9885362232527 - train/num_gen_batches:5
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.259765625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5626566416040101
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1796 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.271484375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.560251798561151
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3665 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.2421875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5174731182795699
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5205 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.248046875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.568241469816273
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6937 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.24609375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5436507936507936
[36m(TaskRunner pid=3494114)[0m step:2 - train/true_reward_mean:0.6787862777709961 - train/kept_rate_layer1:0.24609375 - train/kept_rate_layer2:0.5436507936507936 - global_seqlen/min:788363 - global_seqlen/max:849296 - global_seqlen/minmax_diff:60933 - global_seqlen/balanced_min:820237 - global_seqlen/balanced_max:820237 - global_seqlen/mean:820237.0 - actor/entropy:0.10991357266902924 - actor/pg_loss:0.04451626435799068 - actor/pg_clipfrac:0.0003315735979048277 - actor/ppo_kl:8.273710557104442e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1011075167916715 - perf/mfu/actor:0.27926144193009617 - perf/max_memory_allocated_gb:82.25094699859619 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:221.50933456420898 - actor/lr:1e-07 - critic/score/mean:0.5129519104957581 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5129519104957581 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.038386158645153046 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.038386158645153046 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:419.46923828125 - response_length/max:2048.0 - response_length/min:18.0 - response_length/clip_ratio:0.00634765625 - prompt_length/mean:381.54345703125 - prompt_length/max:1350.0 - prompt_length/min:45.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.5871599316596985e-05 - timing_s/generate_sequences:32.02947998046875 - timing_s/reshard:3.208432197570801 - timing_s/gen:215.5008381055668 - timing_s/reward filter:4.151514661498368 - timing_s/gen_layer2:209.45129731856287 - timing_s/process_data:216.32551631517708 - timing_s/reward:7.793928476981819 - timing_s/step:958.4144373713061 - timing_s/old_log_prob:71.97212114185095 - timing_s/adv:0.2866821810603142 - timing_s/update_actor:442.22867257799953 - timing_s/stop_profile:1.1315569281578064e-06 - timing_per_token_ms/adv:4.3688924826043295e-05 - timing_per_token_ms/gen:0.0627131914591562 - timing_per_token_ms/update_actor:0.06739342906044221 - perf/total_num_tokens:6561896 - perf/time_per_step:958.4144373713061 - perf/throughput:855.8270493605119 - train/num_gen_batches:5
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.2890625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5475788288288288
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1945 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.2890625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5225225225225225
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3801 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.27734375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5020539906103286
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5512 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.28125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5260416666666666
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7330 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.267578125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5623479318734793
[36m(TaskRunner pid=3494114)[0m step:3 - train/true_reward_mean:0.6719465255737305 - train/kept_rate_layer1:0.267578125 - train/kept_rate_layer2:0.5623479318734793 - global_seqlen/min:767864 - global_seqlen/max:908980 - global_seqlen/minmax_diff:141116 - global_seqlen/balanced_min:812693 - global_seqlen/balanced_max:812694 - global_seqlen/mean:812693.75 - actor/entropy:0.11253579705953598 - actor/pg_loss:0.024537646012951084 - actor/pg_clipfrac:0.0006076755729220125 - actor/ppo_kl:0.00011381676497906068 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1185465166345239 - perf/mfu/actor:0.2743972897070777 - perf/max_memory_allocated_gb:82.25094699859619 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:225.46348190307617 - actor/lr:2e-07 - critic/score/mean:0.5016090869903564 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5016090869903564 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.04362630099058151 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888520956039429 - critic/returns/mean:-0.04362630099058151 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888520956039429 - response_length/mean:417.319091796875 - response_length/max:2048.0 - response_length/min:7.0 - response_length/clip_ratio:0.006103515625 - prompt_length/mean:376.3271484375 - prompt_length/max:1267.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.9074417650699615e-05 - timing_s/generate_sequences:33.550411224365234 - timing_s/reshard:2.1713812351226807 - timing_s/gen:214.85866462811828 - timing_s/reward filter:3.9822027320042253 - timing_s/gen_layer2:225.8099522832781 - timing_s/process_data:232.7715397151187 - timing_s/reward:8.286948604509234 - timing_s/step:977.3081622235477 - timing_s/old_log_prob:71.25575314927846 - timing_s/adv:0.2850198447704315 - timing_s/update_actor:445.9459127765149 - timing_s/stop_profile:1.1064112186431885e-06 - timing_per_token_ms/adv:4.3838753031266625e-05 - timing_per_token_ms/gen:0.06284846499966311 - timing_per_token_ms/update_actor:0.06859070725850219 - perf/total_num_tokens:6501550 - perf/time_per_step:977.3081622235477 - perf/throughput:831.5634529757523 - train/num_gen_batches:5
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.259765625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5203634085213033
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1661 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.275390625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5097517730496454
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3386 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.228515625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5459401709401709
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4919 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.259765625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5375939849624061
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6635 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.259765625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5476190476190477
[36m(TaskRunner pid=3494114)[0m step:4 - train/true_reward_mean:0.7018642425537109 - train/kept_rate_layer1:0.259765625 - train/kept_rate_layer2:0.5476190476190477 - global_seqlen/min:770927 - global_seqlen/max:883384 - global_seqlen/minmax_diff:112457 - global_seqlen/balanced_min:822104 - global_seqlen/balanced_max:822105 - global_seqlen/mean:822104.625 - actor/entropy:0.11377853155136108 - actor/pg_loss:0.07696966275917864 - actor/pg_clipfrac:0.0010777498328458197 - actor/ppo_kl:0.00011618757123631527 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0928293771576136 - perf/mfu/actor:0.2797531970126919 - perf/max_memory_allocated_gb:82.25094699859619 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:225.61751556396484 - actor/lr:3e-07 - critic/score/mean:0.5103849172592163 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5103849172592163 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.04385925829410553 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.04385925829410553 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:418.724609375 - response_length/max:2048.0 - response_length/min:29.0 - response_length/clip_ratio:0.00341796875 - prompt_length/mean:384.1119384765625 - prompt_length/max:1175.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.5865080058574677e-05 - timing_s/generate_sequences:33.887874603271484 - timing_s/reshard:2.127647638320923 - timing_s/gen:213.1000839471817 - timing_s/reward filter:4.238893159665167 - timing_s/gen_layer2:208.6031035874039 - timing_s/process_data:215.57242148648947 - timing_s/reward:7.666128852404654 - timing_s/step:955.1646108357236 - timing_s/old_log_prob:72.00896408129483 - timing_s/adv:0.2948598861694336 - timing_s/update_actor:442.5167383821681 - timing_s/stop_profile:1.1110678315162659e-06 - timing_per_token_ms/adv:4.483308407513119e-05 - timing_per_token_ms/gen:0.062124826816452754 - timing_per_token_ms/update_actor:0.06728412736732993 - perf/total_num_tokens:6576837 - perf/time_per_step:955.1646108357236 - perf/throughput:860.6941836765682 - train/num_gen_batches:5
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.25
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5299479166666666
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1628 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.24609375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5403439153439153
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3262 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.228515625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5327635327635327
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4758 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.25390625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.46057692307692305
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6195 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.279296875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5340909090909091
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=8028 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.2734375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5657738095238095
[36m(TaskRunner pid=3494114)[0m step:5 - train/true_reward_mean:0.7070865631103516 - train/kept_rate_layer1:0.2734375 - train/kept_rate_layer2:0.5657738095238095 - global_seqlen/min:737372 - global_seqlen/max:873411 - global_seqlen/minmax_diff:136039 - global_seqlen/balanced_min:818031 - global_seqlen/balanced_max:818032 - global_seqlen/mean:818031.5 - actor/entropy:0.11316763609647751 - actor/pg_loss:-0.007421078765978439 - actor/pg_clipfrac:0.0017857344704324135 - actor/ppo_kl:0.0002597250639874017 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.097418601391837 - perf/mfu/actor:0.27923332722153055 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:225.7814178466797 - actor/lr:4e-07 - critic/score/mean:0.5043633580207825 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5043633580207825 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.03841357305645943 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.03841357305645943 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:430.3092041015625 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0052490234375 - prompt_length/mean:368.5496826171875 - prompt_length/max:1484.0 - prompt_length/min:43.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.778639853000641e-05 - timing_s/generate_sequences:34.011619567871094 - timing_s/reshard:2.5557289123535156 - timing_s/gen:252.49051698017865 - timing_s/reward filter:4.735249277204275 - timing_s/gen_layer2:251.63828182592988 - timing_s/process_data:259.59547568578273 - timing_s/reward:9.250452839769423 - timing_s/step:1039.9317089039832 - timing_s/old_log_prob:71.9993140483275 - timing_s/adv:0.288202628493309 - timing_s/update_actor:441.2260201908648 - timing_s/stop_profile:1.2032687664031982e-06 - timing_per_token_ms/adv:4.403904808270052e-05 - timing_per_token_ms/gen:0.07162662573162712 - timing_per_token_ms/update_actor:0.06742191776705188 - perf/total_num_tokens:6544252 - perf/time_per_step:1039.9317089039832 - perf/throughput:786.6204030475704 - train/num_gen_batches:6
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.27734375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5155516431924883
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1757 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.2421875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5779569892473119
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3477 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.275390625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5171394799054374
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5227 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.26171875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5441542288557214
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6977 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.271484375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5530575539568345
[36m(TaskRunner pid=3494114)[0m step:6 - train/true_reward_mean:0.7081050872802734 - train/kept_rate_layer1:0.271484375 - train/kept_rate_layer2:0.5530575539568345 - global_seqlen/min:795927 - global_seqlen/max:862728 - global_seqlen/minmax_diff:66801 - global_seqlen/balanced_min:835798 - global_seqlen/balanced_max:835799 - global_seqlen/mean:835798.375 - actor/entropy:0.1168978288769722 - actor/pg_loss:0.06741328811951225 - actor/pg_clipfrac:0.003123336073021283 - actor/ppo_kl:0.0005217563609679585 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0848701414652169 - perf/mfu/actor:0.28355026837290115 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.66168212890625 - actor/lr:5e-07 - critic/score/mean:0.4977909326553345 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.4977909326553345 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.0364951454102993 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.0364951454102993 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:427.276611328125 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.0068359375 - prompt_length/mean:388.9327392578125 - prompt_length/max:1217.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.8913298845291138e-05 - timing_s/generate_sequences:34.30708694458008 - timing_s/reshard:2.2417361736297607 - timing_s/gen:211.38818854652345 - timing_s/reward filter:4.165493250824511 - timing_s/gen_layer2:212.3716547638178 - timing_s/process_data:219.34697829931974 - timing_s/reward:8.144826318137348 - timing_s/step:960.6839996818453 - timing_s/old_log_prob:73.3311595087871 - timing_s/adv:0.27759620919823647 - timing_s/update_actor:443.9935235194862 - timing_s/stop_profile:1.4435499906539917e-06 - timing_per_token_ms/adv:4.151662313267785e-05 - timing_per_token_ms/gen:0.06039231156246652 - timing_per_token_ms/update_actor:0.06640260629836206 - perf/total_num_tokens:6686387 - perf/time_per_step:960.6839996818453 - perf/throughput:870.0034301360236 - train/num_gen_batches:5
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.294921875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5071743929359823
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1838 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.265625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.49754901960784315
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3462 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.224609375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.538768115942029
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4949 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.234375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5947916666666667
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6662 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.248046875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5236220472440944
[36m(TaskRunner pid=3494114)[0m step:7 - train/true_reward_mean:0.7375202178955078 - train/kept_rate_layer1:0.248046875 - train/kept_rate_layer2:0.5236220472440944 - global_seqlen/min:833900 - global_seqlen/max:933725 - global_seqlen/minmax_diff:99825 - global_seqlen/balanced_min:873481 - global_seqlen/balanced_max:873482 - global_seqlen/mean:873481.5 - actor/entropy:0.10707076638936996 - actor/pg_loss:0.06415867852208773 - actor/pg_clipfrac:0.004264835705948321 - actor/ppo_kl:0.0010677645847699244 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0524291740730405 - perf/mfu/actor:0.282414252984804 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.75769805908203 - actor/lr:6e-07 - critic/score/mean:0.5112833976745605 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5112833976745605 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.04272182658314705 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888520956039429 - critic/returns/mean:-0.04272182658314705 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888520956039429 - response_length/mean:452.593994140625 - response_length/max:2048.0 - response_length/min:24.0 - response_length/clip_ratio:0.006591796875 - prompt_length/mean:400.415283203125 - prompt_length/max:1345.0 - prompt_length/min:41.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.525040715932846e-05 - timing_s/generate_sequences:31.114328384399414 - timing_s/reshard:2.140131711959839 - timing_s/gen:210.5200320063159 - timing_s/reward filter:4.158218400552869 - timing_s/gen_layer2:212.06350076571107 - timing_s/process_data:219.11813738849014 - timing_s/reward:7.568852536380291 - timing_s/step:984.074070353061 - timing_s/old_log_prob:76.13151028193533 - timing_s/adv:0.26882336754351854 - timing_s/update_actor:466.3928845562041 - timing_s/stop_profile:1.2479722499847412e-06 - timing_per_token_ms/adv:3.847010033176412e-05 - timing_per_token_ms/gen:0.05677990964797537 - timing_per_token_ms/update_actor:0.06674338331095221 - perf/total_num_tokens:6987852 - perf/time_per_step:984.074070353061 - perf/throughput:887.6176360247119 - train/num_gen_batches:5
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.23828125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.555327868852459
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1626 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.220703125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.508480825958702
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3005 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.248046875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5150918635170604
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4575 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.236328125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5409779614325069
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6146 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.24609375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5023148148148148
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7665 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.220703125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.48746312684365783
[36m(TaskRunner pid=3494114)[0m step:8 - train/true_reward_mean:0.7333860397338867 - train/kept_rate_layer1:0.220703125 - train/kept_rate_layer2:0.48746312684365783 - global_seqlen/min:816769 - global_seqlen/max:939506 - global_seqlen/minmax_diff:122737 - global_seqlen/balanced_min:870061 - global_seqlen/balanced_max:870062 - global_seqlen/mean:870061.125 - actor/entropy:0.1028614416718483 - actor/pg_loss:-0.005944096802637144 - actor/pg_clipfrac:0.006232917009658165 - actor/ppo_kl:0.002024166075634987 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0626825101207942 - perf/mfu/actor:0.27335995042567124 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.4852180480957 - actor/lr:7e-07 - critic/score/mean:0.507569432258606 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.507569432258606 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.04156941920518875 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.04156941920518875 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:453.0849609375 - response_length/max:2048.0 - response_length/min:33.0 - response_length/clip_ratio:0.0067138671875 - prompt_length/mean:396.5841064453125 - prompt_length/max:1517.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.699943095445633e-05 - timing_s/generate_sequences:28.895832061767578 - timing_s/reshard:2.3519248962402344 - timing_s/gen:254.40596885047853 - timing_s/reward filter:4.764863555319607 - timing_s/gen_layer2:242.88053249381483 - timing_s/process_data:250.48954002279788 - timing_s/reward:8.624020016752183 - timing_s/step:1074.78479226958 - timing_s/old_log_prob:75.99262805189937 - timing_s/adv:0.29863682482391596 - timing_s/update_actor:480.28864350169897 - timing_s/stop_profile:1.1064112186431885e-06 - timing_per_token_ms/adv:4.2904575357265264e-05 - timing_per_token_ms/gen:0.06854214727230168 - timing_per_token_ms/update_actor:0.06900214101361254 - perf/total_num_tokens:6960489 - perf/time_per_step:1074.78479226958 - perf/throughput:809.5212467257996 - train/num_gen_batches:6
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.224609375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5543478260869565
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1530 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.220703125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5704277286135693
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3077 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.23046875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.551906779661017
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4640 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.236328125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5471763085399449
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6229 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.23828125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5324453551912568
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7788 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.2109375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5582561728395061
[36m(TaskRunner pid=3494114)[0m step:9 - train/true_reward_mean:0.73193359375 - train/kept_rate_layer1:0.2109375 - train/kept_rate_layer2:0.5582561728395061 - global_seqlen/min:719332 - global_seqlen/max:789712 - global_seqlen/minmax_diff:70380 - global_seqlen/balanced_min:762012 - global_seqlen/balanced_max:762013 - global_seqlen/mean:762012.875 - actor/entropy:0.11331251263618469 - actor/pg_loss:0.044058864451168724 - actor/pg_clipfrac:0.008792197879246845 - actor/ppo_kl:0.006197728976462024 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.084114757599309 - perf/mfu/actor:0.3161082052164077 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:223.7785987854004 - actor/lr:8e-07 - critic/score/mean:0.5486816763877869 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5486816763877869 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:0.001115708495490253 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:0.001115708495490253 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:380.8095703125 - response_length/max:1187.0 - response_length/min:6.0 - response_length/clip_ratio:0.0 - prompt_length/mean:363.3436279296875 - prompt_length/max:1062.0 - prompt_length/min:41.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.1084211766719818e-05 - timing_s/generate_sequences:18.280473709106445 - timing_s/reshard:2.3274919986724854 - timing_s/gen:203.4349750559777 - timing_s/reward filter:4.7623257376253605 - timing_s/gen_layer2:153.76441551093012 - timing_s/process_data:161.50569379143417 - timing_s/reward:8.144179700873792 - timing_s/step:806.9556603981182 - timing_s/old_log_prob:66.92439199704677 - timing_s/adv:0.2862976500764489 - timing_s/update_actor:361.71765235438943 - timing_s/stop_profile:1.1827796697616577e-06 - timing_per_token_ms/adv:4.696404409119218e-05 - timing_per_token_ms/gen:0.06521204537515729 - timing_per_token_ms/update_actor:0.05933588267035341 - perf/total_num_tokens:6096103 - perf/time_per_step:806.9556603981182 - perf/throughput:944.3057560610638 - train/num_gen_batches:6
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5697115384615384
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1422 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.240234375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5443766937669376
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3029 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.181640625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5855734767025089
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4336 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.19140625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5556972789115646
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5643 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.189453125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.48668384879725085
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6776 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.228515625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5694444444444444
[36m(TaskRunner pid=3494114)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 10}
[36m(TaskRunner pid=3494114)[0m validation generation end
[36m(TaskRunner pid=3494114)[0m [prompt] system
[36m(TaskRunner pid=3494114)[0m You are a helpful assistant.
[36m(TaskRunner pid=3494114)[0m user
[36m(TaskRunner pid=3494114)[0m How many vertical asymptotes does the graph of $y=\frac{2}{x^2+x-6}$ have? Let's think step by step and output the final answer within \boxed{}.
[36m(TaskRunner pid=3494114)[0m assistant
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m [response] To determine the number of vertical asymptotes of the function \( y = \frac{2}{x^2 + x - 6} \), we need to identify the values of \( x \) that make the denominator zero, as these are the points where the function is undefined and thus where vertical asymptotes may occur.
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m First, we factor the denominator:
[36m(TaskRunner pid=3494114)[0m \[ x^2 + x - 6 = (x + 3)(x - 2). \]
[36m(TaskRunner pid=3494114)[0m Setting the denominator equal to zero gives us the equations:
[36m(TaskRunner pid=3494114)[0m \[ (x + 3)(x - 2) = 0. \]
[36m(TaskRunner pid=3494114)[0m This equation has two solutions:
[36m(TaskRunner pid=3494114)[0m \[ x + 3 = 0 \quad \text{or} \quad x - 2 = 0, \]
[36m(TaskRunner pid=3494114)[0m which simplifies to:
[36m(TaskRunner pid=3494114)[0m \[ x = -3 \quad \text{or} \quad x = 2. \]
[36m(TaskRunner pid=3494114)[0m These solutions correspond to the vertical asymptotes of the function, provided they are not also zeros of the numerator. Here, the numerator is \( 2 \), which is a non-zero constant and thus has no zeros. Therefore, the function \( y = \frac{2}{x^2 + x - 6} = \frac{2}{(x + 3)(x - 2)} \) has vertical asymptotes at \( x = -3 \) and \( x = 2 \).
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m Since the denominator has two distinct zeros, the function has two vertical asymptotes. Thus, the number of vertical asymptotes is:
[36m(TaskRunner pid=3494114)[0m \[ \boxed{2} \]
[36m(TaskRunner pid=3494114)[0m [ground_truth] 2
[36m(TaskRunner pid=3494114)[0m [score] 1.0
[36m(TaskRunner pid=3494114)[0m len reward_extra_infos_dict['reward']: 5000
[36m(TaskRunner pid=3494114)[0m len reward_extra_infos_dict['acc']: 5000
[36m(TaskRunner pid=3494114)[0m step:10 - train/true_reward_mean:0.74462890625 - train/kept_rate_layer1:0.228515625 - train/kept_rate_layer2:0.5694444444444444 - global_seqlen/min:767569 - global_seqlen/max:829358 - global_seqlen/minmax_diff:61789 - global_seqlen/balanced_min:792222 - global_seqlen/balanced_max:792223 - global_seqlen/mean:792222.125 - actor/entropy:0.111989326775074 - actor/pg_loss:0.007216435464370823 - actor/pg_clipfrac:0.010442005015091037 - actor/ppo_kl:0.004375528447535123 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0968202489893883 - perf/mfu/actor:0.3073732010202569 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.05198287963867 - actor/lr:9e-07 - val-aux/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:0.684290625 - val-core/DigitalLearningGmbH/MATH-lighteval/acc/mean@1:0.6848 - critic/score/mean:0.5546826124191284 - critic/score/max:1.0 - critic/score/min:-0.033203125 - critic/rewards/mean:0.5546826124191284 - critic/rewards/max:1.0 - critic/rewards/min:-0.033203125 - critic/advantages/mean:-0.015187372453510761 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.015187372453510761 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:399.7073974609375 - response_length/max:1553.0 - response_length/min:26.0 - response_length/clip_ratio:0.0 - prompt_length/mean:373.947021484375 - prompt_length/max:1134.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.8318183720111847e-05 - timing_s/generate_sequences:20.961917877197266 - timing_s/reshard:3.5692830085754395 - timing_s/gen:215.57190272957087 - timing_s/reward filter:4.563353491947055 - timing_s/gen_layer2:166.3353010136634 - timing_s/process_data:173.39189552981406 - timing_s/reward:6.889641555026174 - timing_s/step:941.7176456199959 - timing_s/old_log_prob:69.09790920745581 - timing_s/adv:0.27038021199405193 - timing_s/update_actor:387.2294709449634 - timing_s/testing:85.44200486689806 - timing_s/stop_profile:1.0775402188301086e-06 - timing_per_token_ms/adv:4.2661679638468175e-05 - timing_per_token_ms/gen:0.06583548290469159 - timing_per_token_ms/update_actor:0.06109862668644911 - perf/total_num_tokens:6337777 - perf/time_per_step:941.7176456199959 - perf/throughput:841.2522890323745 - train/num_gen_batches:6
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.189453125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5347938144329897
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1245 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5260416666666666
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2457 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.201171875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5194174757281553
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3741 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.173828125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5603932584269663
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4938 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1953125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5441666666666667
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6244 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.18359375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5137411347517731
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7403 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.17578125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5115740740740741
[36m(TaskRunner pid=3494114)[0m step:11 - train/true_reward_mean:0.7851438522338867 - train/kept_rate_layer1:0.17578125 - train/kept_rate_layer2:0.5115740740740741 - global_seqlen/min:795339 - global_seqlen/max:861551 - global_seqlen/minmax_diff:66212 - global_seqlen/balanced_min:823072 - global_seqlen/balanced_max:823073 - global_seqlen/mean:823072.375 - actor/entropy:0.11065039783716202 - actor/pg_loss:-0.022699997895193422 - actor/pg_clipfrac:0.013365930342781811 - actor/ppo_kl:0.0067799493075889825 - actor/pg_clipfrac_lower:1.2101828761913058e-05 - actor/grad_norm:1.057099669938907 - perf/mfu/actor:0.3051212648822047 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.35334396362305 - actor/lr:1e-06 - critic/score/mean:0.5549560785293579 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5549560785293579 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0075354501605033875 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.0075354501605033875 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:411.9473876953125 - response_length/max:1536.0 - response_length/min:18.0 - response_length/clip_ratio:0.0 - prompt_length/mean:391.834228515625 - prompt_length/max:1301.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.1873973309993744e-05 - timing_s/generate_sequences:19.15977668762207 - timing_s/reshard:2.161080837249756 - timing_s/gen:266.77137412223965 - timing_s/reward filter:5.548299381509423 - timing_s/gen_layer2:201.689755118452 - timing_s/process_data:210.00889908894897 - timing_s/reward:7.488400901667774 - timing_s/step:966.6837596185505 - timing_s/old_log_prob:72.31771865580231 - timing_s/adv:0.2859687330201268 - timing_s/update_actor:405.62540465500206 - timing_s/stop_profile:1.0477378964424133e-06 - timing_per_token_ms/adv:4.3430070930901854e-05 - timing_per_token_ms/gen:0.07905102927668536 - timing_per_token_ms/update_actor:0.06160232942075751 - perf/total_num_tokens:6584579 - perf/time_per_step:966.6837596185505 - perf/throughput:851.4391255779253 - train/num_gen_batches:7
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.21875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.45424107142857145
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1221 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.19921875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5081699346405228
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2465 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.228515625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5505698005698005
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4011 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.19140625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5297619047619048
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5257 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.19140625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5412414965986394
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6530 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.2578125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5561868686868687
[36m(TaskRunner pid=3494114)[0m step:12 - train/true_reward_mean:0.714228630065918 - train/kept_rate_layer1:0.2578125 - train/kept_rate_layer2:0.5561868686868687 - global_seqlen/min:793891 - global_seqlen/max:867064 - global_seqlen/minmax_diff:73173 - global_seqlen/balanced_min:824579 - global_seqlen/balanced_max:824580 - global_seqlen/mean:824579.75 - actor/entropy:0.11077196151018143 - actor/pg_loss:0.051417146145670105 - actor/pg_clipfrac:0.013469730378346867 - actor/ppo_kl:0.006559854424570706 - actor/pg_clipfrac_lower:5.6373571876772785e-06 - actor/grad_norm:1.0516256401315331 - perf/mfu/actor:0.3088542209662974 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:225.14365005493164 - actor/lr:1e-06 - critic/score/mean:0.5633544921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5633544921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.008844563737511635 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.008844563737511635 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:417.4034423828125 - response_length/max:1402.0 - response_length/min:3.0 - response_length/clip_ratio:0.0 - prompt_length/mean:387.8502197265625 - prompt_length/max:1279.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.8047168850898743e-05 - timing_s/generate_sequences:25.212690353393555 - timing_s/reshard:2.16213321685791 - timing_s/gen:229.138802010566 - timing_s/reward filter:4.768473849631846 - timing_s/gen_layer2:177.07501717377454 - timing_s/process_data:184.43572668544948 - timing_s/reward:7.494742508977652 - timing_s/step:898.9257628638297 - timing_s/old_log_prob:72.02817050367594 - timing_s/adv:0.25687851570546627 - timing_s/update_actor:401.43256653193384 - timing_s/stop_profile:1.1995434761047363e-06 - timing_per_token_ms/adv:3.894082344756015e-05 - timing_per_token_ms/gen:0.06701201362314685 - timing_per_token_ms/update_actor:0.0608541148584982 - perf/total_num_tokens:6596638 - perf/time_per_step:898.9257628638297 - perf/throughput:917.2946021404754 - train/num_gen_batches:6
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.234375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5222222222222223
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1504 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.2265625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4920977011494253
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2874 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.181640625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4914874551971326
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3971 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.208984375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.46690031152647976
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5170 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.208984375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5112928348909658
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6483 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.189453125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5103092783505154
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7671 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.205078125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.49007936507936506
[36m(TaskRunner pid=3494114)[0m step:13 - train/true_reward_mean:0.7522163391113281 - train/kept_rate_layer1:0.205078125 - train/kept_rate_layer2:0.49007936507936506 - global_seqlen/min:774556 - global_seqlen/max:882349 - global_seqlen/minmax_diff:107793 - global_seqlen/balanced_min:806085 - global_seqlen/balanced_max:806086 - global_seqlen/mean:806085.25 - actor/entropy:0.11139024794101715 - actor/pg_loss:0.033883330596963725 - actor/pg_clipfrac:0.013221156971335232 - actor/ppo_kl:0.00574856345595842 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.03977798554115 - perf/mfu/actor:0.3021416525858028 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.4828224182129 - actor/lr:1e-06 - critic/score/mean:0.5466588139533997 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5466588139533997 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.010516392067074776 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.010516392067074776 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:410.296630859375 - response_length/max:2048.0 - response_length/min:35.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:376.89599609375 - prompt_length/max:1200.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.531055361032486e-05 - timing_s/generate_sequences:23.889724731445312 - timing_s/reshard:2.1774380207061768 - timing_s/gen:279.15280541498214 - timing_s/reward filter:5.520806963555515 - timing_s/gen_layer2:241.68353134393692 - timing_s/process_data:250.26998770888895 - timing_s/reward:8.649574090726674 - timing_s/step:1015.4230252327397 - timing_s/old_log_prob:70.98885049205273 - timing_s/adv:0.2926275432109833 - timing_s/update_actor:401.1101202778518 - timing_s/stop_profile:1.1259689927101135e-06 - timing_per_token_ms/adv:4.537788391658687e-05 - timing_per_token_ms/gen:0.0830527662898062 - timing_per_token_ms/update_actor:0.06220032562899703 - perf/total_num_tokens:6448682 - perf/time_per_step:1015.4230252327397 - perf/throughput:793.8418077679905 - train/num_gen_batches:7
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.23828125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5150273224043715
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1508 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.185546875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5276315789473685
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2711 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.21875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.49776785714285715
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4049 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.20703125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.482311320754717
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5276 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.205078125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5111111111111111
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6564 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.2109375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5023148148148148
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7866 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.20703125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4705188679245283
[36m(TaskRunner pid=3494114)[0m step:14 - train/true_reward_mean:0.7751455307006836 - train/kept_rate_layer1:0.20703125 - train/kept_rate_layer2:0.4705188679245283 - global_seqlen/min:753028 - global_seqlen/max:820989 - global_seqlen/minmax_diff:67961 - global_seqlen/balanced_min:796914 - global_seqlen/balanced_max:796915 - global_seqlen/mean:796914.375 - actor/entropy:0.11020686477422714 - actor/pg_loss:-0.017781101456386554 - actor/pg_clipfrac:0.013038083137558762 - actor/ppo_kl:0.006009842438068483 - actor/pg_clipfrac_lower:6.5874761032759196e-06 - actor/grad_norm:1.0327558289282024 - perf/mfu/actor:0.28798308768937897 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.539306640625 - actor/lr:1e-06 - critic/score/mean:0.5646568536758423 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5646568536758423 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.012684482149779797 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.012684482149779797 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:411.961669921875 - response_length/max:2048.0 - response_length/min:37.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:366.2750244140625 - prompt_length/max:1288.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.1778978407382965e-05 - timing_s/generate_sequences:24.141437530517578 - timing_s/reshard:3.440953254699707 - timing_s/gen:281.0650373166427 - timing_s/reward filter:5.541661091148853 - timing_s/gen_layer2:231.01537861395627 - timing_s/process_data:239.72771473880857 - timing_s/reward:8.957613945007324 - timing_s/step:1021.288570961915 - timing_s/old_log_prob:69.6426005186513 - timing_s/adv:0.30512167420238256 - timing_s/update_actor:415.98733364325017 - timing_s/stop_profile:1.126900315284729e-06 - timing_per_token_ms/adv:4.785985856422507e-05 - timing_per_token_ms/gen:0.08328371167291675 - timing_per_token_ms/update_actor:0.06524969097891636 - perf/total_num_tokens:6375315 - perf/time_per_step:1021.288570961915 - perf/throughput:780.3028425642863 - train/num_gen_batches:7
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.2109375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5042438271604939
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1307 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.2265625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5057471264367817
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2715 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.181640625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5004480286738351
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3832 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.21875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5267857142857143
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5248 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.21875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5126488095238095
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6626 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.185546875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.46842105263157896
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7694 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.21875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4921875
[36m(TaskRunner pid=3494114)[0m step:15 - train/true_reward_mean:0.784092903137207 - train/kept_rate_layer1:0.21875 - train/kept_rate_layer2:0.4921875 - global_seqlen/min:769219 - global_seqlen/max:840926 - global_seqlen/minmax_diff:71707 - global_seqlen/balanced_min:809907 - global_seqlen/balanced_max:809908 - global_seqlen/mean:809907.5 - actor/entropy:0.1191565990447998 - actor/pg_loss:-0.0035346375884997695 - actor/pg_clipfrac:0.012586684366574556 - actor/ppo_kl:0.00610218579010716 - actor/pg_clipfrac_lower:1.208241525972554e-05 - actor/grad_norm:1.0413943047169596 - perf/mfu/actor:0.30271284449538616 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.50743865966797 - actor/lr:1e-06 - critic/score/mean:0.5626464486122131 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5626464486122131 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.010274450294673443 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.010274450294673443 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:405.762939453125 - response_length/max:1497.0 - response_length/min:27.0 - response_length/clip_ratio:0.0 - prompt_length/mean:385.162353515625 - prompt_length/max:1551.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.3958273231983185e-05 - timing_s/generate_sequences:23.178916931152344 - timing_s/reshard:3.4585325717926025 - timing_s/gen:276.209081617184 - timing_s/reward filter:5.509352590888739 - timing_s/gen_layer2:214.8264398658648 - timing_s/process_data:223.52824129350483 - timing_s/reward:8.722155903466046 - timing_s/step:987.3212476158515 - timing_s/old_log_prob:71.40368775743991 - timing_s/adv:0.28644711803644896 - timing_s/update_actor:402.189726206474 - timing_s/stop_profile:1.1343508958816528e-06 - timing_per_token_ms/adv:4.4209850821922406e-05 - timing_per_token_ms/gen:0.08309514159619977 - timing_per_token_ms/update_actor:0.06207340440211907 - perf/total_num_tokens:6479260 - perf/time_per_step:987.3212476158515 - perf/throughput:820.3079817797258 - train/num_gen_batches:7
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.21484375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5571969696969697
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1471 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.205078125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.48968253968253966
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2705 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.19140625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5561224489795918
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4013 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.212890625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4568042813455658
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5208 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.2109375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5192901234567902
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6554 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.208984375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5101246105919003
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7864 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.205078125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.528968253968254
[36m(TaskRunner pid=3494114)[0m step:16 - train/true_reward_mean:0.7561864852905273 - train/kept_rate_layer1:0.205078125 - train/kept_rate_layer2:0.528968253968254 - global_seqlen/min:753762 - global_seqlen/max:864385 - global_seqlen/minmax_diff:110623 - global_seqlen/balanced_min:809227 - global_seqlen/balanced_max:809228 - global_seqlen/mean:809227.125 - actor/entropy:0.10955675691366196 - actor/pg_loss:0.027211385188937776 - actor/pg_clipfrac:0.013595141448628422 - actor/ppo_kl:0.00748913207439146 - actor/pg_clipfrac_lower:9.313267528881678e-06 - actor/grad_norm:1.0448586319107562 - perf/mfu/actor:0.29767166410828655 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.40343475341797 - actor/lr:1e-06 - critic/score/mean:0.5651626586914062 - critic/score/max:1.0 - critic/score/min:-0.365234375 - critic/rewards/mean:0.5651626586914062 - critic/rewards/max:1.0 - critic/rewards/min:-0.365234375 - critic/advantages/mean:-0.009487077593803406 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.009487077593803406 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:411.64990234375 - response_length/max:1838.0 - response_length/min:20.0 - response_length/clip_ratio:0.0 - prompt_length/mean:378.6109619140625 - prompt_length/max:1133.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.9229017198085785e-05 - timing_s/generate_sequences:22.61248779296875 - timing_s/reshard:2.1966800689697266 - timing_s/gen:278.40929021313787 - timing_s/reward filter:5.681160613894463 - timing_s/gen_layer2:225.6476407079026 - timing_s/process_data:234.6137450709939 - timing_s/reward:8.61662654671818 - timing_s/step:1007.4753575250506 - timing_s/old_log_prob:71.24922085925937 - timing_s/adv:0.2856479147449136 - timing_s/update_actor:408.703865557909 - timing_s/stop_profile:1.1753290891647339e-06 - timing_per_token_ms/adv:4.412356956412478e-05 - timing_per_token_ms/gen:0.08255925451633216 - timing_per_token_ms/update_actor:0.0631318224716437 - perf/total_num_tokens:6473817 - perf/time_per_step:1007.4753575250506 - perf/throughput:803.2227477880309 - train/num_gen_batches:7
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.205078125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5166666666666667
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1302 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.189453125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5171821305841925
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2506 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.169921875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4664750957854406
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3480 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.166015625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5142156862745098
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4529 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5917467948717948
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6006 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.228515625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5274216524216524
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7487 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.185546875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5557017543859649
[36m(TaskRunner pid=3494114)[0m step:17 - train/true_reward_mean:0.7559518814086914 - train/kept_rate_layer1:0.185546875 - train/kept_rate_layer2:0.5557017543859649 - global_seqlen/min:766825 - global_seqlen/max:831369 - global_seqlen/minmax_diff:64544 - global_seqlen/balanced_min:794082 - global_seqlen/balanced_max:794083 - global_seqlen/mean:794082.875 - actor/entropy:0.1166251003742218 - actor/pg_loss:0.04360575376544148 - actor/pg_clipfrac:0.012939491276823294 - actor/ppo_kl:0.0060275851976318035 - actor/pg_clipfrac_lower:3.2894631537298363e-06 - actor/grad_norm:1.0702273666393012 - perf/mfu/actor:0.2952660199539031 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.50642013549805 - actor/lr:1e-06 - critic/score/mean:0.5693359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5693359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.013686258345842361 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.013686258345842361 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:394.830078125 - response_length/max:1448.0 - response_length/min:48.0 - response_length/clip_ratio:0.0 - prompt_length/mean:380.6414794921875 - prompt_length/max:1277.0 - prompt_length/min:41.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.5005079805850983e-05 - timing_s/generate_sequences:21.44620132446289 - timing_s/reshard:3.2984938621520996 - timing_s/gen:269.259736363776 - timing_s/reward filter:5.511607344262302 - timing_s/gen_layer2:207.14029059186578 - timing_s/process_data:215.65820226538926 - timing_s/reward:7.936175340786576 - timing_s/step:972.2421316755936 - timing_s/old_log_prob:70.068001258187 - timing_s/adv:0.2941472604870796 - timing_s/update_actor:404.21750628296286 - timing_s/stop_profile:1.2153759598731995e-06 - timing_per_token_ms/adv:4.630298513978777e-05 - timing_per_token_ms/gen:0.08324750818803581 - timing_per_token_ms/update_actor:0.06362961584503425 - perf/total_num_tokens:6352663 - perf/time_per_step:972.2421316755936 - perf/throughput:816.7542314088486 - train/num_gen_batches:7
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.205078125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4857142857142857
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1224 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.212890625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5007645259938838
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2534 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5168269230769231
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3824 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.171875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5265151515151515
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4936 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.22265625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5025584795321637
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6311 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.193359375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5273569023569024
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7564 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.201171875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5169902912621359
[36m(TaskRunner pid=3494114)[0m step:18 - train/true_reward_mean:0.7705602645874023 - train/kept_rate_layer1:0.201171875 - train/kept_rate_layer2:0.5169902912621359 - global_seqlen/min:739007 - global_seqlen/max:879840 - global_seqlen/minmax_diff:140833 - global_seqlen/balanced_min:810913 - global_seqlen/balanced_max:810914 - global_seqlen/mean:810913.25 - actor/entropy:0.11153734475374222 - actor/pg_loss:-0.010528908657832625 - actor/pg_clipfrac:0.012251475943598406 - actor/ppo_kl:0.006161514855187971 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9920447189360857 - perf/mfu/actor:0.2890735390042907 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.55918884277344 - actor/lr:1e-06 - critic/score/mean:0.5664381980895996 - critic/score/max:1.0 - critic/score/min:-0.896484375 - critic/rewards/mean:0.5664381980895996 - critic/rewards/max:1.0 - critic/rewards/min:-0.896484375 - critic/advantages/mean:-0.011332920752465725 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.011332920752465725 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:416.0810546875 - response_length/max:1995.0 - response_length/min:16.0 - response_length/clip_ratio:0.0 - prompt_length/mean:375.826416015625 - prompt_length/max:1499.0 - prompt_length/min:47.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.1705403923988342e-05 - timing_s/generate_sequences:22.32170867919922 - timing_s/reshard:2.097788095474243 - timing_s/gen:283.17055779788643 - timing_s/reward filter:5.493217837065458 - timing_s/gen_layer2:239.99856398254633 - timing_s/process_data:248.4739778554067 - timing_s/reward:8.213237095624208 - timing_s/step:1038.847809243016 - timing_s/old_log_prob:71.71610947791487 - timing_s/adv:0.26420178171247244 - timing_s/update_actor:422.05630203615874 - timing_s/stop_profile:1.1399388313293457e-06 - timing_per_token_ms/adv:4.072596262801114e-05 - timing_per_token_ms/gen:0.08307688632242301 - timing_per_token_ms/update_actor:0.06505879359416046 - perf/total_num_tokens:6487306 - perf/time_per_step:1038.847809243016 - perf/throughput:780.5890745352714 - train/num_gen_batches:7
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5264423076923077
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1314 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5080128205128205
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2582 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.19921875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5204248366013072
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3856 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1953125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.49125
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5035 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.205078125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4845238095238095
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6256 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1796875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.458786231884058
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7269 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.484375
[36m(TaskRunner pid=3494114)[0m step:19 - train/true_reward_mean:0.7721443176269531 - train/kept_rate_layer1:0.1875 - train/kept_rate_layer2:0.484375 - global_seqlen/min:721565 - global_seqlen/max:840061 - global_seqlen/minmax_diff:118496 - global_seqlen/balanced_min:793083 - global_seqlen/balanced_max:793084 - global_seqlen/mean:793083.125 - actor/entropy:0.11276814341545105 - actor/pg_loss:0.042181987661638526 - actor/pg_clipfrac:0.013782240765610734 - actor/ppo_kl:0.007677500562073413 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.026276932330802 - perf/mfu/actor:0.29403628201304294 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.95050430297852 - actor/lr:1e-06 - critic/score/mean:0.5746415257453918 - critic/score/max:1.0 - critic/score/min:-0.8828125 - critic/rewards/mean:0.5746415257453918 - critic/rewards/max:1.0 - critic/rewards/min:-0.8828125 - critic/advantages/mean:-0.010327566415071487 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.010327566415071487 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:402.102294921875 - response_length/max:1988.0 - response_length/min:37.0 - response_length/clip_ratio:0.0 - prompt_length/mean:372.3929443359375 - prompt_length/max:1370.0 - prompt_length/min:47.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.5288201868534088e-05 - timing_s/generate_sequences:21.610122680664062 - timing_s/reshard:2.1235032081604004 - timing_s/gen:283.5865717930719 - timing_s/reward filter:5.497155704535544 - timing_s/gen_layer2:223.12947333231568 - timing_s/process_data:231.54832911025733 - timing_s/reward:8.08403331041336 - timing_s/step:1003.1262710178271 - timing_s/old_log_prob:69.28526326734573 - timing_s/adv:0.4418651405721903 - timing_s/update_actor:405.46703713107854 - timing_s/stop_profile:1.017935574054718e-06 - timing_per_token_ms/adv:6.964357307630746e-05 - timing_per_token_ms/gen:0.08609128044471832 - timing_per_token_ms/update_actor:0.06390676846312272 - perf/total_num_tokens:6344665 - perf/time_per_step:1003.1262710178271 - perf/throughput:790.6114593084021 - train/num_gen_batches:7
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.193359375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5218855218855218
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1240 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.169921875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.46455938697318006
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2210 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.2109375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5185185185185185
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3554 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.173828125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5084269662921348
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4640 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.20703125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5066823899371069
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5929 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.171875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.47679924242424243
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6936 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1953125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5016666666666667
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=8140 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.171875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5662878787878788
[36m(TaskRunner pid=3494114)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 20}
[36m(TaskRunner pid=3494114)[0m validation generation end
[36m(TaskRunner pid=3494114)[0m [prompt] system
[36m(TaskRunner pid=3494114)[0m You are a helpful assistant.
[36m(TaskRunner pid=3494114)[0m user
[36m(TaskRunner pid=3494114)[0m How many vertical asymptotes does the graph of $y=\frac{2}{x^2+x-6}$ have? Let's think step by step and output the final answer within \boxed{}.
[36m(TaskRunner pid=3494114)[0m assistant
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m [response] To determine the number of vertical asymptotes of the function \( y = \frac{2}{x^2 + x - 6} \), we need to identify the values of \( x \) that make the denominator zero, as these are the potential locations of the vertical asymptotes.
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m First, let's factor the denominator \( x^2 + x - 6 \):
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m \[ x^2 + x - 6 = (x + 3)(x - 2) \]
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m So the function can be rewritten as:
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m \[ y = \frac{2}{(x + 3)(x - 2)} \]
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m The vertical asymptotes occur where the denominator is zero but the numerator is not zero. Therefore, we need to solve the equation:
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m \[ (x + 3)(x - 2) = 0 \]
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m This equation has two solutions:
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m \[ x + 3 = 0 \quad \text{or} \quad x - 2 = 0 \]
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m \[ x = -3 \quad \text{or} \quad x = 2 \]
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m These solutions indicate that the function has vertical asymptotes at \( x = -3 \) and \( x = 2 \). Since these are the only values that make the denominator zero, the function has two vertical asymptotes.
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m Thus, the number of vertical asymptotes is:
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m \[ \boxed{2} \]
[36m(TaskRunner pid=3494114)[0m [ground_truth] 2
[36m(TaskRunner pid=3494114)[0m [score] 1.0
[36m(TaskRunner pid=3494114)[0m len reward_extra_infos_dict['reward']: 5000
[36m(TaskRunner pid=3494114)[0m len reward_extra_infos_dict['acc']: 5000
[36m(TaskRunner pid=3494114)[0m local_global_step_folder: /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20
[36m(TaskRunner pid=3494114)[0m step:20 - train/true_reward_mean:0.7772026062011719 - train/kept_rate_layer1:0.171875 - train/kept_rate_layer2:0.5662878787878788 - global_seqlen/min:789484 - global_seqlen/max:835268 - global_seqlen/minmax_diff:45784 - global_seqlen/balanced_min:810697 - global_seqlen/balanced_max:810698 - global_seqlen/mean:810697.625 - actor/entropy:0.11422564834356308 - actor/pg_loss:0.027299211268304008 - actor/pg_clipfrac:0.012975088252091208 - actor/ppo_kl:0.00549908955922952 - actor/pg_clipfrac_lower:4.583996991095173e-06 - actor/grad_norm:1.0041203368455172 - perf/mfu/actor:0.2980426991981124 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.68172073364258 - actor/lr:1e-06 - val-aux/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:0.683204296875 - val-core/DigitalLearningGmbH/MATH-lighteval/acc/mean@1:0.6846 - critic/score/mean:0.5724062919616699 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5724062919616699 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.013133322820067406 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888513803482056 - critic/returns/mean:-0.013133322820067406 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888513803482056 - response_length/mean:411.2164306640625 - response_length/max:2048.0 - response_length/min:49.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:380.48046875 - prompt_length/max:1162.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.277921885251999e-05 - timing_s/generate_sequences:21.128297805786133 - timing_s/reshard:2.125243663787842 - timing_s/gen:313.48399061430246 - timing_s/reward filter:6.42343557626009 - timing_s/gen_layer2:253.30131006147712 - timing_s/process_data:262.9275720193982 - timing_s/reward:8.854191512800753 - timing_s/step:1213.698492792435 - timing_s/old_log_prob:71.46139608696103 - timing_s/adv:0.29225730802863836 - timing_s/update_actor:409.06750386208296 - timing_s/testing:89.60814033821225 - timing_s/save_checkpoint:52.00338705442846 - timing_s/stop_profile:3.094784915447235e-06 - timing_per_token_ms/adv:4.506262554251321e-05 - timing_per_token_ms/gen:0.09305826772592346 - timing_per_token_ms/update_actor:0.06307337829287507 - perf/total_num_tokens:6485581 - perf/time_per_step:1213.698492792435 - perf/throughput:667.9563580364801 - train/num_gen_batches:8
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5144230769230769
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1284 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.212890625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4709480122324159
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2516 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.171875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5232007575757576
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3621 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.18359375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.48847517730496454
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4723 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.177734375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4784798534798535
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5768 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.44190705128205127
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6871 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.173828125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4363295880149813
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7803 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.146484375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5166666666666667
[36m(TaskRunner pid=3494114)[0m step:21 - train/true_reward_mean:0.8197202682495117 - train/kept_rate_layer1:0.146484375 - train/kept_rate_layer2:0.5166666666666667 - global_seqlen/min:709221 - global_seqlen/max:830622 - global_seqlen/minmax_diff:121401 - global_seqlen/balanced_min:782334 - global_seqlen/balanced_max:782335 - global_seqlen/mean:782334.625 - actor/entropy:0.11643873900175095 - actor/pg_loss:-0.0018893004036492275 - actor/pg_clipfrac:0.01392570012902114 - actor/ppo_kl:0.006802527497733891 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0449742679484189 - perf/mfu/actor:0.2988271797276442 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:225.1083869934082 - actor/lr:1e-06 - critic/score/mean:0.5682986378669739 - critic/score/max:1.0 - critic/score/min:-0.1328125 - critic/rewards/mean:0.5682986378669739 - critic/rewards/max:1.0 - critic/rewards/min:-0.1328125 - critic/advantages/mean:-0.010647944174706936 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.010647944174706936 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:402.0673828125 - response_length/max:1604.0 - response_length/min:41.0 - response_length/clip_ratio:0.0 - prompt_length/mean:361.9312744140625 - prompt_length/max:1320.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.839416265487671e-05 - timing_s/generate_sequences:18.869226455688477 - timing_s/reshard:2.116542100906372 - timing_s/gen:316.0754570616409 - timing_s/reward filter:6.230000618845224 - timing_s/gen_layer2:232.74437102209777 - timing_s/process_data:242.10563387256116 - timing_s/reward:8.476431116461754 - timing_s/step:1034.747659609653 - timing_s/old_log_prob:68.90696745645255 - timing_s/adv:0.26351937279105186 - timing_s/update_actor:393.4134758403525 - timing_s/stop_profile:1.1920928955078125e-06 - timing_per_token_ms/adv:4.210464492592474e-05 - timing_per_token_ms/gen:0.09596259598876197 - timing_per_token_ms/update_actor:0.06285888788323035 - perf/total_num_tokens:6258677 - perf/time_per_step:1034.747659609653 - perf/throughput:756.0631983406727 - train/num_gen_batches:8
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.15234375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5101495726495726
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=955 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.166015625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5004901960784314
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1976 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.205078125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5313492063492063
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3315 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1953125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5233333333333333
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4571 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.193359375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5420875420875421
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5859 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.173828125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5276217228464419
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6986 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.166015625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.49607843137254903
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7998 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.189453125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5158934707903781
[36m(TaskRunner pid=3494114)[0m step:22 - train/true_reward_mean:0.7935705184936523 - train/kept_rate_layer1:0.189453125 - train/kept_rate_layer2:0.5158934707903781 - global_seqlen/min:789603 - global_seqlen/max:850277 - global_seqlen/minmax_diff:60674 - global_seqlen/balanced_min:813125 - global_seqlen/balanced_max:813126 - global_seqlen/mean:813125.875 - actor/entropy:0.11923682689666748 - actor/pg_loss:0.03211453022121339 - actor/pg_clipfrac:0.01307107295930348 - actor/ppo_kl:0.006098864473578299 - actor/pg_clipfrac_lower:3.500018811311184e-06 - actor/grad_norm:1.0026547983288765 - perf/mfu/actor:0.30196245733169025 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:225.31138229370117 - actor/lr:1e-06 - critic/score/mean:0.587498664855957 - critic/score/max:1.0 - critic/score/min:-0.537109375 - critic/rewards/mean:0.587498664855957 - critic/rewards/max:1.0 - critic/rewards/min:-0.537109375 - critic/advantages/mean:-0.015183238312602043 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.015183238312602043 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:412.875244140625 - response_length/max:1811.0 - response_length/min:38.0 - response_length/clip_ratio:0.0 - prompt_length/mean:381.1929931640625 - prompt_length/max:1372.0 - prompt_length/min:49.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.3515895009040833e-05 - timing_s/generate_sequences:21.138139724731445 - timing_s/reshard:3.330355405807495 - timing_s/gen:322.8991607129574 - timing_s/reward filter:6.386323230341077 - timing_s/gen_layer2:245.95858253724873 - timing_s/process_data:255.34532375633717 - timing_s/reward:8.518834337592125 - timing_s/step:1069.67992191948 - timing_s/old_log_prob:71.75219703558832 - timing_s/adv:0.28332843724638224 - timing_s/update_actor:404.99692846275866 - timing_s/stop_profile:1.2367963790893555e-06 - timing_per_token_ms/adv:4.355543925569676e-05 - timing_per_token_ms/gen:0.09546806696115022 - timing_per_token_ms/update_actor:0.06225926097585424 - perf/total_num_tokens:6505007 - perf/time_per_step:1069.67992191948 - perf/throughput:760.158116776551 - train/num_gen_batches:8
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.169921875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5186781609195402
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1083 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.185546875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.48903508771929827
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2198 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.185546875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4925438596491228
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3321 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1796875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.46105072463768115
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4339 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.18359375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.49069148936170215
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5446 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.189453125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4845360824742268
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6574 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1796875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5067934782608695
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7693 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.189453125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5137457044673539
[36m(TaskRunner pid=3494114)[0m step:23 - train/true_reward_mean:0.7902240753173828 - train/kept_rate_layer1:0.189453125 - train/kept_rate_layer2:0.5137457044673539 - global_seqlen/min:758169 - global_seqlen/max:859851 - global_seqlen/minmax_diff:101682 - global_seqlen/balanced_min:803457 - global_seqlen/balanced_max:803458 - global_seqlen/mean:803457.875 - actor/entropy:0.11485082656145096 - actor/pg_loss:0.031912271835225464 - actor/pg_clipfrac:0.012629700237563444 - actor/ppo_kl:0.00669602094760828 - actor/pg_clipfrac_lower:5.042031357573394e-06 - actor/grad_norm:0.987283529015258 - perf/mfu/actor:0.2939020097079522 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.87704849243164 - actor/lr:1e-06 - critic/score/mean:0.5881214141845703 - critic/score/max:1.0 - critic/score/min:-0.416015625 - critic/rewards/mean:0.5881214141845703 - critic/rewards/max:1.0 - critic/rewards/min:-0.416015625 - critic/advantages/mean:-0.018802812322974205 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.018802812322974205 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:415.163818359375 - response_length/max:2048.0 - response_length/min:28.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:369.4630126953125 - prompt_length/max:1244.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.7501024305820465e-05 - timing_s/generate_sequences:22.795156478881836 - timing_s/reshard:2.822878837585449 - timing_s/gen:322.2489972785115 - timing_s/reward filter:6.3145399279892445 - timing_s/gen_layer2:252.18335438985378 - timing_s/process_data:261.44396680686623 - timing_s/reward:8.289463012479246 - timing_s/step:1079.1693097855896 - timing_s/old_log_prob:70.618693202734 - timing_s/adv:0.26793785486370325 - timing_s/update_actor:411.1168233314529 - timing_s/stop_profile:1.282431185245514e-06 - timing_per_token_ms/adv:4.168511243724247e-05 - timing_per_token_ms/gen:0.0947506359201768 - timing_per_token_ms/update_actor:0.0639605441871257 - perf/total_num_tokens:6427663 - perf/time_per_step:1079.1693097855896 - perf/throughput:744.5151263239981 - train/num_gen_batches:8
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1796875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4723731884057971
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1043 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1640625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5069444444444444
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2065 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.19140625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.45110544217687076
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3126 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.193359375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5109427609427609
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4340 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.185546875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5258771929824562
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5539 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1640625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.48561507936507936
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6518 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.173828125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5117041198501873
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7611 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1796875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.49682971014492755
[36m(TaskRunner pid=3494114)[0m step:24 - train/true_reward_mean:0.7978372573852539 - train/kept_rate_layer1:0.1796875 - train/kept_rate_layer2:0.49682971014492755 - global_seqlen/min:755894 - global_seqlen/max:862673 - global_seqlen/minmax_diff:106779 - global_seqlen/balanced_min:810516 - global_seqlen/balanced_max:810517 - global_seqlen/mean:810516.5 - actor/entropy:0.12238720804452896 - actor/pg_loss:0.010815537888017689 - actor/pg_clipfrac:0.012611783555801658 - actor/ppo_kl:0.007080633375580377 - actor/pg_clipfrac_lower:1.2974458233037083e-05 - actor/grad_norm:1.0212703943252563 - perf/mfu/actor:0.29330248438816414 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:226.20623779296875 - actor/lr:1e-06 - critic/score/mean:0.5862431526184082 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5862431526184082 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.015149256214499474 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.015149256214499474 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:413.758056640625 - response_length/max:2048.0 - response_length/min:33.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:377.761962890625 - prompt_length/max:1387.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.9433518648147583e-05 - timing_s/generate_sequences:22.428464889526367 - timing_s/reshard:2.1399025917053223 - timing_s/gen:312.0505727576092 - timing_s/reward filter:6.245680958963931 - timing_s/gen_layer2:246.01310926955193 - timing_s/process_data:254.7987165628001 - timing_s/reward:7.909456595778465 - timing_s/step:1066.212441554293 - timing_s/old_log_prob:70.81080583296716 - timing_s/adv:0.48080085683614016 - timing_s/update_actor:415.5699314381927 - timing_s/stop_profile:1.232139766216278e-06 - timing_per_token_ms/adv:7.415038078128886e-05 - timing_per_token_ms/gen:0.09206373222458057 - timing_per_token_ms/update_actor:0.06409029480556422 - perf/total_num_tokens:6484132 - perf/time_per_step:1066.212441554293 - perf/throughput:760.182932041623 - train/num_gen_batches:8
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.16015625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5208333333333334
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1025 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.150390625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4523809523809524
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1861 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1640625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.42857142857142855
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2725 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1640625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5034722222222222
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3740 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.173828125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.49204119850187267
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4791 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.169921875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5009578544061303
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5837 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4982638888888889
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6985 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.185546875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.500438596491228
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=8126 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=8. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.162109375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4959839357429719
[36m(TaskRunner pid=3494114)[0m step:25 - train/true_reward_mean:0.8070249557495117 - train/kept_rate_layer1:0.162109375 - train/kept_rate_layer2:0.4959839357429719 - global_seqlen/min:769531 - global_seqlen/max:842749 - global_seqlen/minmax_diff:73218 - global_seqlen/balanced_min:803563 - global_seqlen/balanced_max:803564 - global_seqlen/mean:803563.625 - actor/entropy:0.11991483718156815 - actor/pg_loss:0.0019766472739347323 - actor/pg_clipfrac:0.01262286749592346 - actor/ppo_kl:0.006547148107407785 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0285047246143222 - perf/mfu/actor:0.293963958456836 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:226.21645736694336 - actor/lr:1e-06 - critic/score/mean:0.5912901759147644 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5912901759147644 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.014372208155691624 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.014372208155691624 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:411.92333984375 - response_length/max:2048.0 - response_length/min:15.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:372.8067626953125 - prompt_length/max:1175.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.0753202736377716e-05 - timing_s/generate_sequences:21.355945587158203 - timing_s/reshard:2.1593422889709473 - timing_s/gen:352.0131400534883 - timing_s/reward filter:7.0145440408959985 - timing_s/gen_layer2:272.8657618490979 - timing_s/process_data:282.5808327039704 - timing_s/reward:8.59399432875216 - timing_s/step:1130.528154462576 - timing_s/old_log_prob:70.43168531451374 - timing_s/adv:0.25755455531179905 - timing_s/update_actor:411.0820111287758 - timing_s/stop_profile:1.2330710887908936e-06 - timing_per_token_ms/adv:4.006443100753208e-05 - timing_per_token_ms/gen:0.1043163857302551 - timing_per_token_ms/update_actor:0.06394671161365345 - perf/total_num_tokens:6428509 - perf/time_per_step:1130.528154462576 - perf/throughput:710.7860355605151 - train/num_gen_batches:9
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.158203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5282921810699589
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1027 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.193359375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5425084175084175
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2316 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.173828125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5468164794007491
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3484 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.16015625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.505589430894309
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4479 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.166015625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4676470588235294
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5433 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.169921875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4755747126436782
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6426 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.15234375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4754273504273504
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7316 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.166015625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4455882352941177
[36m(TaskRunner pid=3494114)[0m step:26 - train/true_reward_mean:0.8095817565917969 - train/kept_rate_layer1:0.166015625 - train/kept_rate_layer2:0.4455882352941177 - global_seqlen/min:782585 - global_seqlen/max:879168 - global_seqlen/minmax_diff:96583 - global_seqlen/balanced_min:821724 - global_seqlen/balanced_max:821725 - global_seqlen/mean:821724.625 - actor/entropy:0.12238747626543045 - actor/pg_loss:0.011240947437338316 - actor/pg_clipfrac:0.013013032448227302 - actor/ppo_kl:0.006749264634742688 - actor/pg_clipfrac_lower:1.4874628888299831e-05 - actor/grad_norm:1.0066649476066232 - perf/mfu/actor:0.28877243121680285 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:225.36490631103516 - actor/lr:1e-06 - critic/score/mean:0.5820251107215881 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5820251107215881 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.01903747208416462 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.01903747208416462 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:424.73974609375 - response_length/max:2048.0 - response_length/min:9.0 - response_length/clip_ratio:0.000244140625 - prompt_length/mean:377.7257080078125 - prompt_length/max:1232.0 - prompt_length/min:45.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.6335008442401886e-05 - timing_s/generate_sequences:23.293102264404297 - timing_s/reshard:2.150965452194214 - timing_s/gen:322.8288820134476 - timing_s/reward filter:6.209309987723827 - timing_s/gen_layer2:252.53242409601808 - timing_s/process_data:261.0103142121807 - timing_s/reward:7.192120197229087 - timing_s/step:1095.962980964221 - timing_s/old_log_prob:71.76756446901709 - timing_s/adv:0.2930221753194928 - timing_s/update_actor:428.2299179909751 - timing_s/stop_profile:1.080334186553955e-06 - timing_per_token_ms/adv:4.4574265880052706e-05 - timing_per_token_ms/gen:0.09278110389675881 - timing_per_token_ms/update_actor:0.06514194429657245 - perf/total_num_tokens:6573797 - perf/time_per_step:1095.962980964221 - perf/throughput:749.7740701762135 - train/num_gen_batches:8
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.158203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4624485596707819
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=899 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.15625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.48333333333333334
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1827 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.181640625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5058243727598566
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2956 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.177734375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.46886446886446886
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3980 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.17578125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5259259259259259
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5116 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.193359375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4936868686868687
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6289 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1796875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.458786231884058
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7302 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.158203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.536522633744856
[36m(TaskRunner pid=3494114)[0m step:27 - train/true_reward_mean:0.8312845230102539 - train/kept_rate_layer1:0.158203125 - train/kept_rate_layer2:0.536522633744856 - global_seqlen/min:766002 - global_seqlen/max:902690 - global_seqlen/minmax_diff:136688 - global_seqlen/balanced_min:825983 - global_seqlen/balanced_max:825984 - global_seqlen/mean:825983.125 - actor/entropy:0.12360380589962006 - actor/pg_loss:-0.01801493577211379 - actor/pg_clipfrac:0.011652449810734163 - actor/ppo_kl:0.005959540985257683 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9885996908415109 - perf/mfu/actor:0.2857665937943781 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:225.43412017822266 - actor/lr:1e-06 - critic/score/mean:0.5869325995445251 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5869325995445251 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.01476421020925045 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.01476421020925045 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:423.3323974609375 - response_length/max:2048.0 - response_length/min:16.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:383.291748046875 - prompt_length/max:1858.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.4031847715377808e-05 - timing_s/generate_sequences:21.968664169311523 - timing_s/reshard:2.944565773010254 - timing_s/gen:328.0258099595085 - timing_s/reward filter:6.301293638534844 - timing_s/gen_layer2:278.1136486483738 - timing_s/process_data:286.98274640832096 - timing_s/reward:7.927943873219192 - timing_s/step:1135.2592523749918 - timing_s/old_log_prob:71.97715661861002 - timing_s/adv:0.2478219661861658 - timing_s/update_actor:435.0204033171758 - timing_s/stop_profile:1.058913767337799e-06 - timing_per_token_ms/adv:3.7504090381108846e-05 - timing_per_token_ms/gen:0.09458811413912081 - timing_per_token_ms/update_actor:0.06583373045865432 - perf/total_num_tokens:6607865 - perf/time_per_step:1135.2592523749918 - perf/throughput:727.5722468431964 - train/num_gen_batches:8
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.15625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.521875
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1002 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1640625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4861111111111111
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1982 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.189453125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4720790378006873
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3081 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.193359375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5113636363636364
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4296 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.15625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4375
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5136 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.162109375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.43724899598393574
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6007 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.16796875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.46705426356589147
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6971 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1640625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.48908730158730157
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7957 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=8. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.162109375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4934738955823293
[36m(TaskRunner pid=3494114)[0m step:28 - train/true_reward_mean:0.8147468566894531 - train/kept_rate_layer1:0.162109375 - train/kept_rate_layer2:0.4934738955823293 - global_seqlen/min:767863 - global_seqlen/max:889110 - global_seqlen/minmax_diff:121247 - global_seqlen/balanced_min:817595 - global_seqlen/balanced_max:817596 - global_seqlen/mean:817595.875 - actor/entropy:0.13827268779277802 - actor/pg_loss:0.01656323878781959 - actor/pg_clipfrac:0.011872035559148543 - actor/ppo_kl:0.004919958504729399 - actor/pg_clipfrac_lower:1.3922182436559408e-05 - actor/grad_norm:1.0598616092465818 - perf/mfu/actor:0.295010666177873 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.66293716430664 - actor/lr:1e-06 - critic/score/mean:0.5868927240371704 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5868927240371704 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.016270622611045837 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.016270622611045837 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:422.095947265625 - response_length/max:2048.0 - response_length/min:20.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:376.3375244140625 - prompt_length/max:1224.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.783032298088074e-05 - timing_s/generate_sequences:21.75946807861328 - timing_s/reshard:2.090433359146118 - timing_s/gen:360.3687512483448 - timing_s/reward filter:7.322514582425356 - timing_s/gen_layer2:291.2275237329304 - timing_s/process_data:301.8242211975157 - timing_s/reward:8.803290395997465 - timing_s/step:1166.958160046488 - timing_s/old_log_prob:71.93080049939454 - timing_s/adv:0.25398968905210495 - timing_s/update_actor:416.867893143557 - timing_s/stop_profile:1.105479896068573e-06 - timing_per_token_ms/adv:3.883178976595634e-05 - timing_per_token_ms/gen:0.10421878334794127 - timing_per_token_ms/update_actor:0.06373379347461193 - perf/total_num_tokens:6540767 - perf/time_per_step:1166.958160046488 - perf/throughput:700.6214129968716 - train/num_gen_batches:9
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.119140625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.43920765027322406
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=643 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.19921875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4693627450980392
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1792 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4830729166666667
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2905 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1484375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.46984649122807015
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3762 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.185546875
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.41973684210526313
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4719 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.16796875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4636627906976744
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5676 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.14453125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4791666666666667
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6527 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.140625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.46875
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7337 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=8. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.142578125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4075342465753425
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=8051 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=9. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.158203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5041152263374485
[36m(TaskRunner pid=3494114)[0m step:29 - train/true_reward_mean:0.8283395767211914 - train/kept_rate_layer1:0.158203125 - train/kept_rate_layer2:0.5041152263374485 - global_seqlen/min:801178 - global_seqlen/max:835988 - global_seqlen/minmax_diff:34810 - global_seqlen/balanced_min:822634 - global_seqlen/balanced_max:822635 - global_seqlen/mean:822634.25 - actor/entropy:0.13182564079761505 - actor/pg_loss:0.02415791049319361 - actor/pg_clipfrac:0.012452847553991007 - actor/ppo_kl:0.00693952707602574 - actor/pg_clipfrac_lower:2.9375561057726384e-06 - actor/grad_norm:0.9859053115360439 - perf/mfu/actor:0.2935945228158077 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:225.5708122253418 - actor/lr:1e-06 - critic/score/mean:0.5930538177490234 - critic/score/max:1.0 - critic/score/min:-0.71875 - critic/rewards/mean:0.5930538177490234 - critic/rewards/max:1.0 - critic/rewards/min:-0.71875 - critic/advantages/mean:-0.01654331386089325 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.01654331386089325 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:427.8751220703125 - response_length/max:1904.0 - response_length/min:36.0 - response_length/clip_ratio:0.0 - prompt_length/mean:375.4786376953125 - prompt_length/max:1255.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.478303551673889e-05 - timing_s/generate_sequences:23.413270950317383 - timing_s/reshard:2.174530029296875 - timing_s/gen:398.9368219599128 - timing_s/reward filter:7.888318611308932 - timing_s/gen_layer2:297.32362826447934 - timing_s/process_data:308.159714714624 - timing_s/reward:9.136422184295952 - timing_s/step:1216.5911228246987 - timing_s/old_log_prob:72.36551641114056 - timing_s/adv:0.27845187205821276 - timing_s/update_actor:421.6154756108299 - timing_s/stop_profile:1.173466444015503e-06 - timing_per_token_ms/adv:4.2311007604262274e-05 - timing_per_token_ms/gen:0.11381438184293603 - timing_per_token_ms/update_actor:0.06406484346032727 - perf/total_num_tokens:6581074 - perf/time_per_step:1216.5911228246987 - perf/throughput:676.1797242856712 - train/num_gen_batches:10
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.16015625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5416666666666666
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1066 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.193359375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.46675084175084175
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2175 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1328125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4810049019607843
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2960 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.142578125
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4914383561643836
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3821 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.197265625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5045379537953796
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5044 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.123046875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.46296296296296297
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5744 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.166015625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4627450980392157
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6688 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.181640625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4520609318996416
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7697 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=8. Keep generating...
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.15625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4942708333333333
[36m(TaskRunner pid=3494114)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 30}
[36m(TaskRunner pid=3494114)[0m validation generation end
[36m(TaskRunner pid=3494114)[0m [prompt] system
[36m(TaskRunner pid=3494114)[0m You are a helpful assistant.
[36m(TaskRunner pid=3494114)[0m user
[36m(TaskRunner pid=3494114)[0m How many vertical asymptotes does the graph of $y=\frac{2}{x^2+x-6}$ have? Let's think step by step and output the final answer within \boxed{}.
[36m(TaskRunner pid=3494114)[0m assistant
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m [response] To determine the number of vertical asymptotes of the function \( y = \frac{2}{x^2 + x - 6} \), we need to identify the values of \( x \) that make the denominator zero. The vertical asymptotes occur where the denominator is zero and the numerator is not zero.
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m First, we factor the quadratic expression in the denominator:
[36m(TaskRunner pid=3494114)[0m \[ x^2 + x - 6. \]
[36m(TaskRunner pid=3494114)[0m We look for two numbers that multiply to \(-6\) and add up to \(1\). These numbers are \(3\) and \(-2\). Therefore, we can factor the quadratic as follows:
[36m(TaskRunner pid=3494114)[0m \[ x^2 + x - 6 = (x + 3)(x - 2). \]
[36m(TaskRunner pid=3494114)[0m So, the function can be rewritten as:
[36m(TaskRunner pid=3494114)[0m \[ y = \frac{2}{(x + 3)(x - 2)}. \]
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m Next, we set the denominator equal to zero to find the values of \( x \) that are not in the domain of the function:
[36m(TaskRunner pid=3494114)[0m \[ (x + 3)(x - 2) = 0. \]
[36m(TaskRunner pid=3494114)[0m This equation gives us the solutions:
[36m(TaskRunner pid=3494114)[0m \[ x + 3 = 0 \quad \text{or} \quad x - 2 = 0, \]
[36m(TaskRunner pid=3494114)[0m \[ x = -3 \quad \text{or} \quad x = 2. \]
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m To determine which of these values are vertical asymptotes, we need to ensure that the numerator is not zero at these points. The numerator is \(2\), which is not zero for any value of \( x \). Therefore, both \( x = -3 \) and \( x = 2 \) are vertical asymptotes.
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m Thus, the function \( y = \frac{2}{x^2 + x - 6} \) has two vertical asymptotes, at \( x = -3 \) and \( x = 2 \).
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m The final answer is:
[36m(TaskRunner pid=3494114)[0m \[ \boxed{2} \]
[36m(TaskRunner pid=3494114)[0m [ground_truth] 2
[36m(TaskRunner pid=3494114)[0m [score] 1.0
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m len reward_extra_infos_dict['reward']: 5000
[36m(TaskRunner pid=3494114)[0m len reward_extra_infos_dict['acc']: 5000
[36m(TaskRunner pid=3494114)[0m step:30 - train/true_reward_mean:0.8199996948242188 - train/kept_rate_layer1:0.15625 - train/kept_rate_layer2:0.4942708333333333 - global_seqlen/min:776945 - global_seqlen/max:842765 - global_seqlen/minmax_diff:65820 - global_seqlen/balanced_min:822655 - global_seqlen/balanced_max:822656 - global_seqlen/mean:822655.75 - actor/entropy:0.14400920271873474 - actor/pg_loss:0.02320989358066848 - actor/pg_clipfrac:0.01355512451234416 - actor/ppo_kl:0.007009470142142522 - actor/pg_clipfrac_lower:1.4319754714312351e-06 - actor/grad_norm:1.00110191735439 - perf/mfu/actor:0.29690664674522654 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:225.78641510009766 - actor/lr:1e-06 - val-aux/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:0.66759453125 - val-core/DigitalLearningGmbH/MATH-lighteval/acc/mean@1:0.6712 - critic/score/mean:0.5852223634719849 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5852223634719849 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.02358200214803219 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.02358200214803219 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:420.9146728515625 - response_length/max:2048.0 - response_length/min:35.0 - response_length/clip_ratio:0.000244140625 - prompt_length/mean:382.4600830078125 - prompt_length/max:1575.0 - prompt_length/min:45.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.7515925467014313e-05 - timing_s/generate_sequences:20.826717376708984 - timing_s/reshard:2.101799249649048 - timing_s/gen:361.2322025289759 - timing_s/reward filter:7.086626209318638 - timing_s/gen_layer2:288.5197027400136 - timing_s/process_data:298.21463755331933 - timing_s/reward:8.302280333824456 - timing_s/step:1251.7678850684315 - timing_s/old_log_prob:71.82534623984247 - timing_s/adv:0.254119710996747 - timing_s/update_actor:416.89456159528345 - timing_s/testing:89.29930298961699 - timing_s/stop_profile:1.0458752512931824e-06 - timing_per_token_ms/adv:3.8612705101244816e-05 - timing_per_token_ms/gen:0.10476167900976438 - timing_per_token_ms/update_actor:0.06334584083246295 - perf/total_num_tokens:6581246 - perf/time_per_step:1251.7678850684315 - perf/throughput:657.1951236430923 - train/num_gen_batches:9
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.205078125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5119047619047619
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1290 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.185546875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4807017543859649
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2386 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1640625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4861111111111111
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3366 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1640625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.46478174603174605
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4303 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.154296875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.47837552742616035
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5210 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.154296875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5073839662447257
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6172 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.150390625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.45292207792207795
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7009 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.171875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4602272727272727
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7981 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=8. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4418402777777778
[36m(TaskRunner pid=3494114)[0m step:31 - train/true_reward_mean:0.8215255737304688 - train/kept_rate_layer1:0.1875 - train/kept_rate_layer2:0.4418402777777778 - global_seqlen/min:795519 - global_seqlen/max:877281 - global_seqlen/minmax_diff:81762 - global_seqlen/balanced_min:832487 - global_seqlen/balanced_max:832488 - global_seqlen/mean:832487.375 - actor/entropy:0.1521076261997223 - actor/pg_loss:0.026374775438535204 - actor/pg_clipfrac:0.012909973449997912 - actor/ppo_kl:0.006978807153072754 - actor/pg_clipfrac_lower:7.99782867000604e-06 - actor/grad_norm:1.0348449484445155 - perf/mfu/actor:0.2900812944637004 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:225.12442016601562 - actor/lr:1e-06 - critic/score/mean:0.5982086062431335 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5982086062431335 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.031571563333272934 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.031571563333272934 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:430.013671875 - response_length/max:2048.0 - response_length/min:8.0 - response_length/clip_ratio:0.0009765625 - prompt_length/mean:382.9622802734375 - prompt_length/max:1270.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.0209310352802277e-05 - timing_s/generate_sequences:24.665016174316406 - timing_s/reshard:2.194542407989502 - timing_s/gen:372.53642686083913 - timing_s/reward filter:7.214616288430989 - timing_s/gen_layer2:309.17089525889605 - timing_s/process_data:319.3842490706593 - timing_s/reward:8.746345069259405 - timing_s/step:1212.2295424807817 - timing_s/old_log_prob:72.86846724059433 - timing_s/adv:0.3065388845279813 - timing_s/update_actor:432.1215618979186 - timing_s/stop_profile:1.1408701539039612e-06 - timing_per_token_ms/adv:4.602755755424839e-05 - timing_per_token_ms/gen:0.1057539353254686 - timing_per_token_ms/update_actor:0.0648841013802039 - perf/total_num_tokens:6659899 - perf/time_per_step:1212.2295424807817 - perf/throughput:686.7407086089869 - train/num_gen_batches:9
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.15625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.44583333333333336
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=856 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.17578125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4634259259259259
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1857 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.134765625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5084541062801933
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2699 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1484375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5208333333333334
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3649 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.15625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4588541666666667
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4530 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1796875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.43976449275362317
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5501 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.130859375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4614427860696517
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6243 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.158203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.44238683127572015
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7103 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=8. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.134765625
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4921497584541063
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7918 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=9. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.150390625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4458874458874459
[36m(TaskRunner pid=3494114)[0m step:32 - train/true_reward_mean:0.835780143737793 - train/kept_rate_layer1:0.150390625 - train/kept_rate_layer2:0.4458874458874459 - global_seqlen/min:773061 - global_seqlen/max:885116 - global_seqlen/minmax_diff:112055 - global_seqlen/balanced_min:815138 - global_seqlen/balanced_max:815139 - global_seqlen/mean:815138.5 - actor/entropy:0.14147689938545227 - actor/pg_loss:-0.007013410362974988 - actor/pg_clipfrac:0.012509955075949642 - actor/ppo_kl:0.006683364409501694 - actor/pg_clipfrac_lower:4.4216880430408485e-06 - actor/grad_norm:0.9588128856848925 - perf/mfu/actor:0.2930534446627361 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:225.9342498779297 - actor/lr:1e-06 - critic/score/mean:0.5972908139228821 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5972908139228821 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.02375049516558647 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.02375049516558647 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:419.947265625 - response_length/max:2048.0 - response_length/min:13.0 - response_length/clip_ratio:0.0003662109375 - prompt_length/mean:376.08642578125 - prompt_length/max:1352.0 - prompt_length/min:43.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.4135766327381134e-05 - timing_s/generate_sequences:22.829139709472656 - timing_s/reshard:3.6343834400177 - timing_s/gen:405.8294640285894 - timing_s/reward filter:7.7846231404691935 - timing_s/gen_layer2:313.06703057605773 - timing_s/process_data:323.5489666322246 - timing_s/reward:8.705572815611959 - timing_s/step:1234.8027250487357 - timing_s/old_log_prob:71.83264623489231 - timing_s/adv:0.28703664243221283 - timing_s/update_actor:418.4305895389989 - timing_s/stop_profile:1.0365620255470276e-06 - timing_per_token_ms/adv:4.401654480070148e-05 - timing_per_token_ms/gen:0.11796654854258505 - timing_per_token_ms/update_actor:0.06416556657840951 - perf/total_num_tokens:6521108 - perf/time_per_step:1234.8027250487357 - perf/throughput:660.1366222024071 - train/num_gen_batches:10
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.142578125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4372146118721461
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=766 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.154296875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1714 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.171875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5241477272727273
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2821 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.158203125
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.44650205761316875
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3689 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.150390625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.49512987012987014
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4604 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.177734375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.461996336996337
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5613 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.158203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.45627572016460904
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6500 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.130859375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.40298507462686567
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7148 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=8. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.146484375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.48333333333333334
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=8018 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=9. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.177734375
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4716117216117216
[36m(TaskRunner pid=3494114)[0m step:33 - train/true_reward_mean:0.8121700286865234 - train/kept_rate_layer1:0.177734375 - train/kept_rate_layer2:0.4716117216117216 - global_seqlen/min:776855 - global_seqlen/max:838372 - global_seqlen/minmax_diff:61517 - global_seqlen/balanced_min:809859 - global_seqlen/balanced_max:809859 - global_seqlen/mean:809859.0 - actor/entropy:0.13470962643623352 - actor/pg_loss:0.0006781904897118201 - actor/pg_clipfrac:0.011964223364780306 - actor/ppo_kl:0.006459074497201311 - actor/pg_clipfrac_lower:4.8847246884566835e-06 - actor/grad_norm:0.9427366619929671 - perf/mfu/actor:0.29374009488173086 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:226.35969161987305 - actor/lr:1e-06 - critic/score/mean:0.599379301071167 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.599379301071167 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.014076282270252705 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.014076282270252705 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:422.0916748046875 - response_length/max:2048.0 - response_length/min:23.0 - response_length/clip_ratio:0.0003662109375 - prompt_length/mean:368.7862548828125 - prompt_length/max:1299.0 - prompt_length/min:41.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.7574598789215088e-05 - timing_s/generate_sequences:25.122705459594727 - timing_s/reshard:3.328108787536621 - timing_s/gen:400.3077352689579 - timing_s/reward filter:7.7596211433410645 - timing_s/gen_layer2:315.56417035870254 - timing_s/process_data:326.0211751181632 - timing_s/reward:8.769840196706355 - timing_s/step:1227.433599983342 - timing_s/old_log_prob:71.20591129083186 - timing_s/adv:0.2696369765326381 - timing_s/update_actor:414.77384292613715 - timing_s/stop_profile:1.0924413800239563e-06 - timing_per_token_ms/adv:4.161788912215554e-05 - timing_per_token_ms/gen:0.11577032492540952 - timing_per_token_ms/update_actor:0.06401945322058178 - perf/total_num_tokens:6478872 - perf/time_per_step:1227.433599983342 - perf/throughput:659.7986237389875 - train/num_gen_batches:10
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.146484375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.44555555555555554
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=802 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1796875
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.48188405797101447
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1866 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.154296875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.47468354430379744
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2766 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.12109375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4724462365591398
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3469 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.158203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.45524691358024694
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4354 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.150390625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.45670995670995673
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5198 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1171875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4708333333333333
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5876 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.14453125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.44256756756756754
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6662 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=8. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.134765625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4251207729468599
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7366 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=9. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.16796875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.47141472868217055
[36m(TaskRunner pid=3494114)[0m step:34 - train/true_reward_mean:0.8229999542236328 - train/kept_rate_layer1:0.16796875 - train/kept_rate_layer2:0.47141472868217055 - global_seqlen/min:802057 - global_seqlen/max:927514 - global_seqlen/minmax_diff:125457 - global_seqlen/balanced_min:836310 - global_seqlen/balanced_max:836311 - global_seqlen/mean:836310.5 - actor/entropy:0.12940257787704468 - actor/pg_loss:-0.03262407967797407 - actor/pg_clipfrac:0.011767773314044872 - actor/ppo_kl:0.007047921999675 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9154987339861691 - perf/mfu/actor:0.2950900609665902 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:224.09914016723633 - actor/lr:1e-06 - critic/score/mean:0.6096216440200806 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6096216440200806 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.020009908825159073 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.020009908825159073 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:432.7142333984375 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.000732421875 - prompt_length/mean:383.9952392578125 - prompt_length/max:1387.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.5643577575683594e-05 - timing_s/generate_sequences:25.466493606567383 - timing_s/reshard:2.1355628967285156 - timing_s/gen:408.7679042555392 - timing_s/reward filter:7.978737381286919 - timing_s/gen_layer2:327.34663032274693 - timing_s/process_data:337.75768849253654 - timing_s/reward:8.34416622016579 - timing_s/step:1260.643684453331 - timing_s/old_log_prob:73.07525905780494 - timing_s/adv:0.26397037878632545 - timing_s/update_actor:426.61682587862015 - timing_s/stop_profile:1.1371448636054993e-06 - timing_per_token_ms/adv:3.945460130931117e-05 - timing_per_token_ms/gen:0.11531496299660182 - timing_per_token_ms/update_actor:0.06376471805008728 - perf/total_num_tokens:6690484 - perf/time_per_step:1260.643684453331 - perf/throughput:663.3995873010382 - train/num_gen_batches:10
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.162109375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.48744979919678716
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=971 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1328125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5006127450980392
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1788 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.185546875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4710526315789474
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2862 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.158203125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4794238683127572
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3794 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.181640625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.41487455197132617
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4720 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.16015625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.47510162601626016
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5655 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.12109375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.47043010752688175
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6355 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.154296875
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4404008438818565
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7190 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=8. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.146484375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4577777777777778
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=8014 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=9. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.14453125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.5281531531531531
[36m(TaskRunner pid=3494114)[0m step:35 - train/true_reward_mean:0.8093423843383789 - train/kept_rate_layer1:0.14453125 - train/kept_rate_layer2:0.5281531531531531 - global_seqlen/min:781629 - global_seqlen/max:883319 - global_seqlen/minmax_diff:101690 - global_seqlen/balanced_min:817979 - global_seqlen/balanced_max:817979 - global_seqlen/mean:817979.0 - actor/entropy:0.1344827562570572 - actor/pg_loss:0.01754469212739417 - actor/pg_clipfrac:0.012351455743397643 - actor/ppo_kl:0.007498164440809253 - actor/pg_clipfrac_lower:3.7745751554320097e-06 - actor/grad_norm:0.9612912926822901 - perf/mfu/actor:0.2959618264772922 - perf/max_memory_allocated_gb:82.70982265472412 - perf/max_memory_reserved_gb:123.244140625 - perf/cpu_memory_used_gb:225.50033569335938 - actor/lr:1e-06 - critic/score/mean:0.6053367853164673 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6053367853164673 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.02290891297161579 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.788851261138916 - critic/returns/mean:-0.02290891297161579 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.788851261138916 - response_length/mean:427.8345947265625 - response_length/max:2048.0 - response_length/min:8.0 - response_length/clip_ratio:0.0006103515625 - prompt_length/mean:370.9730224609375 - prompt_length/max:1278.0 - prompt_length/min:45.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:3.591831773519516e-05 - timing_s/generate_sequences:20.675779342651367 - timing_s/reshard:3.3108978271484375 - timing_s/gen:402.7758246958256 - timing_s/reward filter:7.7539509534835815 - timing_s/gen_layer2:323.5262141926214 - timing_s/process_data:334.00084878038615 - timing_s/reward:8.623914546333253 - timing_s/step:1239.8940573222935 - timing_s/old_log_prob:72.05769769102335 - timing_s/adv:0.2722852462902665 - timing_s/update_actor:415.8731473200023 - timing_s/stop_profile:1.0672956705093384e-06 - timing_per_token_ms/adv:4.1609449370073454e-05 - timing_per_token_ms/gen:0.11492051225892153 - timing_per_token_ms/update_actor:0.06355192910209222 - perf/total_num_tokens:6543832 - perf/time_per_step:1239.8940573222935 - perf/throughput:659.7168485237586 - train/num_gen_batches:10
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.15625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.3927083333333333
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=754 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.146484375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4216666666666667
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=1513 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.115234375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4872881355932203
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=2203 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.142578125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4577625570776256
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3005 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.12890625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4154040404040404
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=3663 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=5. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.1328125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4632352941176471
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=4419 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=6. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.12109375
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.44623655913978494
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5083 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=7. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.125
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.462890625
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=5794 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=8. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.150390625
[36m(TaskRunner pid=3494114)[0m 
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.4512987012987013
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=6628 < prompt_bsz*16=8192
[36m(TaskRunner pid=3494114)[0m num_gen_batches=9. Keep generating...
[36m(TaskRunner pid=3494114)[0m kept_rate_layer1=0.134765625
[36m(TaskRunner pid=3494114)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3494114)[0m kept_rate_layer2=0.43176328502415456
[36m(TaskRunner pid=3494114)[0m num_prompt_in_batch=7343 < prompt_bsz*16=8192
Error executing job with overrides: ['data.train_files=/workspace/data/math/train.parquet', 'data.val_files=/workspace/data/math/test.parquet', 'data.prompt_key=prompt', 'data.truncation=left', 'data.max_prompt_length=3072', 'data.max_response_length=2048', 'data.gen_batch_size=512', 'data.train_batch_size=512', '+actor_rollout_ref.rollout.n_layer1=4', '+actor_rollout_ref.rollout.n_layer2=4', 'actor_rollout_ref.actor.use_kl_loss=False', 'actor_rollout_ref.actor.kl_loss_coef=0.0', 'actor_rollout_ref.actor.clip_ratio_low=0.2', 'actor_rollout_ref.actor.clip_ratio_high=0.28', 'actor_rollout_ref.actor.clip_ratio_c=10.0', 'algorithm.adv_estimator=grpo', 'algorithm.use_kl_in_reward=False', 'algorithm.kl_ctrl.kl_coef=0.0', 'algorithm.filter_groups.enable=True', 'algorithm.filter_groups.metric=seq_reward', 'algorithm.filter_groups.max_num_gen_batches=10', 'actor_rollout_ref.model.use_remove_padding=True', 'actor_rollout_ref.actor.use_dynamic_bsz=True', 'actor_rollout_ref.ref.log_prob_use_dynamic_bsz=True', 'actor_rollout_ref.rollout.log_prob_use_dynamic_bsz=True', 'actor_rollout_ref.actor.ppo_max_token_len_per_gpu=5120', 'actor_rollout_ref.ref.log_prob_max_token_len_per_gpu=5120', 'actor_rollout_ref.rollout.log_prob_max_token_len_per_gpu=5120', 'actor_rollout_ref.model.path=/workspace/models/Qwen/Qwen2.5-7B-Instruct-1M', 'actor_rollout_ref.model.enable_gradient_checkpointing=True', 'actor_rollout_ref.actor.optim.lr=1e-6', 'actor_rollout_ref.actor.optim.lr_warmup_steps=10', 'actor_rollout_ref.actor.optim.weight_decay=0.1', 'actor_rollout_ref.actor.ppo_mini_batch_size=32', 'actor_rollout_ref.actor.ppo_micro_batch_size=null', 'actor_rollout_ref.actor.fsdp_config.param_offload=False', 'actor_rollout_ref.actor.fsdp_config.optimizer_offload=False', 'actor_rollout_ref.actor.entropy_coeff=0', 'actor_rollout_ref.actor.grad_clip=1.0', 'actor_rollout_ref.actor.loss_agg_mode=token-mean', 'actor_rollout_ref.actor.ulysses_sequence_parallel_size=1', 'actor_rollout_ref.rollout.gpu_memory_utilization=0.85', 'actor_rollout_ref.rollout.log_prob_micro_batch_size=null', 'actor_rollout_ref.rollout.tensor_model_parallel_size=1', 'actor_rollout_ref.rollout.enable_chunked_prefill=True', 'actor_rollout_ref.rollout.max_num_batched_tokens=5120', 'actor_rollout_ref.rollout.temperature=1.0', 'actor_rollout_ref.rollout.top_p=1.0', 'actor_rollout_ref.rollout.top_k=-1', 'actor_rollout_ref.rollout.val_kwargs.temperature=1.0', 'actor_rollout_ref.rollout.val_kwargs.top_p=1.0', 'actor_rollout_ref.rollout.val_kwargs.top_k=-1', 'actor_rollout_ref.rollout.val_kwargs.do_sample=True', 'actor_rollout_ref.rollout.val_kwargs.n=1', 'actor_rollout_ref.ref.log_prob_micro_batch_size=null', 'actor_rollout_ref.ref.fsdp_config.param_offload=False', 'actor_rollout_ref.ref.ulysses_sequence_parallel_size=1', 'actor_rollout_ref.actor.fsdp_config.fsdp_size=-1', 'reward_model.reward_manager=dapo', 'reward_model.overlong_buffer.enable=True', 'reward_model.overlong_buffer.len=512', 'reward_model.overlong_buffer.penalty_factor=1.0', 'trainer.logger=[console,tensorboard]', 'trainer.project_name=my_DAPO', 'trainer.experiment_name=DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724', 'trainer.n_gpus_per_node=8', 'trainer.nnodes=1', 'trainer.val_before_train=True', 'trainer.total_training_steps=100', 'trainer.test_freq=10', 'trainer.save_freq=20', 'trainer.total_epochs=100', 'trainer.default_local_dir=/workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724', 'trainer.resume_mode=disable']
Traceback (most recent call last):
  File "/workspace/lujiahao/verl/recipe/dapo/my_main_dapo.py", line 33, in main
    run_ppo(config)
  File "/workspace/lujiahao/verl/recipe/dapo/my_main_dapo.py", line 55, in run_ppo
    ray.get(runner.run.remote(config))
  File "/root/miniconda3/envs/verl/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/miniconda3/envs/verl/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/root/miniconda3/envs/verl/lib/python3.10/site-packages/ray/_private/worker.py", line 2849, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/miniconda3/envs/verl/lib/python3.10/site-packages/ray/_private/worker.py", line 937, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ValueError): [36mray::TaskRunner.run()[39m (pid=3494114, ip=10.1.15.172, actor_id=f6c0e727faa8c7603087c20101000000, repr=<my_main_dapo.TaskRunner object at 0x7f5cf7c9b8e0>)
  File "/workspace/lujiahao/verl/recipe/dapo/my_main_dapo.py", line 167, in run
    trainer.fit()
  File "/workspace/lujiahao/verl/recipe/dapo/my_dapo_ray_trainer.py", line 560, in fit
    raise ValueError(
ValueError: num_gen_batches=10 >= max_num_gen_batches=10. Generated too many. Please check if your data are too difficult. You could also try set max_num_gen_batches=0 to enable endless trials.

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
