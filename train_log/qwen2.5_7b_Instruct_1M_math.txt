nohup: ignoring input
+ project_name=my_DAPO
+ exp_name=DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724
+ adv_estimator=grpo
+ use_kl_in_reward=False
+ kl_coef=0.0
+ use_kl_loss=False
+ kl_loss_coef=0.0
+ clip_ratio_low=0.2
+ clip_ratio_high=0.28
+ max_prompt_length=3072
+ max_response_length=2048
+ enable_overlong_buffer=True
+ overlong_buffer_len=512
+ overlong_penalty_factor=1.0
+ loss_agg_mode=token-mean
+ enable_filter_groups=True
+ filter_groups_metric=seq_reward
+ max_num_gen_batches=10
+ train_prompt_bsz=512
+ gen_prompt_bsz=1536
+ train_prompt_mini_bsz=32
+ n_layer1=4
+ n_layer2=4
+ WORKING_DIR=/workspace/lujiahao/verl
+ RUNTIME_ENV=/workspace/lujiahao/verl/verl/trainer/runtime_env.yaml
+ NNODES=1
+ RAY_DATA_HOME=/workspace
+ MODEL_PATH=/workspace/models/Qwen/Qwen2.5-7B-Instruct-1M
+ CKPTS_DIR=/workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724
+ TRAIN_FILE=/workspace/data/math/train.parquet
+ TEST_FILE=/workspace/data/math/test.parquet
+ export TENSORBOARD_DIR=/workspace/log/tensorboard/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724
+ TENSORBOARD_DIR=/workspace/log/tensorboard/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724
+ temperature=1.0
+ top_p=1.0
+ top_k=-1
+ use_dynamic_bsz=True
+ infer_micro_batch_size=null
+ train_micro_batch_size=null
+ offload=False
+ python3 -m recipe.dapo.my_main_dapo data.train_files=/workspace/data/math/train.parquet data.val_files=/workspace/data/math/test.parquet data.prompt_key=prompt data.truncation=left data.max_prompt_length=3072 data.max_response_length=2048 data.gen_batch_size=1536 data.train_batch_size=512 +actor_rollout_ref.rollout.n_layer1=4 +actor_rollout_ref.rollout.n_layer2=4 actor_rollout_ref.actor.use_kl_loss=False actor_rollout_ref.actor.kl_loss_coef=0.0 actor_rollout_ref.actor.clip_ratio_low=0.2 actor_rollout_ref.actor.clip_ratio_high=0.28 actor_rollout_ref.actor.clip_ratio_c=10.0 algorithm.adv_estimator=grpo algorithm.use_kl_in_reward=False algorithm.kl_ctrl.kl_coef=0.0 algorithm.filter_groups.enable=True algorithm.filter_groups.metric=seq_reward algorithm.filter_groups.max_num_gen_batches=10 actor_rollout_ref.model.use_remove_padding=True actor_rollout_ref.actor.use_dynamic_bsz=True actor_rollout_ref.ref.log_prob_use_dynamic_bsz=True actor_rollout_ref.rollout.log_prob_use_dynamic_bsz=True actor_rollout_ref.actor.ppo_max_token_len_per_gpu=5120 actor_rollout_ref.ref.log_prob_max_token_len_per_gpu=5120 actor_rollout_ref.rollout.log_prob_max_token_len_per_gpu=5120 actor_rollout_ref.model.path=/workspace/models/Qwen/Qwen2.5-7B-Instruct-1M actor_rollout_ref.model.enable_gradient_checkpointing=True actor_rollout_ref.actor.optim.lr=1e-6 actor_rollout_ref.actor.optim.lr_warmup_steps=10 actor_rollout_ref.actor.optim.weight_decay=0.1 actor_rollout_ref.actor.ppo_mini_batch_size=32 actor_rollout_ref.actor.ppo_micro_batch_size=null actor_rollout_ref.actor.fsdp_config.param_offload=False actor_rollout_ref.actor.fsdp_config.optimizer_offload=False actor_rollout_ref.actor.entropy_coeff=0 actor_rollout_ref.actor.grad_clip=1.0 actor_rollout_ref.actor.loss_agg_mode=token-mean actor_rollout_ref.actor.ulysses_sequence_parallel_size=1 actor_rollout_ref.rollout.gpu_memory_utilization=0.85 actor_rollout_ref.rollout.log_prob_micro_batch_size=null actor_rollout_ref.rollout.tensor_model_parallel_size=1 actor_rollout_ref.rollout.enable_chunked_prefill=True actor_rollout_ref.rollout.max_num_batched_tokens=5120 actor_rollout_ref.rollout.temperature=1.0 actor_rollout_ref.rollout.top_p=1.0 actor_rollout_ref.rollout.top_k=-1 actor_rollout_ref.rollout.val_kwargs.temperature=1.0 actor_rollout_ref.rollout.val_kwargs.top_p=1.0 actor_rollout_ref.rollout.val_kwargs.top_k=-1 actor_rollout_ref.rollout.val_kwargs.do_sample=True actor_rollout_ref.rollout.val_kwargs.n=1 actor_rollout_ref.ref.log_prob_micro_batch_size=null actor_rollout_ref.ref.fsdp_config.param_offload=False actor_rollout_ref.ref.ulysses_sequence_parallel_size=1 actor_rollout_ref.actor.fsdp_config.fsdp_size=-1 reward_model.reward_manager=dapo reward_model.overlong_buffer.enable=True reward_model.overlong_buffer.len=512 reward_model.overlong_buffer.penalty_factor=1.0 'trainer.logger=[console,tensorboard]' trainer.project_name=my_DAPO trainer.experiment_name=DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724 trainer.n_gpus_per_node=8 trainer.nnodes=1 trainer.val_before_train=True trainer.total_training_steps=100 trainer.test_freq=10 trainer.save_freq=20 trainer.total_epochs=50 trainer.default_local_dir=/workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724 trainer.resume_mode=disable
2025-07-25 15:23:04,854	INFO worker.py:1908 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=3962660)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=3962660)[0m WARNING:2025-07-25 15:23:13,880:Waiting for register center actor fFiSJw_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=3968731)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=3968731)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=3968731)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=3964536)[0m Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:09,  3.19s/it]
[36m(WorkerDict pid=3964536)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=3964536)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3964536)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3964536)[0m Loading checkpoint shards:  75%|███████▌  | 3/4 [00:09<00:03,  3.18s/it][32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=3964536)[0m Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.17s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:12<00:00,  3.19s/it]
[36m(WorkerDict pid=3968727)[0m /root/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=3968727)[0m   warnings.warn(
[36m(WorkerDict pid=3968730)[0m Loading checkpoint shards:  75%|███████▌  | 3/4 [00:10<00:03,  3.56s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3968730)[0m Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.44s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:14<00:00,  3.50s/it][32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3962660)[0m Training Progress:   0%|          | 0/100 [00:00<?, ?it/s]
[36m(WorkerDict pid=3968729)[0m /root/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3968729)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3962660)[0m Training Progress:   1%|          | 1/100 [04:30<7:26:21, 270.52s/it]
[36m(TaskRunner pid=3962660)[0m /workspace/lujiahao/verl/recipe/dapo/my_dapo_ray_trainer.py:779: FutureWarning: Warning: Function 'verl.trainer.ppo.metric_utils.reduce_metrics' is deprecated. Please use 'verl.utils.metric.reduce_metrics' instead.
[36m(TaskRunner pid=3962660)[0m   actor_output_metrics = reduce_metrics(
[36m(TaskRunner pid=3962660)[0m Training Progress:   2%|▏         | 2/100 [17:33<15:34:22, 572.07s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:   3%|▎         | 3/100 [22:20<11:54:26, 441.92s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:   4%|▍         | 4/100 [35:53<15:41:20, 588.34s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:   5%|▌         | 5/100 [40:31<12:34:24, 476.47s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:   6%|▌         | 6/100 [53:42<15:14:03, 583.44s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:   7%|▋         | 7/100 [58:18<12:28:12, 482.71s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:   8%|▊         | 8/100 [1:11:25<14:48:40, 579.58s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:   9%|▉         | 9/100 [1:16:01<12:15:31, 484.96s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  10%|█         | 10/100 [1:29:01<14:23:54, 575.94s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  11%|█         | 11/100 [1:33:28<11:54:02, 481.37s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  12%|█▏        | 12/100 [1:46:35<14:02:33, 574.48s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  13%|█▎        | 13/100 [1:51:08<11:40:30, 483.11s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  14%|█▍        | 14/100 [2:04:28<13:49:33, 578.77s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  15%|█▌        | 15/100 [2:08:55<11:26:32, 484.61s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  16%|█▌        | 16/100 [2:22:04<13:26:59, 576.42s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  17%|█▋        | 17/100 [2:26:26<11:06:43, 481.97s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  18%|█▊        | 18/100 [2:39:27<13:01:21, 571.72s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  19%|█▉        | 19/100 [2:43:51<10:46:53, 479.18s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  20%|██        | 20/100 [2:58:18<13:14:07, 595.59s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  21%|██        | 21/100 [3:02:45<10:54:21, 496.99s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  22%|██▏       | 22/100 [3:15:25<12:28:41, 575.92s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  23%|██▎       | 23/100 [3:19:20<10:07:54, 473.69s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  24%|██▍       | 24/100 [3:31:02<11:26:55, 542.30s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  25%|██▌       | 25/100 [3:35:01<9:24:04, 451.27s/it] 
[36m(TaskRunner pid=3962660)[0m Training Progress:  26%|██▌       | 26/100 [3:46:56<10:53:57, 530.23s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  27%|██▋       | 27/100 [3:51:06<9:02:47, 446.13s/it] 
[36m(TaskRunner pid=3962660)[0m Training Progress:  28%|██▊       | 28/100 [4:03:15<10:37:20, 531.11s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  29%|██▉       | 29/100 [4:07:19<8:46:26, 444.88s/it] 
[36m(TaskRunner pid=3962660)[0m Training Progress:  30%|███       | 30/100 [4:19:23<10:16:40, 528.58s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  31%|███       | 31/100 [4:23:21<8:27:51, 441.61s/it] 
[36m(TaskRunner pid=3962660)[0m Training Progress:  32%|███▏      | 32/100 [4:35:00<9:47:45, 518.61s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  33%|███▎      | 33/100 [4:38:58<8:05:18, 434.61s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  34%|███▍      | 34/100 [4:50:42<9:27:03, 515.50s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  35%|███▌      | 35/100 [4:54:39<7:47:40, 431.70s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  36%|███▌      | 36/100 [5:06:20<9:06:54, 512.73s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  37%|███▋      | 37/100 [5:10:19<7:32:03, 430.53s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  38%|███▊      | 38/100 [5:21:54<8:46:49, 509.83s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  39%|███▉      | 39/100 [5:25:53<7:15:50, 428.69s/it]
[36m(WorkerDict pid=3968731)[0m INFO:2025-07-25 21:05:20,865:[Rank 6] Saved model to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=3968731)[0m INFO:2025-07-25 21:05:53,268:[Rank 6] Saved optim to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=3968731)[0m INFO:2025-07-25 21:05:53,287:[Rank 6] Saved extra_state to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=3968726)[0m INFO:2025-07-25 21:05:21,667:[Rank 1] Saved model to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3964536)[0m INFO:2025-07-25 21:05:53,769:[Rank 0] Saved model config and tokenizer class to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20/actor/huggingface
[36m(TaskRunner pid=3962660)[0m Training Progress:  40%|████      | 40/100 [5:40:13<9:17:58, 557.98s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  41%|████      | 41/100 [5:44:09<7:33:34, 461.27s/it]
[36m(WorkerDict pid=3968726)[0m INFO:2025-07-25 21:05:55,749:[Rank 1] Saved optim to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3968726)[0m INFO:2025-07-25 21:05:55,758:[Rank 1] Saved extra_state to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3962660)[0m Training Progress:  42%|████▏     | 42/100 [5:55:58<8:37:57, 535.81s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  43%|████▎     | 43/100 [5:59:53<7:03:12, 445.47s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  44%|████▍     | 44/100 [6:11:42<8:09:39, 524.64s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  45%|████▌     | 45/100 [6:15:38<6:41:22, 437.87s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  46%|████▌     | 46/100 [6:27:09<7:42:32, 513.93s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  47%|████▋     | 47/100 [6:30:59<6:18:45, 428.79s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  48%|████▊     | 48/100 [6:42:37<7:21:24, 509.32s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  49%|████▉     | 49/100 [6:46:27<6:01:51, 425.72s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  50%|█████     | 50/100 [6:57:51<6:59:24, 503.29s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  51%|█████     | 51/100 [7:01:44<5:44:42, 422.09s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  52%|█████▏    | 52/100 [7:13:40<6:48:17, 510.36s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  53%|█████▎    | 53/100 [7:17:32<5:34:12, 426.66s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  54%|█████▍    | 54/100 [7:28:59<6:27:02, 504.85s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  55%|█████▌    | 55/100 [7:32:43<5:15:24, 420.55s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  56%|█████▌    | 56/100 [7:44:34<6:12:20, 507.74s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  57%|█████▋    | 57/100 [7:48:11<5:01:20, 420.47s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  58%|█████▊    | 58/100 [7:59:35<5:49:42, 499.59s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  59%|█████▉    | 59/100 [8:03:26<4:46:22, 419.09s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  60%|██████    | 60/100 [8:16:43<5:54:52, 532.31s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  61%|██████    | 61/100 [8:20:37<4:47:48, 442.78s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  62%|██████▏   | 62/100 [8:32:39<5:33:30, 526.60s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  63%|██████▎   | 63/100 [8:36:32<4:30:30, 438.66s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  64%|██████▍   | 64/100 [8:40:24<3:45:59, 376.66s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  65%|██████▌   | 65/100 [8:52:05<4:36:23, 473.80s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  66%|██████▌   | 66/100 [8:55:50<3:46:16, 399.30s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  67%|██████▋   | 67/100 [8:59:33<3:10:32, 346.43s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  68%|██████▊   | 68/100 [9:11:10<4:00:44, 451.40s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  69%|██████▉   | 69/100 [9:14:56<3:18:19, 383.84s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  70%|███████   | 70/100 [9:18:46<2:48:53, 337.78s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  71%|███████   | 71/100 [9:30:25<3:35:33, 445.99s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  72%|███████▏  | 72/100 [9:34:16<2:58:06, 381.66s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  73%|███████▎  | 73/100 [9:38:12<2:32:03, 337.90s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  74%|███████▍  | 74/100 [9:49:54<3:13:46, 447.17s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  75%|███████▌  | 75/100 [9:53:33<2:37:50, 378.80s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  76%|███████▌  | 76/100 [9:57:25<2:13:47, 334.50s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  77%|███████▋  | 77/100 [10:09:07<2:50:34, 445.00s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  78%|███████▊  | 78/100 [10:12:51<2:18:49, 378.61s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  79%|███████▉  | 79/100 [10:16:35<1:56:17, 332.24s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  80%|████████  | 80/100 [10:28:17<2:27:42, 443.11s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  81%|████████  | 81/100 [10:31:58<1:59:12, 376.43s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  82%|████████▏ | 82/100 [10:35:55<1:40:21, 334.53s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  83%|████████▎ | 83/100 [10:47:36<2:05:59, 444.69s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  84%|████████▍ | 84/100 [10:51:26<1:41:21, 380.11s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  85%|████████▌ | 85/100 [10:55:07<1:23:04, 332.33s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  86%|████████▌ | 86/100 [11:06:42<1:42:55, 441.10s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  87%|████████▋ | 87/100 [11:10:32<1:21:52, 377.91s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  88%|████████▊ | 88/100 [11:14:22<1:06:42, 333.55s/it]
[36m(WorkerDict pid=3968726)[0m INFO:2025-07-26 02:53:55,624:[Rank 1] Saved model to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_40/actor/model_world_size_8_rank_1.pt
[36m(WorkerDict pid=3968728)[0m INFO:2025-07-26 02:54:27,804:[Rank 3] Saved optim to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_40/actor/optim_world_size_8_rank_3.pt
[36m(WorkerDict pid=3968727)[0m INFO:2025-07-26 02:53:56,560:[Rank 2] Saved model to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_40/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3968728)[0m INFO:2025-07-26 02:54:27,827:[Rank 3] Saved extra_state to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_40/actor/extra_state_world_size_8_rank_3.pt
[36m(WorkerDict pid=3964536)[0m INFO:2025-07-26 02:54:28,376:[Rank 0] Saved model config and tokenizer class to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_40/actor/huggingface
[36m(TaskRunner pid=3962660)[0m Training Progress:  89%|████████▉ | 89/100 [11:28:47<1:30:22, 492.99s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  90%|█████████ | 90/100 [11:32:35<1:08:56, 413.62s/it]
[36m(WorkerDict pid=3968727)[0m INFO:2025-07-26 02:54:29,808:[Rank 2] Saved optim to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_40/actor/optim_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3968727)[0m INFO:2025-07-26 02:54:29,815:[Rank 2] Saved extra_state to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_40/actor/extra_state_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3962660)[0m Training Progress:  91%|█████████ | 91/100 [11:36:22<53:36, 357.42s/it]  
[36m(TaskRunner pid=3962660)[0m Training Progress:  92%|█████████▏| 92/100 [11:48:22<1:02:10, 466.27s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  93%|█████████▎| 93/100 [11:52:11<46:06, 395.16s/it]  
[36m(TaskRunner pid=3962660)[0m Training Progress:  94%|█████████▍| 94/100 [11:56:00<34:32, 345.35s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  95%|█████████▌| 95/100 [12:08:12<38:26, 461.29s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  96%|█████████▌| 96/100 [12:11:55<25:58, 389.64s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  97%|█████████▋| 97/100 [12:15:51<17:10, 343.58s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  98%|█████████▊| 98/100 [12:28:24<15:33, 466.56s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress:  99%|█████████▉| 99/100 [12:32:18<06:36, 396.65s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 100%|██████████| 100/100 [12:36:13<00:00, 348.34s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 101it [12:49:05, 475.46s/it]                         
[36m(TaskRunner pid=3962660)[0m Training Progress: 102it [12:53:06, 404.99s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 103it [12:56:55, 352.06s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 104it [13:09:22, 470.80s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 105it [13:13:23, 401.79s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 106it [13:17:14, 350.54s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 107it [13:29:47, 471.33s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 108it [13:33:29, 396.55s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 109it [13:37:20, 346.63s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 110it [13:49:41, 465.02s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 111it [13:53:40, 397.25s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 112it [13:57:39, 349.65s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 113it [14:09:59, 467.02s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 114it [14:13:38, 392.53s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 115it [14:17:22, 341.86s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 116it [14:29:13, 452.56s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 117it [14:32:56, 383.87s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 118it [14:36:41, 336.14s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 119it [14:40:23, 301.76s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 120it [14:54:04, 457.57s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 121it [14:57:38, 384.65s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 122it [15:01:18, 335.31s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 123it [15:04:58, 300.47s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 124it [15:16:56, 425.92s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 125it [15:20:38, 364.82s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 126it [15:24:25, 323.29s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 127it [15:28:14, 295.20s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 128it [15:40:16, 423.19s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 129it [15:43:52, 360.90s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 130it [15:47:31, 318.28s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 131it [15:51:15, 290.14s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 132it [16:03:14, 418.76s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 133it [16:06:51, 358.27s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 134it [16:10:27, 315.57s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 135it [16:14:13, 288.56s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 136it [16:25:41, 408.57s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 137it [16:29:21, 351.84s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 138it [16:33:06, 314.01s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 139it [16:36:52, 287.51s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 140it [16:48:58, 419.02s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 141it [16:52:39, 359.49s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 142it [16:56:23, 319.10s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 143it [17:00:07, 290.41s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 144it [17:12:31, 426.42s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 145it [17:16:21, 367.56s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 146it [17:20:02, 323.68s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 147it [17:23:42, 292.45s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 148it [17:35:41, 420.62s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 149it [17:39:38, 365.44s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 150it [17:43:28, 324.76s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 151it [17:47:19, 296.69s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 152it [18:00:11, 439.22s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 153it [18:04:00, 376.29s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 154it [18:07:51, 332.52s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 155it [18:11:36, 300.44s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 156it [18:24:12, 436.98s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 157it [18:27:58, 373.69s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 158it [18:31:45, 329.76s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 159it [18:35:30, 298.21s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 160it [18:39:09, 274.44s/it]
[36m(WorkerDict pid=3968731)[0m INFO:2025-07-26 10:19:06,044:[Rank 6] Saved model to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_60/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=3964536)[0m INFO:2025-07-26 10:19:38,185:[Rank 0] Saved optim to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_60/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=3968729)[0m INFO:2025-07-26 10:19:06,556:[Rank 4] Saved model to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_60/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3964536)[0m INFO:2025-07-26 10:19:38,216:[Rank 0] Saved extra_state to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_60/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=3964536)[0m INFO:2025-07-26 10:19:38,604:[Rank 0] Saved model config and tokenizer class to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_60/actor/huggingface
[36m(TaskRunner pid=3962660)[0m Training Progress: 161it [18:53:58, 458.87s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 162it [18:57:42, 388.56s/it]
[36m(WorkerDict pid=3968727)[0m INFO:2025-07-26 10:19:40,743:[Rank 2] Saved optim to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_60/actor/optim_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3968727)[0m INFO:2025-07-26 10:19:40,748:[Rank 2] Saved extra_state to /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_60/actor/extra_state_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3962660)[0m Training Progress: 163it [19:01:25, 338.83s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 164it [19:05:06, 303.50s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 165it [19:08:49, 279.36s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 166it [19:21:20, 420.71s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 167it [19:25:06, 362.18s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 168it [19:28:57, 323.05s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 169it [19:32:43, 293.96s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 170it [19:36:33, 274.68s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 171it [19:48:53, 414.11s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 172it [19:52:25, 353.74s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 173it [19:56:11, 315.28s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 174it [19:59:50, 286.54s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 175it [20:03:33, 267.26s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 176it [20:15:43, 406.15s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 177it [20:19:31, 352.65s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 178it [20:23:05, 311.04s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 179it [20:26:42, 282.98s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 180it [20:30:17, 262.42s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 181it [20:42:39, 406.37s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 182it [20:46:15, 349.23s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 183it [20:49:50, 309.03s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 184it [20:53:26, 281.18s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 185it [20:57:10, 263.89s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 186it [21:09:31, 407.13s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 187it [21:13:03, 348.68s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 188it [21:16:44, 310.37s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 189it [21:20:18, 281.41s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 190it [21:23:56, 262.40s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 191it [21:36:02, 401.44s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 192it [21:39:44, 347.70s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 193it [21:43:33, 311.84s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 194it [21:47:09, 283.24s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 195it [21:50:49, 264.17s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 196it [22:02:41, 398.58s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 197it [22:06:18, 344.10s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 198it [22:10:05, 309.01s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 199it [22:13:42, 281.26s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 200it [22:17:25, 263.80s/it]
[36m(TaskRunner pid=3962660)[0m Training Progress: 200it [22:17:25, 401.23s/it]
[36m(TaskRunner pid=3962660)[0m TaskRunner hostname: p-phy-zy-daxing-kt-lc-a800-node-prod-15-172, PID: 3962660
[36m(TaskRunner pid=3962660)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'load_contents': ['model',
[36m(TaskRunner pid=3962660)[0m                                                                   'optimizer',
[36m(TaskRunner pid=3962660)[0m                                                                   'extra'],
[36m(TaskRunner pid=3962660)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=3962660)[0m                                                                   'optimizer',
[36m(TaskRunner pid=3962660)[0m                                                                   'extra']},
[36m(TaskRunner pid=3962660)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=3962660)[0m                                  'clip_ratio_c': 10.0,
[36m(TaskRunner pid=3962660)[0m                                  'clip_ratio_high': 0.28,
[36m(TaskRunner pid=3962660)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=3962660)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=3962660)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=3962660)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=3962660)[0m                                  'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3962660)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=3962660)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=3962660)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=3962660)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=3962660)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=3962660)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3962660)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=3962660)[0m                                  'kl_loss_coef': 0.0,
[36m(TaskRunner pid=3962660)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=3962660)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=3962660)[0m                                  'optim': {'lr': 1e-06,
[36m(TaskRunner pid=3962660)[0m                                            'lr_warmup_steps': 10,
[36m(TaskRunner pid=3962660)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=3962660)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=3962660)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=3962660)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=3962660)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=3962660)[0m                                            'weight_decay': 0.1},
[36m(TaskRunner pid=3962660)[0m                                  'policy_loss': {'clip_cov_lb': 1.0,
[36m(TaskRunner pid=3962660)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=3962660)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=3962660)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=3962660)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=3962660)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=3962660)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=3962660)[0m                                  'ppo_max_token_len_per_gpu': 5120,
[36m(TaskRunner pid=3962660)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=3962660)[0m                                  'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3962660)[0m                                  'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=3962660)[0m                                  'shuffle': False,
[36m(TaskRunner pid=3962660)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=3962660)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3962660)[0m                                  'use_dynamic_bsz': True,
[36m(TaskRunner pid=3962660)[0m                                  'use_kl_loss': False,
[36m(TaskRunner pid=3962660)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=3962660)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=3962660)[0m                        'model': {'custom_chat_template': None,
[36m(TaskRunner pid=3962660)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=3962660)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=3962660)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=3962660)[0m                                  'external_lib': None,
[36m(TaskRunner pid=3962660)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=3962660)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=3962660)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=3962660)[0m                                  'override_config': {},
[36m(TaskRunner pid=3962660)[0m                                  'path': '/workspace/models/Qwen/Qwen2.5-7B-Instruct-1M',
[36m(TaskRunner pid=3962660)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=3962660)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=3962660)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=3962660)[0m                                  'use_liger': False,
[36m(TaskRunner pid=3962660)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=3962660)[0m                                  'use_shm': False},
[36m(TaskRunner pid=3962660)[0m                        'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=3962660)[0m                                     'all_ranks': False,
[36m(TaskRunner pid=3962660)[0m                                     'discrete': False,
[36m(TaskRunner pid=3962660)[0m                                     'ranks': []},
[36m(TaskRunner pid=3962660)[0m                        'ref': {'entropy_checkpointing': False,
[36m(TaskRunner pid=3962660)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=3962660)[0m                                'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3962660)[0m                                                'param_offload': False,
[36m(TaskRunner pid=3962660)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=3962660)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3962660)[0m                                'log_prob_max_token_len_per_gpu': 5120,
[36m(TaskRunner pid=3962660)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=3962660)[0m                                'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3962660)[0m                                'log_prob_use_dynamic_bsz': True,
[36m(TaskRunner pid=3962660)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=3962660)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3962660)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=3962660)[0m                        'rollout': {'agent': {'agent_loop_config_path': None,
[36m(TaskRunner pid=3962660)[0m                                              'custom_async_server': {'name': None,
[36m(TaskRunner pid=3962660)[0m                                                                      'path': None},
[36m(TaskRunner pid=3962660)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=3962660)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=3962660)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=3962660)[0m                                    'do_sample': True,
[36m(TaskRunner pid=3962660)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=3962660)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=3962660)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=3962660)[0m                                    'engine_kwargs': {'sglang': {'attention_backend': None},
[36m(TaskRunner pid=3962660)[0m                                                      'vllm': {'disable_mm_preprocessor_cache': False,
[36m(TaskRunner pid=3962660)[0m                                                               'swap_space': None}},
[36m(TaskRunner pid=3962660)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=3962660)[0m                                    'gpu_memory_utilization': 0.85,
[36m(TaskRunner pid=3962660)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=3962660)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=3962660)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=3962660)[0m                                    'log_prob_max_token_len_per_gpu': 5120,
[36m(TaskRunner pid=3962660)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=3962660)[0m                                    'log_prob_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3962660)[0m                                    'log_prob_use_dynamic_bsz': True,
[36m(TaskRunner pid=3962660)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=3962660)[0m                                    'max_num_batched_tokens': 5120,
[36m(TaskRunner pid=3962660)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=3962660)[0m                                    'mode': 'sync',
[36m(TaskRunner pid=3962660)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=3962660)[0m                                    'multi_turn': {'completion_callback': None,
[36m(TaskRunner pid=3962660)[0m                                                   'enable': False,
[36m(TaskRunner pid=3962660)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=3962660)[0m                                                   'interaction_config_path': None,
[36m(TaskRunner pid=3962660)[0m                                                   'max_assistant_turns': None,
[36m(TaskRunner pid=3962660)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=3962660)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=3962660)[0m                                                   'max_user_turns': None,
[36m(TaskRunner pid=3962660)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=3962660)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=3962660)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=3962660)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=3962660)[0m                                    'n': 1,
[36m(TaskRunner pid=3962660)[0m                                    'n_layer1': 4,
[36m(TaskRunner pid=3962660)[0m                                    'n_layer2': 4,
[36m(TaskRunner pid=3962660)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=3962660)[0m                                    'prompt_length': 3072,
[36m(TaskRunner pid=3962660)[0m                                    'response_length': 2048,
[36m(TaskRunner pid=3962660)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=3962660)[0m                                    'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=3962660)[0m                                    'top_k': -1,
[36m(TaskRunner pid=3962660)[0m                                    'top_p': 1.0,
[36m(TaskRunner pid=3962660)[0m                                    'trace': {'backend': None,
[36m(TaskRunner pid=3962660)[0m                                              'token2text': False},
[36m(TaskRunner pid=3962660)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=3962660)[0m                                    'val_kwargs': {'do_sample': True,
[36m(TaskRunner pid=3962660)[0m                                                   'n': 1,
[36m(TaskRunner pid=3962660)[0m                                                   'temperature': 1.0,
[36m(TaskRunner pid=3962660)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=3962660)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=3962660)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=3962660)[0m                'adv_estimator': 'grpo',
[36m(TaskRunner pid=3962660)[0m                'filter_groups': {'_target_': 'verl.trainer.config.FilterGroupsConfig',
[36m(TaskRunner pid=3962660)[0m                                  'enable': True,
[36m(TaskRunner pid=3962660)[0m                                  'max_num_gen_batches': 10,
[36m(TaskRunner pid=3962660)[0m                                  'metric': 'seq_reward'},
[36m(TaskRunner pid=3962660)[0m                'gamma': 1.0,
[36m(TaskRunner pid=3962660)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=3962660)[0m                            'horizon': 10000,
[36m(TaskRunner pid=3962660)[0m                            'kl_coef': 0.0,
[36m(TaskRunner pid=3962660)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=3962660)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=3962660)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=3962660)[0m                'lam': 1.0,
[36m(TaskRunner pid=3962660)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=3962660)[0m                'pf_ppo': {'_target_': 'verl.trainer.config.PFPPOConfig',
[36m(TaskRunner pid=3962660)[0m                           'reweight_method': 'pow',
[36m(TaskRunner pid=3962660)[0m                           'weight_pow': 2.0},
[36m(TaskRunner pid=3962660)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=3962660)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=3962660)[0m  'critic': {'_target_': 'verl.trainer.config.FSDPCriticConfig',
[36m(TaskRunner pid=3962660)[0m             'checkpoint': {'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=3962660)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=3962660)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=3962660)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3962660)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=3962660)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3962660)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=3962660)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=3962660)[0m             'model': {'enable_activation_offload': False,
[36m(TaskRunner pid=3962660)[0m                       'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=3962660)[0m                       'external_lib': None,
[36m(TaskRunner pid=3962660)[0m                       'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3962660)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=3962660)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=3962660)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=3962660)[0m                                       'param_offload': False,
[36m(TaskRunner pid=3962660)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=3962660)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3962660)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=3962660)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=3962660)[0m                       'override_config': {},
[36m(TaskRunner pid=3962660)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=3962660)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=3962660)[0m                       'tokenizer_path': '/workspace/models/Qwen/Qwen2.5-7B-Instruct-1M',
[36m(TaskRunner pid=3962660)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=3962660)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=3962660)[0m                       'use_shm': False},
[36m(TaskRunner pid=3962660)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=3962660)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=3962660)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=3962660)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=3962660)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=3962660)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=3962660)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=3962660)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3962660)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=3962660)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3962660)[0m             'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=3962660)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=3962660)[0m                          'all_ranks': False,
[36m(TaskRunner pid=3962660)[0m                          'discrete': False,
[36m(TaskRunner pid=3962660)[0m                          'ranks': []},
[36m(TaskRunner pid=3962660)[0m             'rollout_n': 1,
[36m(TaskRunner pid=3962660)[0m             'shuffle': False,
[36m(TaskRunner pid=3962660)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=3962660)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3962660)[0m             'use_dynamic_bsz': True},
[36m(TaskRunner pid=3962660)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=3962660)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=3962660)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=3962660)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=3962660)[0m           'filter_overlong_prompts': False,
[36m(TaskRunner pid=3962660)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=3962660)[0m           'gen_batch_size': 1536,
[36m(TaskRunner pid=3962660)[0m           'image_key': 'images',
[36m(TaskRunner pid=3962660)[0m           'max_prompt_length': 3072,
[36m(TaskRunner pid=3962660)[0m           'max_response_length': 2048,
[36m(TaskRunner pid=3962660)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=3962660)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=3962660)[0m           'return_multi_modal_inputs': True,
[36m(TaskRunner pid=3962660)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=3962660)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=3962660)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=3962660)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=3962660)[0m           'shuffle': True,
[36m(TaskRunner pid=3962660)[0m           'tokenizer': None,
[36m(TaskRunner pid=3962660)[0m           'train_batch_size': 512,
[36m(TaskRunner pid=3962660)[0m           'train_files': '/workspace/data/math/train.parquet',
[36m(TaskRunner pid=3962660)[0m           'truncation': 'left',
[36m(TaskRunner pid=3962660)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=3962660)[0m           'use_shm': False,
[36m(TaskRunner pid=3962660)[0m           'val_batch_size': None,
[36m(TaskRunner pid=3962660)[0m           'val_files': '/workspace/data/math/test.parquet',
[36m(TaskRunner pid=3962660)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=3962660)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=3962660)[0m  'ray_init': {'num_cpus': None, 'timeline_json_file': None},
[36m(TaskRunner pid=3962660)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=3962660)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3962660)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=3962660)[0m                   'max_length': None,
[36m(TaskRunner pid=3962660)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=3962660)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3962660)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=3962660)[0m                             'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3962660)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=3962660)[0m                                             'param_offload': False,
[36m(TaskRunner pid=3962660)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=3962660)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3962660)[0m                             'input_tokenizer': '/workspace/models/Qwen/Qwen2.5-7B-Instruct-1M',
[36m(TaskRunner pid=3962660)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=3962660)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=3962660)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=3962660)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=3962660)[0m                             'use_shm': False},
[36m(TaskRunner pid=3962660)[0m                   'overlong_buffer': {'enable': True,
[36m(TaskRunner pid=3962660)[0m                                       'len': 512,
[36m(TaskRunner pid=3962660)[0m                                       'log': False,
[36m(TaskRunner pid=3962660)[0m                                       'penalty_factor': 1.0},
[36m(TaskRunner pid=3962660)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=3962660)[0m                                'all_ranks': False,
[36m(TaskRunner pid=3962660)[0m                                'discrete': False,
[36m(TaskRunner pid=3962660)[0m                                'ranks': []},
[36m(TaskRunner pid=3962660)[0m                   'reward_manager': 'dapo',
[36m(TaskRunner pid=3962660)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=3962660)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=3962660)[0m                                      'url': None},
[36m(TaskRunner pid=3962660)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=3962660)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3962660)[0m                   'use_dynamic_bsz': True},
[36m(TaskRunner pid=3962660)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=3962660)[0m              'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=3962660)[0m                                            'cuda-memory-usage': 'true',
[36m(TaskRunner pid=3962660)[0m                                            'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=3962660)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=3962660)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=3962660)[0m              'default_local_dir': '/workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724',
[36m(TaskRunner pid=3962660)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=3962660)[0m              'device': 'cuda',
[36m(TaskRunner pid=3962660)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=3962660)[0m              'experiment_name': 'DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724',
[36m(TaskRunner pid=3962660)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=3962660)[0m              'logger': ['console', 'tensorboard'],
[36m(TaskRunner pid=3962660)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=3962660)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=3962660)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=3962660)[0m              'nnodes': 1,
[36m(TaskRunner pid=3962660)[0m              'npu_profile': {'options': {'analysis': True,
[36m(TaskRunner pid=3962660)[0m                                          'level': 'level1',
[36m(TaskRunner pid=3962660)[0m                                          'record_shapes': False,
[36m(TaskRunner pid=3962660)[0m                                          'save_path': './profiler_data',
[36m(TaskRunner pid=3962660)[0m                                          'with_cpu': True,
[36m(TaskRunner pid=3962660)[0m                                          'with_memory': False,
[36m(TaskRunner pid=3962660)[0m                                          'with_module': False,
[36m(TaskRunner pid=3962660)[0m                                          'with_npu': True,
[36m(TaskRunner pid=3962660)[0m                                          'with_stack': False}},
[36m(TaskRunner pid=3962660)[0m              'profile_steps': None,
[36m(TaskRunner pid=3962660)[0m              'project_name': 'my_DAPO',
[36m(TaskRunner pid=3962660)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=3962660)[0m              'resume_from_path': None,
[36m(TaskRunner pid=3962660)[0m              'resume_mode': 'disable',
[36m(TaskRunner pid=3962660)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=3962660)[0m              'save_freq': 20,
[36m(TaskRunner pid=3962660)[0m              'test_freq': 10,
[36m(TaskRunner pid=3962660)[0m              'total_epochs': 50,
[36m(TaskRunner pid=3962660)[0m              'total_training_steps': 100,
[36m(TaskRunner pid=3962660)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=3962660)[0m              'val_before_train': True,
[36m(TaskRunner pid=3962660)[0m              'val_only': False,
[36m(TaskRunner pid=3962660)[0m              'validation_data_dir': None,
[36m(TaskRunner pid=3962660)[0m              'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=3962660)[0m                                        'capture-range-end': None,
[36m(TaskRunner pid=3962660)[0m                                        'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=3962660)[0m                                        'cuda-memory-usage': 'true',
[36m(TaskRunner pid=3962660)[0m                                        'kill': 'none',
[36m(TaskRunner pid=3962660)[0m                                        'trace': 'cuda,nvtx,cublas,ucx'}}}
[36m(TaskRunner pid=3962660)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=3962660)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=3962660)[0m dataset len: 7500
[36m(TaskRunner pid=3962660)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=3962660)[0m dataset len: 5000
[36m(TaskRunner pid=3962660)[0m Size of train dataloader: 4, Size of val dataloader: 1
[36m(TaskRunner pid=3962660)[0m Total training steps: 100
[36m(TaskRunner pid=3962660)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(WorkerDict pid=3964536)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=3964536)[0m   "architectures": [
[36m(WorkerDict pid=3964536)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=3964536)[0m   ],
[36m(WorkerDict pid=3964536)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=3964536)[0m   "dual_chunk_attention_config": {
[36m(WorkerDict pid=3964536)[0m     "chunk_size": 262144,
[36m(WorkerDict pid=3964536)[0m     "local_size": 8192,
[36m(WorkerDict pid=3964536)[0m     "original_max_position_embeddings": 262144
[36m(WorkerDict pid=3964536)[0m   },
[36m(WorkerDict pid=3964536)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=3964536)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=3964536)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=3964536)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=3964536)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=3964536)[0m   "layer_types": [
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention",
[36m(WorkerDict pid=3964536)[0m     "full_attention"
[36m(WorkerDict pid=3964536)[0m   ],
[36m(WorkerDict pid=3964536)[0m   "max_position_embeddings": 1010000,
[36m(WorkerDict pid=3964536)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=3964536)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=3964536)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=3964536)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=3964536)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=3964536)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=3964536)[0m   "rms_norm_eps": 1e-05,
[36m(WorkerDict pid=3964536)[0m   "rope_scaling": null,
[36m(WorkerDict pid=3964536)[0m   "rope_theta": 10000000.0,
[36m(WorkerDict pid=3964536)[0m   "sliding_window": null,
[36m(WorkerDict pid=3964536)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=3964536)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=3964536)[0m   "transformers_version": "4.53.0",
[36m(WorkerDict pid=3964536)[0m   "use_cache": true,
[36m(WorkerDict pid=3964536)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=3964536)[0m   "vocab_size": 152064
[36m(WorkerDict pid=3964536)[0m }
[36m(WorkerDict pid=3964536)[0m 
[36m(WorkerDict pid=3964536)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=3964536)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=3964536)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=3964536)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f55b55b6f80>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f55b55b6e60>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=3964536)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=3964536)[0m Total steps: 100, num_warmup_steps: 10
[36m(WorkerDict pid=3964536)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=3964536)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=3968730)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3968730)[0m Skipping monkey patch for Qwen2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3964536)[0m WARNING 07-25 15:23:57 [cuda.py:93] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=3964536)[0m WARNING 07-25 15:23:57 [utils.py:2522] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f5465fe0070>
[36m(WorkerDict pid=3968727)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 2048, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1.0, 'ignore_eos': False}
[36m(WorkerDict pid=3968730)[0m WARNING 07-25 15:23:57 [cuda.py:93] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3968732)[0m WARNING 07-25 15:23:57 [utils.py:2522] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f38a003b790>[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3962660)[0m Saving tensorboard log to /workspace/log/tensorboard/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724.
[36m(TaskRunner pid=3962660)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 0}
[36m(WorkerDict pid=3968729)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 2048, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1.0, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3962660)[0m validation generation end
[36m(TaskRunner pid=3962660)[0m [prompt] system
[36m(TaskRunner pid=3962660)[0m You are a helpful assistant.
[36m(TaskRunner pid=3962660)[0m user
[36m(TaskRunner pid=3962660)[0m How many vertical asymptotes does the graph of $y=\frac{2}{x^2+x-6}$ have? Let's think step by step and output the final answer within \boxed{}.
[36m(TaskRunner pid=3962660)[0m assistant
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m [response] To determine the number of vertical asymptotes for the function \( y = \frac{2}{x^2 + x - 6} \), we need to identify the values of \( x \) that make the denominator zero. Vertical asymptotes occur where the function is undefined due to division by zero.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Step 1: Factor the denominator.
[36m(TaskRunner pid=3962660)[0m The denominator of the function is \( x^2 + x - 6 \). To factor this quadratic expression, we look for two numbers that multiply to \(-6\) and add up to \(1\). These numbers are \(3\) and \(-2\).
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Thus, we can factor the quadratic as:
[36m(TaskRunner pid=3962660)[0m \[
[36m(TaskRunner pid=3962660)[0m x^2 + x - 6 = (x + 3)(x - 2)
[36m(TaskRunner pid=3962660)[0m \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Step 2: Set the denominator equal to zero.
[36m(TaskRunner pid=3962660)[0m The function becomes:
[36m(TaskRunner pid=3962660)[0m \[
[36m(TaskRunner pid=3962660)[0m y = \frac{2}{(x + 3)(x - 2)}
[36m(TaskRunner pid=3962660)[0m \]
[36m(TaskRunner pid=3962660)[0m To find the values of \( x \) that make the function undefined, we set the denominator equal to zero:
[36m(TaskRunner pid=3962660)[0m \[
[36m(TaskRunner pid=3962660)[0m (x + 3)(x - 2) = 0
[36m(TaskRunner pid=3962660)[0m \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Step 3: Solve for \( x \).
[36m(TaskRunner pid=3962660)[0m We solve the equation using the zero product property:
[36m(TaskRunner pid=3962660)[0m \[
[36m(TaskRunner pid=3962660)[0m x + 3 = 0 \quad \text{or} \quad x - 2 = 0
[36m(TaskRunner pid=3962660)[0m \]
[36m(TaskRunner pid=3962660)[0m \[
[36m(TaskRunner pid=3962660)[0m x = -3 \quad \text{or} \quad x = 2
[36m(TaskRunner pid=3962660)[0m \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Step 4: Verify that these values are within the domain of the function.
[36m(TaskRunner pid=3962660)[0m The values \( x = -3 \) and \( x = 2 \) make the denominator zero, which causes the function to be undefined at these points. Therefore, these are the locations of the vertical asymptotes.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Step 5: Count the number of vertical asymptotes.
[36m(TaskRunner pid=3962660)[0m Since we found two distinct values (\(x = -3\) and \(x = 2\)) that make the denominator zero, there are two vertical asymptotes.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Thus, the graph of \( y = \frac{2}{x^2 + x - 6} \) has \(\boxed{2}\) vertical asymptotes.
[36m(TaskRunner pid=3962660)[0m [ground_truth] 2
[36m(TaskRunner pid=3962660)[0m [score] 1.0
[36m(TaskRunner pid=3962660)[0m len reward_extra_infos_dict['reward']: 5000
[36m(TaskRunner pid=3962660)[0m len reward_extra_infos_dict['acc']: 5000
[36m(TaskRunner pid=3962660)[0m ('Initial validation metrics: '
[36m(TaskRunner pid=3962660)[0m  "{'val-aux/DigitalLearningGmbH/MATH-lighteval/reward/mean@1': 0.664378125, "
[36m(TaskRunner pid=3962660)[0m  "'val-core/DigitalLearningGmbH/MATH-lighteval/acc/mean@1': 0.6702}")
[36m(TaskRunner pid=3962660)[0m step:0 - val-aux/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:0.664378125 - val-core/DigitalLearningGmbH/MATH-lighteval/acc/mean@1:0.6702
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.365234375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5051247771836007
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6801 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.3216145833333333
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5232793522267206
[36m(TaskRunner pid=3962660)[0m step:1 - train/true_reward_mean:0.7259885668754578 - train/kept_rate_layer1:0.3216145833333333 - train/kept_rate_layer2:0.5232793522267206 - global_seqlen/min:741177 - global_seqlen/max:885472 - global_seqlen/minmax_diff:144295 - global_seqlen/balanced_min:817878 - global_seqlen/balanced_max:817879 - global_seqlen/mean:817878.875 - actor/entropy:0.11034905910491943 - actor/pg_loss:0.009289585067412025 - actor/pg_clipfrac:0.00014049201795109074 - actor/ppo_kl:-7.594388082830348e-07 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0854311475995928 - perf/mfu/actor:0.27241561681886794 - perf/max_memory_allocated_gb:81.3558177947998 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:224.74185943603516 - actor/lr:0.0 - critic/score/mean:0.4913679361343384 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.4913679361343384 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.04773198068141937 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.04773198068141937 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:432.6981201171875 - response_length/max:2048.0 - response_length/min:36.0 - response_length/clip_ratio:0.0078125 - prompt_length/mean:366.01171875 - prompt_length/max:1318.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.471310138702393e-06 - timing_s/generate_sequences:74.93289184570312 - timing_s/reshard:2.513160228729248 - timing_s/gen:311.8589083496481 - timing_s/reward filter:9.42303424142301 - timing_s/gen_layer2:181.8469954682514 - timing_s/process_data:196.0630041854456 - timing_s/reward:13.026384451426566 - timing_s/step:1051.038875637576 - timing_s/old_log_prob:73.8395567825064 - timing_s/adv:0.2958592241629958 - timing_s/update_actor:452.35510666295886 - timing_s/stop_profile:1.12876296043396e-06 - timing_per_token_ms/update_actor:0.06913540630679556 - timing_per_token_ms/adv:4.5217457194226316e-05 - timing_per_token_ms/gen:0.08797984698394407 - perf/total_num_tokens:6543031 - perf/time_per_step:1051.038875637576 - perf/throughput:778.1623439036566 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.3776041666666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5249281609195402
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7307 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.3873697916666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5387955182072829
[36m(TaskRunner pid=3962660)[0m step:2 - train/true_reward_mean:0.6741068959236145 - train/kept_rate_layer1:0.3873697916666667 - train/kept_rate_layer2:0.5387955182072829 - global_seqlen/min:742395 - global_seqlen/max:929088 - global_seqlen/minmax_diff:186693 - global_seqlen/balanced_min:806792 - global_seqlen/balanced_max:806793 - global_seqlen/mean:806792.375 - actor/entropy:0.11119821667671204 - actor/pg_loss:-0.023983762065813676 - actor/pg_clipfrac:0.00032634459267016664 - actor/ppo_kl:-6.983221784984183e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1071925058495253 - perf/mfu/actor:0.2776387573994119 - perf/max_memory_allocated_gb:81.60755825042725 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:226.68318557739258 - actor/lr:1e-07 - critic/score/mean:0.5124174952507019 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5124174952507019 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.0442284494638443 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.0442284494638443 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:416.3055419921875 - response_length/max:2048.0 - response_length/min:6.0 - response_length/clip_ratio:0.0062255859375 - prompt_length/mean:371.57763671875 - prompt_length/max:1266.0 - prompt_length/min:45.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.7676807045936584e-06 - timing_s/generate_sequences:94.349609375 - timing_s/reshard:3.5604970455169678 - timing_s/gen:334.72972101159394 - timing_s/reward filter:9.575274563394487 - timing_s/gen_layer2:222.42182927764952 - timing_s/process_data:237.47349243052304 - timing_s/reward:13.729268750175834 - timing_s/step:1098.9187606396154 - timing_s/old_log_prob:71.15029449667782 - timing_s/adv:0.27471690624952316 - timing_s/update_actor:437.5200320482254 - timing_s/stop_profile:1.0346993803977966e-06 - timing_per_token_ms/update_actor:0.06778696192564806 - timing_per_token_ms/adv:4.256313562853193e-05 - timing_per_token_ms/gen:0.09815041484047764 - perf/total_num_tokens:6454339 - perf/time_per_step:1098.9187606396154 - perf/throughput:734.169261547973 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.3684895833333333
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.536660777385159
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7290 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.369140625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.536522633744856
[36m(TaskRunner pid=3962660)[0m step:3 - train/true_reward_mean:0.7027433514595032 - train/kept_rate_layer1:0.369140625 - train/kept_rate_layer2:0.536522633744856 - global_seqlen/min:730063 - global_seqlen/max:882509 - global_seqlen/minmax_diff:152446 - global_seqlen/balanced_min:820252 - global_seqlen/balanced_max:820253 - global_seqlen/mean:820252.375 - actor/entropy:0.10834913700819016 - actor/pg_loss:0.023733400867612504 - actor/pg_clipfrac:0.000620154033887631 - actor/ppo_kl:8.66975709536135e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.104211530648172 - perf/mfu/actor:0.2826847688814645 - perf/max_memory_allocated_gb:82.06248235702515 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:233.98649978637695 - actor/lr:2e-07 - critic/score/mean:0.5006527304649353 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5006527304649353 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.05105063319206238 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.05105063319206238 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:422.702392578125 - response_length/max:2048.0 - response_length/min:27.0 - response_length/clip_ratio:0.00634765625 - prompt_length/mean:378.3253173828125 - prompt_length/max:1137.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.034419983625412e-05 - timing_s/generate_sequences:90.24185943603516 - timing_s/reshard:2.7355782985687256 - timing_s/gen:319.2507573515177 - timing_s/reward filter:10.053469807840884 - timing_s/gen_layer2:203.95231118053198 - timing_s/process_data:219.6805759863928 - timing_s/reward:13.624648170545697 - timing_s/step:1066.0068462975323 - timing_s/old_log_prob:72.07564834970981 - timing_s/adv:0.2848645718768239 - timing_s/update_actor:437.14373750332743 - timing_s/stop_profile:1.1976808309555054e-06 - timing_per_token_ms/update_actor:0.06661726177618922 - timing_per_token_ms/adv:4.341111659030916e-05 - timing_per_token_ms/gen:0.09219498256934683 - perf/total_num_tokens:6562019 - perf/time_per_step:1066.0068462975323 - perf/throughput:769.4625769514618 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.35546875
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5254884004884005
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6886 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.3463541666666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5325031328320802
[36m(TaskRunner pid=3962660)[0m step:4 - train/true_reward_mean:0.7007167935371399 - train/kept_rate_layer1:0.3463541666666667 - train/kept_rate_layer2:0.5325031328320802 - global_seqlen/min:715735 - global_seqlen/max:878324 - global_seqlen/minmax_diff:162589 - global_seqlen/balanced_min:807434 - global_seqlen/balanced_max:807435 - global_seqlen/mean:807434.5 - actor/entropy:0.11047574877738953 - actor/pg_loss:-0.006663936087206181 - actor/pg_clipfrac:0.000914113276537038 - actor/ppo_kl:9.585132209026876e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1153436379972845 - perf/mfu/actor:0.2716681385940242 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:233.8852653503418 - actor/lr:3e-07 - critic/score/mean:0.5037041902542114 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5037041902542114 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.0379968136548996 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.788851022720337 - critic/returns/mean:-0.0379968136548996 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.788851022720337 - response_length/mean:419.820068359375 - response_length/max:2048.0 - response_length/min:32.0 - response_length/clip_ratio:0.007080078125 - prompt_length/mean:368.690185546875 - prompt_length/max:1324.0 - prompt_length/min:43.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.18539410829544e-06 - timing_s/generate_sequences:80.26737213134766 - timing_s/reshard:4.102043151855469 - timing_s/gen:320.6250768555328 - timing_s/reward filter:10.197100509889424 - timing_s/gen_layer2:189.55742410942912 - timing_s/process_data:205.09894726984203 - timing_s/reward:12.869613914750516 - timing_s/step:1061.2767187096179 - timing_s/old_log_prob:70.86421993374825 - timing_s/adv:0.293054754845798 - timing_s/update_actor:447.56354722194374 - timing_s/stop_profile:1.0998919606208801e-06 - timing_per_token_ms/update_actor:0.06928790310885027 - timing_per_token_ms/adv:4.5368193154645676e-05 - timing_per_token_ms/gen:0.09322756646685064 - perf/total_num_tokens:6459476 - perf/time_per_step:1061.2767187096179 - perf/throughput:760.8142963710173 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.361328125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5191441441441441
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6915 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.359375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5279287439613527
[36m(TaskRunner pid=3962660)[0m step:5 - train/true_reward_mean:0.7110126614570618 - train/kept_rate_layer1:0.359375 - train/kept_rate_layer2:0.5279287439613527 - global_seqlen/min:763757 - global_seqlen/max:826174 - global_seqlen/minmax_diff:62417 - global_seqlen/balanced_min:801301 - global_seqlen/balanced_max:801302 - global_seqlen/mean:801301.875 - actor/entropy:0.11089801788330078 - actor/pg_loss:0.0037261005955228923 - actor/pg_clipfrac:0.0021579037934528647 - actor/ppo_kl:0.0004658531435398797 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1013213607948273 - perf/mfu/actor:0.2810125190767867 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:233.36432266235352 - actor/lr:4e-07 - critic/score/mean:0.5118221044540405 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5118221044540405 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.032670821994543076 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.032670821994543076 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:412.5238037109375 - response_length/max:2048.0 - response_length/min:29.0 - response_length/clip_ratio:0.0037841796875 - prompt_length/mean:369.99755859375 - prompt_length/max:1419.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.725320756435394e-06 - timing_s/generate_sequences:87.42233276367188 - timing_s/reshard:2.8280727863311768 - timing_s/gen:326.36431877315044 - timing_s/reward filter:9.6870051715523 - timing_s/gen_layer2:195.33801924996078 - timing_s/process_data:209.91792554222047 - timing_s/reward:13.268061974085867 - timing_s/step:1053.0200215857476 - timing_s/old_log_prob:70.23162010498345 - timing_s/adv:0.292830272577703 - timing_s/update_actor:429.2072073854506 - timing_s/stop_profile:1.4295801520347595e-06 - timing_per_token_ms/update_actor:0.06695466789364661 - timing_per_token_ms/adv:4.568039238921396e-05 - timing_per_token_ms/gen:0.09657477707493514 - perf/total_num_tokens:6410415 - perf/time_per_step:1053.0200215857476 - perf/throughput:760.9559728914896 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.3502604166666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5280359355638166
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6818 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.333984375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5232293697205977
[36m(TaskRunner pid=3962660)[0m step:6 - train/true_reward_mean:0.7157928347587585 - train/kept_rate_layer1:0.333984375 - train/kept_rate_layer2:0.5232293697205977 - global_seqlen/min:768551 - global_seqlen/max:872012 - global_seqlen/minmax_diff:103461 - global_seqlen/balanced_min:826944 - global_seqlen/balanced_max:826945 - global_seqlen/mean:826944.25 - actor/entropy:0.11617571115493774 - actor/pg_loss:0.008509882180677617 - actor/pg_clipfrac:0.003124452907307868 - actor/ppo_kl:0.0004885793177921267 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0952186903450638 - perf/mfu/actor:0.27776476916481624 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:232.92287063598633 - actor/lr:5e-07 - critic/score/mean:0.5232283473014832 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5232283473014832 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.032534901052713394 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.032534901052713394 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:427.569580078125 - response_length/max:2048.0 - response_length/min:20.0 - response_length/clip_ratio:0.0042724609375 - prompt_length/mean:379.9931640625 - prompt_length/max:1182.0 - prompt_length/min:43.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.3299590945243835e-06 - timing_s/generate_sequences:78.4728775024414 - timing_s/reshard:2.882625102996826 - timing_s/gen:318.38632888067514 - timing_s/reward filter:10.718871876597404 - timing_s/gen_layer2:181.93571186996996 - timing_s/process_data:197.49949150718749 - timing_s/reward:12.428616411052644 - timing_s/step:1053.413263803348 - timing_s/old_log_prob:72.85926080867648 - timing_s/adv:0.24850436486303806 - timing_s/update_actor:448.3184210713953 - timing_s/stop_profile:1.1958181858062744e-06 - timing_per_token_ms/update_actor:0.06776732849152094 - timing_per_token_ms/adv:3.756365148905716e-05 - timing_per_token_ms/gen:0.09089869923648528 - perf/total_num_tokens:6615554 - perf/time_per_step:1053.413263803348 - perf/throughput:785.0140855587088 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.3483072916666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5289719626168224
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6792 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.353515625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5269337016574586
[36m(TaskRunner pid=3962660)[0m step:7 - train/true_reward_mean:0.7206791043281555 - train/kept_rate_layer1:0.353515625 - train/kept_rate_layer2:0.5269337016574586 - global_seqlen/min:774060 - global_seqlen/max:887467 - global_seqlen/minmax_diff:113407 - global_seqlen/balanced_min:837742 - global_seqlen/balanced_max:837743 - global_seqlen/mean:837742.375 - actor/entropy:0.11492421478033066 - actor/pg_loss:0.0205875413725569 - actor/pg_clipfrac:0.005120609850389182 - actor/ppo_kl:0.0014516004611575325 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0689109617378563 - perf/mfu/actor:0.28649277308213483 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:233.08838653564453 - actor/lr:6e-07 - critic/score/mean:0.5136116147041321 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5136116147041321 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.03518320247530937 - critic/advantages/max:1.7888524532318115 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.03518320247530937 - critic/returns/max:1.7888524532318115 - critic/returns/min:-1.7888524532318115 - response_length/mean:433.003173828125 - response_length/max:2048.0 - response_length/min:7.0 - response_length/clip_ratio:0.006103515625 - prompt_length/mean:385.1046142578125 - prompt_length/max:1245.0 - prompt_length/min:41.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.7004154920578e-06 - timing_s/generate_sequences:86.58473205566406 - timing_s/reshard:2.650313377380371 - timing_s/gen:328.3936235392466 - timing_s/reward filter:10.224594617262483 - timing_s/gen_layer2:194.4177698008716 - timing_s/process_data:209.86753639113158 - timing_s/reward:12.902712428011 - timing_s/step:1069.1414061747491 - timing_s/old_log_prob:73.5524128228426 - timing_s/adv:0.27039426006376743 - timing_s/update_actor:440.45999609772116 - timing_s/stop_profile:1.0654330253601074e-06 - timing_per_token_ms/update_actor:0.0657212779909995 - timing_per_token_ms/adv:4.034567608922842e-05 - timing_per_token_ms/gen:0.09257925731591808 - perf/total_num_tokens:6701939 - perf/time_per_step:1069.1414061747491 - perf/throughput:783.5655509754644 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.333984375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5425601039636128
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6680 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.33984375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.50279374201788
[36m(TaskRunner pid=3962660)[0m step:8 - train/true_reward_mean:0.7409397959709167 - train/kept_rate_layer1:0.33984375 - train/kept_rate_layer2:0.50279374201788 - global_seqlen/min:741951 - global_seqlen/max:892733 - global_seqlen/minmax_diff:150782 - global_seqlen/balanced_min:824318 - global_seqlen/balanced_max:824319 - global_seqlen/mean:824318.25 - actor/entropy:0.11756861954927444 - actor/pg_loss:0.016667489951088632 - actor/pg_clipfrac:0.006407827565984533 - actor/ppo_kl:0.0018471901234708714 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1056084220763296 - perf/mfu/actor:0.2791096140936539 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:232.91059494018555 - actor/lr:7e-07 - critic/score/mean:0.5184808969497681 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5184808969497681 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.03632421791553497 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.03632421791553497 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:422.2769775390625 - response_length/max:2048.0 - response_length/min:18.0 - response_length/clip_ratio:0.0029296875 - prompt_length/mean:382.7213134765625 - prompt_length/max:1351.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.769543349742889e-06 - timing_s/generate_sequences:78.6225357055664 - timing_s/reshard:2.6649985313415527 - timing_s/gen:327.2012197105214 - timing_s/reward filter:10.018105898052454 - timing_s/gen_layer2:179.56446691136807 - timing_s/process_data:194.38462988380343 - timing_s/reward:12.472750655375421 - timing_s/step:1055.00507971365 - timing_s/old_log_prob:72.23761690128595 - timing_s/adv:0.2643040120601654 - timing_s/update_actor:444.837590594776 - timing_s/stop_profile:1.1939555406570435e-06 - timing_per_token_ms/update_actor:0.06745537760973629 - timing_per_token_ms/adv:4.007918241227909e-05 - timing_per_token_ms/gen:0.09458615379226952 - perf/total_num_tokens:6594546 - perf/time_per_step:1055.00507971365 - perf/throughput:781.3405507239233 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.318359375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5179788684389911
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6079 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.30859375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5069444444444444
[36m(TaskRunner pid=3962660)[0m step:9 - train/true_reward_mean:0.7635622024536133 - train/kept_rate_layer1:0.30859375 - train/kept_rate_layer2:0.5069444444444444 - global_seqlen/min:791685 - global_seqlen/max:912021 - global_seqlen/minmax_diff:120336 - global_seqlen/balanced_min:828395 - global_seqlen/balanced_max:828396 - global_seqlen/mean:828395.125 - actor/entropy:0.11793133616447449 - actor/pg_loss:0.062176185787566715 - actor/pg_clipfrac:0.008093088065964236 - actor/ppo_kl:0.002140425915830032 - actor/pg_clipfrac_lower:3.918489147465498e-06 - actor/grad_norm:1.0974552375264466 - perf/mfu/actor:0.28044787077651384 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:232.36854934692383 - actor/lr:8e-07 - critic/score/mean:0.5330231189727783 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5330231189727783 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.033839140087366104 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888513803482056 - critic/returns/mean:-0.033839140087366104 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888513803482056 - response_length/mean:426.8880615234375 - response_length/max:2048.0 - response_length/min:15.0 - response_length/clip_ratio:0.0030517578125 - prompt_length/mean:382.091552734375 - prompt_length/max:1888.0 - prompt_length/min:45.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.184462785720825e-06 - timing_s/generate_sequences:71.8863296508789 - timing_s/reshard:2.9482719898223877 - timing_s/gen:322.17178732994944 - timing_s/reward filter:9.602301826700568 - timing_s/gen_layer2:170.10180830117315 - timing_s/process_data:184.3560246443376 - timing_s/reward:11.984080746769905 - timing_s/step:1039.4696067096666 - timing_s/old_log_prob:72.46910402085632 - timing_s/adv:0.2538935160264373 - timing_s/update_actor:444.9236555900425 - timing_s/stop_profile:1.1958181858062744e-06 - timing_per_token_ms/update_actor:0.06713638850633664 - timing_per_token_ms/adv:3.831105295713161e-05 - timing_per_token_ms/gen:0.0921262839201964 - perf/total_num_tokens:6627161 - perf/time_per_step:1039.4696067096666 - perf/throughput:796.9402084032058 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.3313802083333333
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5332351015062213
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6514 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.3216145833333333
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5234480431848852
[36m(TaskRunner pid=3962660)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 10}
[36m(TaskRunner pid=3962660)[0m validation generation end
[36m(TaskRunner pid=3962660)[0m [prompt] system
[36m(TaskRunner pid=3962660)[0m You are a helpful assistant.
[36m(TaskRunner pid=3962660)[0m user
[36m(TaskRunner pid=3962660)[0m How many vertical asymptotes does the graph of $y=\frac{2}{x^2+x-6}$ have? Let's think step by step and output the final answer within \boxed{}.
[36m(TaskRunner pid=3962660)[0m assistant
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m [response] To determine the number of vertical asymptotes of the function \( y = \frac{2}{x^2 + x - 6} \), we need to find the values of \( x \) that make the denominator zero, as these values will be the locations of the vertical asymptotes.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m First, we factor the denominator:
[36m(TaskRunner pid=3962660)[0m \[ x^2 + x - 6 = (x + 3)(x - 2). \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m So, we set the denominator equal to zero to find the values of \( x \) that make the denominator zero:
[36m(TaskRunner pid=3962660)[0m \[ (x + 3)(x - 2) = 0. \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m This equation has two solutions:
[36m(TaskRunner pid=3962660)[0m \[ x + 3 = 0 \implies x = -3, \]
[36m(TaskRunner pid=3962660)[0m \[ x - 2 = 0 \implies x = 2. \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Therefore, the denominator \( x^2 + x - 6 \) is zero at \( x = -3 \) and \( x = 2 \). These are the values where the vertical asymptotes occur, provided they do not also make the numerator zero.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m The numerator of the function is \( 2 \), which is a constant and never zero. Therefore, \( x = -3 \) and \( x = 2 \) are indeed vertical asymptotes.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Thus, the function \( y = \frac{2}{x^2 + x - 6} \) has two vertical asymptotes.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m The final answer is:
[36m(TaskRunner pid=3962660)[0m \[
[36m(TaskRunner pid=3962660)[0m \boxed{2}
[36m(TaskRunner pid=3962660)[0m \]
[36m(TaskRunner pid=3962660)[0m [ground_truth] 2
[36m(TaskRunner pid=3962660)[0m [score] 1.0
[36m(TaskRunner pid=3962660)[0m len reward_extra_infos_dict['reward']: 5000
[36m(TaskRunner pid=3962660)[0m len reward_extra_infos_dict['acc']: 5000
[36m(TaskRunner pid=3962660)[0m step:10 - train/true_reward_mean:0.7278844714164734 - train/kept_rate_layer1:0.3216145833333333 - train/kept_rate_layer2:0.5234480431848852 - global_seqlen/min:796682 - global_seqlen/max:896269 - global_seqlen/minmax_diff:99587 - global_seqlen/balanced_min:834207 - global_seqlen/balanced_max:834208 - global_seqlen/mean:834207.125 - actor/entropy:0.12012985348701477 - actor/pg_loss:0.010906872814335987 - actor/pg_clipfrac:0.009697377414506098 - actor/ppo_kl:0.003305586665664757 - actor/pg_clipfrac_lower:4.007736093957316e-06 - actor/grad_norm:1.0740253352560103 - perf/mfu/actor:0.2881596173047373 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:232.8938331604004 - actor/lr:9e-07 - val-aux/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:0.683055078125 - val-core/DigitalLearningGmbH/MATH-lighteval/acc/mean@1:0.6864 - critic/score/mean:0.529757022857666 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.529757022857666 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.03175811842083931 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.03175811842083931 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:432.8428955078125 - response_length/max:2048.0 - response_length/min:32.0 - response_length/clip_ratio:0.0032958984375 - prompt_length/mean:381.8125 - prompt_length/max:1451.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.4603442549705505e-06 - timing_s/generate_sequences:74.71179962158203 - timing_s/reshard:3.1228575706481934 - timing_s/gen:322.9714674279094 - timing_s/reward filter:9.90500526688993 - timing_s/gen_layer2:176.71322224009782 - timing_s/process_data:191.4656838066876 - timing_s/reward:11.964574799872935 - timing_s/step:1129.5147942062467 - timing_s/old_log_prob:73.15967517253011 - timing_s/adv:0.26417269837111235 - timing_s/update_actor:436.0325025236234 - timing_s/testing:90.10022950265557 - timing_s/stop_profile:1.125037670135498e-06 - timing_per_token_ms/update_actor:0.06533636693099801 - timing_per_token_ms/adv:3.958439853458341e-05 - timing_per_token_ms/gen:0.09108438273257248 - perf/total_num_tokens:6673657 - perf/time_per_step:1129.5147942062467 - perf/throughput:738.5535180937841 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.3294270833333333
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.49687088274044794
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6034 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2955729166666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5022026431718062
[36m(TaskRunner pid=3962660)[0m step:11 - train/true_reward_mean:0.7649129033088684 - train/kept_rate_layer1:0.2955729166666667 - train/kept_rate_layer2:0.5022026431718062 - global_seqlen/min:796083 - global_seqlen/max:882232 - global_seqlen/minmax_diff:86149 - global_seqlen/balanced_min:830460 - global_seqlen/balanced_max:830461 - global_seqlen/mean:830460.5 - actor/entropy:0.13226863741874695 - actor/pg_loss:0.02931322713238584 - actor/pg_clipfrac:0.011358517286740831 - actor/ppo_kl:0.003994027114430041 - actor/pg_clipfrac_lower:1.8512759260739249e-06 - actor/grad_norm:1.1016936716623604 - perf/mfu/actor:0.2925625236835985 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:232.02234268188477 - actor/lr:1e-06 - critic/score/mean:0.5349016785621643 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5349016785621643 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.01822473853826523 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.01822473853826523 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:417.952880859375 - response_length/max:2048.0 - response_length/min:13.0 - response_length/clip_ratio:0.001708984375 - prompt_length/mean:393.043701171875 - prompt_length/max:1284.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.968636393547058e-06 - timing_s/generate_sequences:67.87080383300781 - timing_s/reshard:2.620856285095215 - timing_s/gen:324.79842419177294 - timing_s/reward filter:9.816499604843557 - timing_s/gen_layer2:169.52906547207385 - timing_s/process_data:183.79935886524618 - timing_s/reward:11.424348032101989 - timing_s/step:1023.5628320965916 - timing_s/old_log_prob:72.83791087474674 - timing_s/adv:0.2882412299513817 - timing_s/update_actor:427.340135300532 - timing_s/stop_profile:1.1567026376724243e-06 - timing_per_token_ms/update_actor:0.06432276660065891 - timing_per_token_ms/adv:4.3385752535999856e-05 - timing_per_token_ms/gen:0.0948629545490258 - perf/total_num_tokens:6643684 - perf/time_per_step:1023.5628320965916 - perf/throughput:811.3429620133287 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.3177083333333333
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5322745901639344
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6234 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.3014322916666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5417566594672426
[36m(TaskRunner pid=3962660)[0m step:12 - train/true_reward_mean:0.7610878944396973 - train/kept_rate_layer1:0.3014322916666667 - train/kept_rate_layer2:0.5417566594672426 - global_seqlen/min:757790 - global_seqlen/max:806875 - global_seqlen/minmax_diff:49085 - global_seqlen/balanced_min:785098 - global_seqlen/balanced_max:785099 - global_seqlen/mean:785098.375 - actor/entropy:0.1337302178144455 - actor/pg_loss:0.012293686843050471 - actor/pg_clipfrac:0.012086606967085608 - actor/ppo_kl:0.004876733569965729 - actor/pg_clipfrac_lower:2.2915125662109604e-06 - actor/grad_norm:1.1166602205485106 - perf/mfu/actor:0.30397495141686476 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:232.31295776367188 - actor/lr:1e-06 - critic/score/mean:0.560791015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.560791015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0116959847509861 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.0116959847509861 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:391.8170166015625 - response_length/max:1262.0 - response_length/min:20.0 - response_length/clip_ratio:0.0 - prompt_length/mean:374.880615234375 - prompt_length/max:1883.0 - prompt_length/min:43.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.145557224750519e-06 - timing_s/generate_sequences:58.277671813964844 - timing_s/reshard:3.0483720302581787 - timing_s/gen:309.837881420739 - timing_s/reward filter:9.594394174404442 - timing_s/gen_layer2:139.91695543378592 - timing_s/process_data:154.06724845431745 - timing_s/reward:11.167521473951638 - timing_s/step:936.624307340011 - timing_s/old_log_prob:69.6943134078756 - timing_s/adv:0.3084042267873883 - timing_s/update_actor:388.0942064644769 - timing_s/stop_profile:1.2442469596862793e-06 - timing_per_token_ms/update_actor:0.061790697004129716 - timing_per_token_ms/adv:4.910279982228156e-05 - timing_per_token_ms/gen:0.09652977131370645 - perf/total_num_tokens:6280787 - perf/time_per_step:936.624307340011 - perf/throughput:838.2212257865261 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2858072916666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5186028853454822
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5464 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.3033854166666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5054542203147353
[36m(TaskRunner pid=3962660)[0m step:13 - train/true_reward_mean:0.7732334136962891 - train/kept_rate_layer1:0.3033854166666667 - train/kept_rate_layer2:0.5054542203147353 - global_seqlen/min:719495 - global_seqlen/max:858889 - global_seqlen/minmax_diff:139394 - global_seqlen/balanced_min:808758 - global_seqlen/balanced_max:808759 - global_seqlen/mean:808758.625 - actor/entropy:0.13489936292171478 - actor/pg_loss:0.026069177948592002 - actor/pg_clipfrac:0.012963925160083658 - actor/ppo_kl:0.0054176533658424056 - actor/pg_clipfrac_lower:1.5271864545515232e-05 - actor/grad_norm:1.100464738206938 - perf/mfu/actor:0.3082640279730158 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:231.5767822265625 - actor/lr:1e-06 - critic/score/mean:0.5644056797027588 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.5644056797027588 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.006117714568972588 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.006117714568972588 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:404.5662841796875 - response_length/max:1702.0 - response_length/min:17.0 - response_length/clip_ratio:0.0 - prompt_length/mean:385.237060546875 - prompt_length/max:1331.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.209608495235443e-06 - timing_s/generate_sequences:63.448158264160156 - timing_s/reshard:2.650899887084961 - timing_s/gen:312.8489542873576 - timing_s/reward filter:9.89397482946515 - timing_s/gen_layer2:142.96656001452357 - timing_s/process_data:157.19475822895765 - timing_s/reward:10.718156644143164 - timing_s/step:949.8043627887964 - timing_s/old_log_prob:71.1901533883065 - timing_s/adv:0.2442991780117154 - timing_s/update_actor:394.4132387666032 - timing_s/stop_profile:1.1855736374855042e-06 - timing_per_token_ms/update_actor:0.06095966499995644 - timing_per_token_ms/adv:3.7758357447457734e-05 - timing_per_token_ms/gen:0.0943963229476486 - perf/total_num_tokens:6470069 - perf/time_per_step:949.8043627887964 - perf/throughput:851.5002211880131 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.298828125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5088053740014524
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5605 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.302734375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5049283154121864
[36m(TaskRunner pid=3962660)[0m step:14 - train/true_reward_mean:0.759235680103302 - train/kept_rate_layer1:0.302734375 - train/kept_rate_layer2:0.5049283154121864 - global_seqlen/min:780328 - global_seqlen/max:883840 - global_seqlen/minmax_diff:103512 - global_seqlen/balanced_min:811883 - global_seqlen/balanced_max:811883 - global_seqlen/mean:811883.0 - actor/entropy:0.12616896629333496 - actor/pg_loss:0.027100169063390543 - actor/pg_clipfrac:0.012326685381509984 - actor/ppo_kl:0.005082186445324623 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0490043419413269 - perf/mfu/actor:0.2973383534123442 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:231.5183868408203 - actor/lr:1e-06 - critic/score/mean:0.5597012042999268 - critic/score/max:1.0 - critic/score/min:-0.693359375 - critic/rewards/mean:0.5597012042999268 - critic/rewards/max:1.0 - critic/rewards/min:-0.693359375 - critic/advantages/mean:-0.014112086966633797 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.014112086966633797 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:413.83203125 - response_length/max:1891.0 - response_length/min:15.0 - response_length/clip_ratio:0.0 - prompt_length/mean:379.0224609375 - prompt_length/max:1254.0 - prompt_length/min:43.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.85801899433136e-06 - timing_s/generate_sequences:63.83189392089844 - timing_s/reshard:2.625683069229126 - timing_s/gen:317.3640931798145 - timing_s/reward filter:9.89444644190371 - timing_s/gen_layer2:149.0926217166707 - timing_s/process_data:163.4966553254053 - timing_s/reward:11.35544301290065 - timing_s/step:978.2694975966588 - timing_s/old_log_prob:71.69808213040233 - timing_s/adv:0.4712910111993551 - timing_s/update_actor:410.6348928194493 - timing_s/stop_profile:1.1557713150978088e-06 - timing_per_token_ms/update_actor:0.06322260917204962 - timing_per_token_ms/adv:7.256141143479959e-05 - timing_per_token_ms/gen:0.09361463372886043 - perf/total_num_tokens:6495064 - perf/time_per_step:978.2694975966588 - perf/throughput:829.9175247665137 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2942708333333333
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5088495575221239
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5520 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2845052083333333
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4851258581235698
[36m(TaskRunner pid=3962660)[0m step:15 - train/true_reward_mean:0.7688032984733582 - train/kept_rate_layer1:0.2845052083333333 - train/kept_rate_layer2:0.4851258581235698 - global_seqlen/min:773748 - global_seqlen/max:867678 - global_seqlen/minmax_diff:93930 - global_seqlen/balanced_min:811784 - global_seqlen/balanced_max:811785 - global_seqlen/mean:811784.75 - actor/entropy:0.12661468982696533 - actor/pg_loss:-0.009312474092763692 - actor/pg_clipfrac:0.01200385562934922 - actor/ppo_kl:0.005128011117914458 - actor/pg_clipfrac_lower:3.99072568482495e-06 - actor/grad_norm:1.0514314849860966 - perf/mfu/actor:0.2965950881411878 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:232.20516967773438 - actor/lr:1e-06 - critic/score/mean:0.5666104555130005 - critic/score/max:1.0 - critic/score/min:-0.4921875 - critic/rewards/mean:0.5666104555130005 - critic/rewards/max:1.0 - critic/rewards/min:-0.4921875 - critic/advantages/mean:-0.012241106480360031 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.012241106480360031 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:407.8687744140625 - response_length/max:1788.0 - response_length/min:31.0 - response_length/clip_ratio:0.0 - prompt_length/mean:384.8897705078125 - prompt_length/max:1562.0 - prompt_length/min:43.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.897855877876282e-06 - timing_s/generate_sequences:60.884403228759766 - timing_s/reshard:2.6730806827545166 - timing_s/gen:305.68786164931953 - timing_s/reward filter:9.553740643896163 - timing_s/gen_layer2:148.38708753604442 - timing_s/process_data:161.8711100332439 - timing_s/reward:10.488666451536119 - timing_s/step:963.9759046044201 - timing_s/old_log_prob:71.1789322765544 - timing_s/adv:0.2839547395706177 - timing_s/update_actor:411.6093587093055 - timing_s/stop_profile:1.191161572933197e-06 - timing_per_token_ms/update_actor:0.06338031089973443 - timing_per_token_ms/adv:4.372383497759376e-05 - timing_per_token_ms/gen:0.091488770751318 - perf/total_num_tokens:6494278 - perf/time_per_step:963.9759046044201 - perf/throughput:842.1214120835585 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2721354166666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.506877990430622
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5085 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2805989583333333
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5428267594740913
[36m(TaskRunner pid=3962660)[0m step:16 - train/true_reward_mean:0.773982048034668 - train/kept_rate_layer1:0.2805989583333333 - train/kept_rate_layer2:0.5428267594740913 - global_seqlen/min:721188 - global_seqlen/max:842208 - global_seqlen/minmax_diff:121020 - global_seqlen/balanced_min:801815 - global_seqlen/balanced_max:801816 - global_seqlen/mean:801815.125 - actor/entropy:0.12777739763259888 - actor/pg_loss:0.04401818282052081 - actor/pg_clipfrac:0.013085233395210874 - actor/ppo_kl:0.005809270710951283 - actor/pg_clipfrac_lower:4.252692287735326e-06 - actor/grad_norm:1.049896307522431 - perf/mfu/actor:0.3081490898424848 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:232.3037452697754 - actor/lr:1e-06 - critic/score/mean:0.5646530985832214 - critic/score/max:1.0 - critic/score/min:-0.111328125 - critic/rewards/mean:0.5646530985832214 - critic/rewards/max:1.0 - critic/rewards/min:-0.111328125 - critic/advantages/mean:-0.01049843616783619 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.01049843616783619 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:404.5072021484375 - response_length/max:1593.0 - response_length/min:44.0 - response_length/clip_ratio:0.0 - prompt_length/mean:378.515380859375 - prompt_length/max:1095.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.379319190979004e-06 - timing_s/generate_sequences:59.16859436035156 - timing_s/reshard:2.71854567527771 - timing_s/gen:306.23757246974856 - timing_s/reward filter:9.519965695217252 - timing_s/gen_layer2:141.0016688434407 - timing_s/process_data:154.34803083818406 - timing_s/reward:9.94282540678978 - timing_s/step:935.9824136067182 - timing_s/old_log_prob:70.95293759647757 - timing_s/adv:0.28502477426081896 - timing_s/update_actor:391.2674587070942 - timing_s/stop_profile:1.0849907994270325e-06 - timing_per_token_ms/update_actor:0.060997143622586035 - timing_per_token_ms/adv:4.4434303708853546e-05 - timing_per_token_ms/gen:0.09241495818140157 - perf/total_num_tokens:6414521 - perf/time_per_step:935.9824136067182 - perf/throughput:856.6561864237199 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2916666666666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.47953869047619047
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5156 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2662760416666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5176242868785657
[36m(TaskRunner pid=3962660)[0m step:17 - train/true_reward_mean:0.7917079925537109 - train/kept_rate_layer1:0.2662760416666667 - train/kept_rate_layer2:0.5176242868785657 - global_seqlen/min:764546 - global_seqlen/max:823964 - global_seqlen/minmax_diff:59418 - global_seqlen/balanced_min:790636 - global_seqlen/balanced_max:790636 - global_seqlen/mean:790636.0 - actor/entropy:0.13496705889701843 - actor/pg_loss:0.06134791648196909 - actor/pg_clipfrac:0.013085557628517687 - actor/ppo_kl:0.005325908522588749 - actor/pg_clipfrac_lower:5.668027610596964e-06 - actor/grad_norm:1.0524566266685724 - perf/mfu/actor:0.2973231810103608 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:231.12748336791992 - actor/lr:1e-06 - critic/score/mean:0.5740610957145691 - critic/score/max:1.0 - critic/score/min:-0.310546875 - critic/rewards/mean:0.5740610957145691 - critic/rewards/max:1.0 - critic/rewards/min:-0.310546875 - critic/advantages/mean:-0.018071312457323074 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.018071312457323074 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:401.3431396484375 - response_length/max:1695.0 - response_length/min:29.0 - response_length/clip_ratio:0.0 - prompt_length/mean:370.7623291015625 - prompt_length/max:1877.0 - prompt_length/min:41.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.479451596736908e-06 - timing_s/generate_sequences:57.148746490478516 - timing_s/reshard:2.5275158882141113 - timing_s/gen:303.6816804250702 - timing_s/reward filter:9.478683126159012 - timing_s/gen_layer2:139.41826275270432 - timing_s/process_data:152.86072706710547 - timing_s/reward:10.122952301986516 - timing_s/step:939.1757308356464 - timing_s/old_log_prob:69.57636824157089 - timing_s/adv:0.2734095547348261 - timing_s/update_actor:399.69236667919904 - timing_s/stop_profile:1.1781230568885803e-06 - timing_per_token_ms/update_actor:0.06319158985285249 - timing_per_token_ms/adv:4.322620566462096e-05 - timing_per_token_ms/gen:0.09236614250460573 - perf/total_num_tokens:6325088 - perf/time_per_step:939.1757308356464 - perf/throughput:841.8403223606717 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2604166666666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5254166666666666
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5044 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.265625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4948937908496732
[36m(TaskRunner pid=3962660)[0m step:18 - train/true_reward_mean:0.7824222445487976 - train/kept_rate_layer1:0.265625 - train/kept_rate_layer2:0.4948937908496732 - global_seqlen/min:779608 - global_seqlen/max:838550 - global_seqlen/minmax_diff:58942 - global_seqlen/balanced_min:807017 - global_seqlen/balanced_max:807018 - global_seqlen/mean:807017.875 - actor/entropy:0.1243671327829361 - actor/pg_loss:0.048873642810385906 - actor/pg_clipfrac:0.013620091084442981 - actor/ppo_kl:0.006778381844580851 - actor/pg_clipfrac_lower:1.2723528442194464e-05 - actor/grad_norm:1.034336543874815 - perf/mfu/actor:0.3045765541742197 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:231.12380981445312 - actor/lr:1e-06 - critic/score/mean:0.5768214464187622 - critic/score/max:1.0 - critic/score/min:-0.302734375 - critic/rewards/mean:0.5768214464187622 - critic/rewards/max:1.0 - critic/rewards/min:-0.302734375 - critic/advantages/mean:-0.013324889354407787 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.788851022720337 - critic/returns/mean:-0.013324889354407787 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.788851022720337 - response_length/mean:403.868408203125 - response_length/max:1691.0 - response_length/min:16.0 - response_length/clip_ratio:0.0 - prompt_length/mean:384.2349853515625 - prompt_length/max:1429.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.7034194469451904e-06 - timing_s/generate_sequences:56.396240234375 - timing_s/reshard:2.746493101119995 - timing_s/gen:307.0809230869636 - timing_s/reward filter:9.71356423664838 - timing_s/gen_layer2:133.98334876261652 - timing_s/process_data:147.5907638091594 - timing_s/reward:9.82123767863959 - timing_s/step:937.0000690501183 - timing_s/old_log_prob:70.80649728793651 - timing_s/adv:0.2851345371454954 - timing_s/update_actor:398.42374758049846 - timing_s/stop_profile:1.1669471859931946e-06 - timing_per_token_ms/update_actor:0.0617123486237059 - timing_per_token_ms/adv:4.416484225109255e-05 - timing_per_token_ms/gen:0.09281603483370468 - perf/total_num_tokens:6456143 - perf/time_per_step:937.0000690501183 - perf/throughput:861.2783516847683 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2552083333333333
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.48660714285714285
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4578 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.251953125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.49946167097329885
[36m(TaskRunner pid=3962660)[0m step:19 - train/true_reward_mean:0.8031718134880066 - train/kept_rate_layer1:0.251953125 - train/kept_rate_layer2:0.49946167097329885 - global_seqlen/min:728837 - global_seqlen/max:795228 - global_seqlen/minmax_diff:66391 - global_seqlen/balanced_min:776959 - global_seqlen/balanced_max:776960 - global_seqlen/mean:776959.125 - actor/entropy:0.13591469824314117 - actor/pg_loss:0.007039379694485675 - actor/pg_clipfrac:0.013361029492326001 - actor/ppo_kl:0.006153896480047884 - actor/pg_clipfrac_lower:1.2569219081682696e-05 - actor/grad_norm:1.049957288429141 - perf/mfu/actor:0.30135551793216525 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:230.58266830444336 - actor/lr:1e-06 - critic/score/mean:0.5722980499267578 - critic/score/max:1.0 - critic/score/min:-0.42578125 - critic/rewards/mean:0.5722980499267578 - critic/rewards/max:1.0 - critic/rewards/min:-0.42578125 - critic/advantages/mean:-0.009747650474309921 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.009747650474309921 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:397.62939453125 - response_length/max:1754.0 - response_length/min:47.0 - response_length/clip_ratio:0.0 - prompt_length/mean:361.1197509765625 - prompt_length/max:1251.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.362345397472382e-06 - timing_s/generate_sequences:53.2695426940918 - timing_s/reshard:2.485952854156494 - timing_s/gen:311.4393743276596 - timing_s/reward filter:9.470283416099846 - timing_s/gen_layer2:136.9950885856524 - timing_s/process_data:150.0179523276165 - timing_s/reward:9.358824254013598 - timing_s/step:929.7676536347717 - timing_s/old_log_prob:68.46165193151683 - timing_s/adv:0.28412807639688253 - timing_s/update_actor:387.4714923109859 - timing_s/stop_profile:1.2200325727462769e-06 - timing_per_token_ms/update_actor:0.062337818014394565 - timing_per_token_ms/adv:4.5711554709664185e-05 - timing_per_token_ms/gen:0.09561039065987377 - perf/total_num_tokens:6215673 - perf/time_per_step:929.7676536347717 - perf/throughput:835.6486934801483 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2630208333333333
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5247524752475248
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5088 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2779947916666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.49736533957845436
[36m(TaskRunner pid=3962660)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 20}
[36m(TaskRunner pid=3962660)[0m validation generation end
[36m(TaskRunner pid=3962660)[0m [prompt] system
[36m(TaskRunner pid=3962660)[0m You are a helpful assistant.
[36m(TaskRunner pid=3962660)[0m user
[36m(TaskRunner pid=3962660)[0m How many vertical asymptotes does the graph of $y=\frac{2}{x^2+x-6}$ have? Let's think step by step and output the final answer within \boxed{}.
[36m(TaskRunner pid=3962660)[0m assistant
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m [response] To determine the number of vertical asymptotes of the function \( y = \frac{2}{x^2 + x - 6} \), we need to find the values of \( x \) that make the denominator equal to zero, because vertical asymptotes occur where the function is undefined due to division by zero, provided these points are not removable discontinuities.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 1. **Find the values that make the denominator zero:**
[36m(TaskRunner pid=3962660)[0m    \[
[36m(TaskRunner pid=3962660)[0m    x^2 + x - 6 = 0
[36m(TaskRunner pid=3962660)[0m    \]
[36m(TaskRunner pid=3962660)[0m    This is a quadratic equation, and we can factor it as follows:
[36m(TaskRunner pid=3962660)[0m    \[
[36m(TaskRunner pid=3962660)[0m    x^2 + x - 6 = (x + 3)(x - 2)
[36m(TaskRunner pid=3962660)[0m    \]
[36m(TaskRunner pid=3962660)[0m    So, the solutions to the equation \( x^2 + x - 6 = 0 \) are:
[36m(TaskRunner pid=3962660)[0m    \[
[36m(TaskRunner pid=3962660)[0m    x = -3 \quad \text{and} \quad x = 2
[36m(TaskRunner pid=3962660)[0m    \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 2. **Verify that these are not removable discontinuities:**
[36m(TaskRunner pid=3962660)[0m    A discontinuity is removable if the numerator and the denominator can both be zero at the same point. In this case, the numerator is 2, which is a constant and never zero. Therefore, the discontinuities at \( x = -3 \) and \( x = 2 \) are not removable because the numerator is not zero at these points.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 3. **Identify the vertical asymptotes:**
[36m(TaskRunner pid=3962660)[0m    Since the denominator is zero at \( x = -3 \) and \( x = 2 \), and these are not removable discontinuities, there are vertical asymptotes at \( x = -3 \) and \( x = 2 \).
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Therefore, the number of vertical asymptotes is:
[36m(TaskRunner pid=3962660)[0m \[
[36m(TaskRunner pid=3962660)[0m \boxed{2}
[36m(TaskRunner pid=3962660)[0m \]
[36m(TaskRunner pid=3962660)[0m [ground_truth] 2
[36m(TaskRunner pid=3962660)[0m [score] 1.0
[36m(TaskRunner pid=3962660)[0m len reward_extra_infos_dict['reward']: 5000
[36m(TaskRunner pid=3962660)[0m len reward_extra_infos_dict['acc']: 5000
[36m(TaskRunner pid=3962660)[0m local_global_step_folder: /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_20
[36m(TaskRunner pid=3962660)[0m step:20 - train/true_reward_mean:0.7868331074714661 - train/kept_rate_layer1:0.2779947916666667 - train/kept_rate_layer2:0.49736533957845436 - global_seqlen/min:778219 - global_seqlen/max:858911 - global_seqlen/minmax_diff:80692 - global_seqlen/balanced_min:800927 - global_seqlen/balanced_max:800928 - global_seqlen/mean:800927.25 - actor/entropy:0.12727823853492737 - actor/pg_loss:-0.00652041852109782 - actor/pg_clipfrac:0.012908230911018358 - actor/ppo_kl:0.006428618923359749 - actor/pg_clipfrac_lower:4.6762779127669375e-06 - actor/grad_norm:1.021423882804811 - perf/mfu/actor:0.2930144814606814 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:230.89739990234375 - actor/lr:1e-06 - val-aux/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:0.6874515625 - val-core/DigitalLearningGmbH/MATH-lighteval/acc/mean@1:0.6894 - critic/score/mean:0.5696704387664795 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5696704387664795 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.015260872431099415 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.015260872431099415 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:397.17919921875 - response_length/max:2048.0 - response_length/min:51.0 - response_length/clip_ratio:0.000244140625 - prompt_length/mean:384.976318359375 - prompt_length/max:1853.0 - prompt_length/min:41.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.825422704219818e-06 - timing_s/generate_sequences:58.01877975463867 - timing_s/reshard:2.5391111373901367 - timing_s/gen:302.9276927243918 - timing_s/reward filter:9.841012547723949 - timing_s/gen_layer2:142.76362722367048 - timing_s/process_data:156.42827069573104 - timing_s/reward:9.734261147677898 - timing_s/step:1098.0311760567129 - timing_s/old_log_prob:70.7222148757428 - timing_s/adv:0.25953416526317596 - timing_s/update_actor:411.03084652591497 - timing_s/testing:90.26533711142838 - timing_s/save_checkpoint:53.81274040881544 - timing_s/stop_profile:2.773478627204895e-06 - timing_per_token_ms/update_actor:0.06414921681805603 - timing_per_token_ms/adv:4.050526518843877e-05 - timing_per_token_ms/gen:0.09310275610733647 - perf/total_num_tokens:6407418 - perf/time_per_step:1098.0311760567129 - perf/throughput:729.4212290732194 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2604166666666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4898958333333333
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4703 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.26953125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5031199677938808
[36m(TaskRunner pid=3962660)[0m step:21 - train/true_reward_mean:0.7930733561515808 - train/kept_rate_layer1:0.26953125 - train/kept_rate_layer2:0.5031199677938808 - global_seqlen/min:773953 - global_seqlen/max:811607 - global_seqlen/minmax_diff:37654 - global_seqlen/balanced_min:791613 - global_seqlen/balanced_max:791614 - global_seqlen/mean:791613.75 - actor/entropy:0.13140586018562317 - actor/pg_loss:0.04098824415821582 - actor/pg_clipfrac:0.013100694526413766 - actor/ppo_kl:0.0055229896138492525 - actor/pg_clipfrac_lower:5.008479735503594e-06 - actor/grad_norm:1.0279279083479196 - perf/mfu/actor:0.2965810110627959 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:122.697265625 - perf/cpu_memory_used_gb:231.0624237060547 - actor/lr:1e-06 - critic/score/mean:0.574381947517395 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.574381947517395 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.010926851071417332 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888506650924683 - critic/returns/mean:-0.010926851071417332 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888506650924683 - response_length/mean:406.787841796875 - response_length/max:2048.0 - response_length/min:31.0 - response_length/clip_ratio:0.000244140625 - prompt_length/mean:366.2724609375 - prompt_length/max:1224.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.314847946166992e-06 - timing_s/generate_sequences:58.85455322265625 - timing_s/reshard:2.5334253311157227 - timing_s/gen:303.6108520915732 - timing_s/reward filter:9.420318615622818 - timing_s/gen_layer2:140.9769077412784 - timing_s/process_data:154.3178865928203 - timing_s/reward:9.785863959230483 - timing_s/step:941.8641379075125 - timing_s/old_log_prob:69.86434189323336 - timing_s/adv:0.2843297766521573 - timing_s/update_actor:401.24038924556226 - timing_s/stop_profile:1.2209638953208923e-06 - timing_per_token_ms/update_actor:0.06335798065116388 - timing_per_token_ms/adv:4.4897176282650045e-05 - timing_per_token_ms/gen:0.09110860204055964 - perf/total_num_tokens:6332910 - perf/time_per_step:941.8641379075125 - perf/throughput:840.4755188563444 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2734375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4836309523809524
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4875 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2604166666666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5010416666666667
[36m(TaskRunner pid=3962660)[0m step:22 - train/true_reward_mean:0.788918673992157 - train/kept_rate_layer1:0.2604166666666667 - train/kept_rate_layer2:0.5010416666666667 - global_seqlen/min:788769 - global_seqlen/max:830951 - global_seqlen/minmax_diff:42182 - global_seqlen/balanced_min:805843 - global_seqlen/balanced_max:805844 - global_seqlen/mean:805843.875 - actor/entropy:0.13024383783340454 - actor/pg_loss:0.042670875802936985 - actor/pg_clipfrac:0.01298726057970602 - actor/ppo_kl:0.006872477469027892 - actor/pg_clipfrac_lower:6.481822895340596e-06 - actor/grad_norm:1.0298473769798875 - perf/mfu/actor:0.30173325047730687 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:231.12202072143555 - actor/lr:1e-06 - critic/score/mean:0.5772577524185181 - critic/score/max:1.0 - critic/score/min:-0.732421875 - critic/rewards/mean:0.5772577524185181 - critic/rewards/max:1.0 - critic/rewards/min:-0.732421875 - critic/advantages/mean:-0.013381692580878735 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.013381692580878735 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:411.115966796875 - response_length/max:1911.0 - response_length/min:19.0 - response_length/clip_ratio:0.0 - prompt_length/mean:375.8409423828125 - prompt_length/max:1304.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.5460259318351746e-06 - timing_s/generate_sequences:55.60291290283203 - timing_s/reshard:2.5391643047332764 - timing_s/gen:309.9603646341711 - timing_s/reward filter:9.45131707098335 - timing_s/gen_layer2:134.2235288824886 - timing_s/process_data:147.67512235417962 - timing_s/reward:9.927728643640876 - timing_s/step:943.0137576209381 - timing_s/old_log_prob:70.8228845000267 - timing_s/adv:0.26173427794128656 - timing_s/update_actor:401.6583742303774 - timing_s/stop_profile:1.1706724762916565e-06 - timing_per_token_ms/update_actor:0.06230399998857989 - timing_per_token_ms/adv:4.059940859221747e-05 - timing_per_token_ms/gen:0.09203475814453535 - perf/total_num_tokens:6446751 - perf/time_per_step:943.0137576209381 - perf/throughput:854.5409528626664 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.24283854166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5120643431635389
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4584 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.23763020833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.49155251141552514
[36m(TaskRunner pid=3962660)[0m step:23 - train/true_reward_mean:0.801358699798584 - train/kept_rate_layer1:0.23763020833333334 - train/kept_rate_layer2:0.49155251141552514 - global_seqlen/min:743973 - global_seqlen/max:825344 - global_seqlen/minmax_diff:81371 - global_seqlen/balanced_min:786634 - global_seqlen/balanced_max:786635 - global_seqlen/mean:786634.375 - actor/entropy:0.1330382376909256 - actor/pg_loss:0.03382352172511105 - actor/pg_clipfrac:0.013364004107441159 - actor/ppo_kl:0.007269392086631872 - actor/pg_clipfrac_lower:1.1904019225362896e-05 - actor/grad_norm:1.0576374896336347 - perf/mfu/actor:0.2996548904559062 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.4475440979004 - actor/lr:1e-06 - critic/score/mean:0.582897961139679 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.582897961139679 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.019790461286902428 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.019790461286902428 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:395.30615234375 - response_length/max:2048.0 - response_length/min:13.0 - response_length/clip_ratio:0.0001220703125 - prompt_length/mean:372.8914794921875 - prompt_length/max:1338.0 - prompt_length/min:43.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.295530617237091e-06 - timing_s/generate_sequences:49.767112731933594 - timing_s/reshard:2.515415906906128 - timing_s/gen:306.3455377118662 - timing_s/reward filter:9.158327345736325 - timing_s/gen_layer2:129.02274884842336 - timing_s/process_data:141.4493528297171 - timing_s/reward:8.549792354926467 - timing_s/step:923.3867041403428 - timing_s/old_log_prob:69.69892533682287 - timing_s/adv:0.2515800017863512 - timing_s/update_actor:394.51457677129656 - timing_s/stop_profile:1.1064112186431885e-06 - timing_per_token_ms/update_actor:0.06269027093611575 - timing_per_token_ms/adv:3.997727689346642e-05 - timing_per_token_ms/gen:0.0945993258636398 - perf/total_num_tokens:6293075 - perf/time_per_step:923.3867041403428 - perf/throughput:851.9013447701125 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2682291666666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.49534789644012944
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4898 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2649739583333333
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.49109336609336607
[36m(TaskRunner pid=3962660)[0m step:24 - train/true_reward_mean:0.796118438243866 - train/kept_rate_layer1:0.2649739583333333 - train/kept_rate_layer2:0.49109336609336607 - global_seqlen/min:754856 - global_seqlen/max:820550 - global_seqlen/minmax_diff:65694 - global_seqlen/balanced_min:789389 - global_seqlen/balanced_max:789390 - global_seqlen/mean:789389.75 - actor/entropy:0.12622249126434326 - actor/pg_loss:0.00263179615534726 - actor/pg_clipfrac:0.01282732259678722 - actor/ppo_kl:0.006585457471587956 - actor/pg_clipfrac_lower:2.635344798486538e-06 - actor/grad_norm:1.0060035411734134 - perf/mfu/actor:0.30197090631404827 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:231.00332260131836 - actor/lr:1e-06 - critic/score/mean:0.5717704892158508 - critic/score/max:1.0 - critic/score/min:-0.466796875 - critic/rewards/mean:0.5717704892158508 - critic/rewards/max:1.0 - critic/rewards/min:-0.466796875 - critic/advantages/mean:-0.014990213327109814 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888509035110474 - critic/returns/mean:-0.014990213327109814 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888509035110474 - response_length/mean:403.591064453125 - response_length/max:1831.0 - response_length/min:31.0 - response_length/clip_ratio:0.0 - prompt_length/mean:367.29736328125 - prompt_length/max:1859.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.070360541343689e-06 - timing_s/generate_sequences:58.02540969848633 - timing_s/reshard:2.5239384174346924 - timing_s/gen:305.9791934993118 - timing_s/reward filter:9.345829583704472 - timing_s/gen_layer2:132.01221854425967 - timing_s/process_data:145.12169461511075 - timing_s/reward:9.644771816208959 - timing_s/step:926.438287358731 - timing_s/old_log_prob:69.77980879414827 - timing_s/adv:0.2668061424046755 - timing_s/update_actor:392.921927312389 - timing_s/stop_profile:1.2479722499847412e-06 - timing_per_token_ms/update_actor:0.062219253434755935 - timing_per_token_ms/adv:4.22487976320752e-05 - timing_per_token_ms/gen:0.09254658752063893 - perf/total_num_tokens:6315118 - perf/time_per_step:926.438287358731 - perf/throughput:852.0694370809572 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.25390625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5074786324786325
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4750 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.22981770833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5204202077431539
[36m(TaskRunner pid=3962660)[0m step:25 - train/true_reward_mean:0.8074350357055664 - train/kept_rate_layer1:0.22981770833333334 - train/kept_rate_layer2:0.5204202077431539 - global_seqlen/min:724390 - global_seqlen/max:830661 - global_seqlen/minmax_diff:106271 - global_seqlen/balanced_min:782785 - global_seqlen/balanced_max:782786 - global_seqlen/mean:782785.5 - actor/entropy:0.12514296174049377 - actor/pg_loss:0.029025426193291827 - actor/pg_clipfrac:0.01264884175470283 - actor/ppo_kl:0.00661180619990709 - actor/pg_clipfrac_lower:9.509523575236962e-06 - actor/grad_norm:1.0360432425513864 - perf/mfu/actor:0.30152257830176626 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.52907943725586 - actor/lr:1e-06 - critic/score/mean:0.5801448225975037 - critic/score/max:1.0 - critic/score/min:-0.427734375 - critic/rewards/mean:0.5801448225975037 - critic/rewards/max:1.0 - critic/rewards/min:-0.427734375 - critic/advantages/mean:-0.017139827832579613 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888514995574951 - critic/returns/mean:-0.017139827832579613 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888514995574951 - response_length/mean:395.70068359375 - response_length/max:1755.0 - response_length/min:45.0 - response_length/clip_ratio:0.0 - prompt_length/mean:368.73828125 - prompt_length/max:1212.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.42846930027008e-06 - timing_s/generate_sequences:49.56646728515625 - timing_s/reshard:3.2609546184539795 - timing_s/gen:303.60496722813696 - timing_s/reward filter:9.26521479524672 - timing_s/gen_layer2:124.74439188931137 - timing_s/process_data:137.49104851856828 - timing_s/reward:8.745274316519499 - timing_s/step:911.4759875712916 - timing_s/old_log_prob:68.50643490441144 - timing_s/adv:0.2611139137297869 - timing_s/update_actor:390.1142370896414 - timing_s/stop_profile:1.3737007975578308e-06 - timing_per_token_ms/update_actor:0.06229583920014509 - timing_per_token_ms/adv:4.169627467067716e-05 - timing_per_token_ms/gen:0.0936595633080587 - perf/total_num_tokens:6262284 - perf/time_per_step:911.4759875712916 - perf/throughput:858.8108855020978 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2513020833333333
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4958981001727116
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4594 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.24934895833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5239338555265448
[36m(TaskRunner pid=3962660)[0m step:26 - train/true_reward_mean:0.7856847643852234 - train/kept_rate_layer1:0.24934895833333334 - train/kept_rate_layer2:0.5239338555265448 - global_seqlen/min:742693 - global_seqlen/max:847943 - global_seqlen/minmax_diff:105250 - global_seqlen/balanced_min:805647 - global_seqlen/balanced_max:805648 - global_seqlen/mean:805647.625 - actor/entropy:0.12365536391735077 - actor/pg_loss:0.017925553921600865 - actor/pg_clipfrac:0.013244315114339492 - actor/ppo_kl:0.007429959276256064 - actor/pg_clipfrac_lower:7.302412128735901e-06 - actor/grad_norm:0.9806901649571955 - perf/mfu/actor:0.29756808377173605 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.81689453125 - actor/lr:1e-06 - critic/score/mean:0.5702006220817566 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5702006220817566 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.01571567915380001 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.01571567915380001 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:408.0618896484375 - response_length/max:2048.0 - response_length/min:9.0 - response_length/clip_ratio:0.000244140625 - prompt_length/mean:378.703369140625 - prompt_length/max:1352.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.4605847001075745e-06 - timing_s/generate_sequences:54.895545959472656 - timing_s/reshard:3.9863686561584473 - timing_s/gen:307.8430260568857 - timing_s/reward filter:9.253303993493319 - timing_s/gen_layer2:136.6473670070991 - timing_s/process_data:149.47914444934577 - timing_s/reward:9.284070710651577 - timing_s/step:947.9339394764975 - timing_s/old_log_prob:71.16006641276181 - timing_s/adv:0.2782369824126363 - timing_s/update_actor:407.14719367120415 - timing_s/stop_profile:1.2628734111785889e-06 - timing_per_token_ms/update_actor:0.06317079282508965 - timing_per_token_ms/adv:4.316977016047125e-05 - timing_per_token_ms/gen:0.092090183731897 - perf/total_num_tokens:6445181 - perf/time_per_step:947.9339394764975 - perf/throughput:849.8984912861375 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.23372395833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4974466109563603
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4286 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.22591145833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.49339577329490875
[36m(TaskRunner pid=3962660)[0m step:27 - train/true_reward_mean:0.8200947642326355 - train/kept_rate_layer1:0.22591145833333334 - train/kept_rate_layer2:0.49339577329490875 - global_seqlen/min:765703 - global_seqlen/max:830917 - global_seqlen/minmax_diff:65214 - global_seqlen/balanced_min:793886 - global_seqlen/balanced_max:793887 - global_seqlen/mean:793886.125 - actor/entropy:0.127036452293396 - actor/pg_loss:0.023352823811903668 - actor/pg_clipfrac:0.01265111481340907 - actor/ppo_kl:0.0073564119975217755 - actor/pg_clipfrac_lower:4.511829936156497e-06 - actor/grad_norm:0.9948353907093406 - perf/mfu/actor:0.30001760579238096 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.0010528564453 - actor/lr:1e-06 - critic/score/mean:0.574148952960968 - critic/score/max:1.0 - critic/score/min:-0.474609375 - critic/rewards/mean:0.574148952960968 - critic/rewards/max:1.0 - critic/rewards/min:-0.474609375 - critic/advantages/mean:-0.017788013443350792 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.017788013443350792 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:401.033935546875 - response_length/max:1779.0 - response_length/min:42.0 - response_length/clip_ratio:0.0 - prompt_length/mean:374.2454833984375 - prompt_length/max:1324.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.18235969543457e-06 - timing_s/generate_sequences:47.41944885253906 - timing_s/reshard:2.451826572418213 - timing_s/gen:304.1458222605288 - timing_s/reward filter:9.190873734652996 - timing_s/gen_layer2:119.57937537506223 - timing_s/process_data:132.13263781461865 - timing_s/reward:8.322589349932969 - timing_s/step:915.227458071895 - timing_s/old_log_prob:70.08188704773784 - timing_s/adv:0.26020439714193344 - timing_s/update_actor:397.7571611376479 - timing_s/stop_profile:1.0691583156585693e-06 - timing_per_token_ms/update_actor:0.06262818252706708 - timing_per_token_ms/adv:4.097004421476906e-05 - timing_per_token_ms/gen:0.09257863806035084 - perf/total_num_tokens:6351089 - perf/time_per_step:915.227458071895 - perf/throughput:867.4194791669339 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.23763020833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.48755707762557077
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4271 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.248046875
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5118110236220472
[36m(TaskRunner pid=3962660)[0m step:28 - train/true_reward_mean:0.8023881912231445 - train/kept_rate_layer1:0.248046875 - train/kept_rate_layer2:0.5118110236220472 - global_seqlen/min:734975 - global_seqlen/max:860508 - global_seqlen/minmax_diff:125533 - global_seqlen/balanced_min:794937 - global_seqlen/balanced_max:794938 - global_seqlen/mean:794937.75 - actor/entropy:0.12809348106384277 - actor/pg_loss:-0.05902775534075396 - actor/pg_clipfrac:0.013358049834516413 - actor/ppo_kl:0.006920324523513233 - actor/pg_clipfrac_lower:3.968391583525929e-06 - actor/grad_norm:0.9949912072625011 - perf/mfu/actor:0.298257348905769 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.5725860595703 - actor/lr:1e-06 - critic/score/mean:0.5807814598083496 - critic/score/max:1.0 - critic/score/min:-0.38671875 - critic/rewards/mean:0.5807814598083496 - critic/rewards/max:1.0 - critic/rewards/min:-0.38671875 - critic/advantages/mean:-0.017606234177947044 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.017606234177947044 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:399.8013916015625 - response_length/max:1734.0 - response_length/min:37.0 - response_length/clip_ratio:0.0 - prompt_length/mean:376.5050048828125 - prompt_length/max:1557.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.177462637424469e-06 - timing_s/generate_sequences:53.15031433105469 - timing_s/reshard:2.507686138153076 - timing_s/gen:312.7171585019678 - timing_s/reward filter:9.25786610506475 - timing_s/gen_layer2:125.31666319724172 - timing_s/process_data:138.24642409943044 - timing_s/reward:8.886367809027433 - timing_s/step:934.067585661076 - timing_s/old_log_prob:70.35788199398667 - timing_s/adv:0.2663366263732314 - timing_s/update_actor:400.75215656589717 - timing_s/stop_profile:1.2284144759178162e-06 - timing_per_token_ms/update_actor:0.06301627966559287 - timing_per_token_ms/adv:4.188010733752917e-05 - timing_per_token_ms/gen:0.09548111153272447 - perf/total_num_tokens:6359502 - perf/time_per_step:934.067585661076 - perf/throughput:851.0494981338975 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.220703125
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5051622418879056
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4110 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2265625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.49090038314176243
[36m(TaskRunner pid=3962660)[0m step:29 - train/true_reward_mean:0.8268957138061523 - train/kept_rate_layer1:0.2265625 - train/kept_rate_layer2:0.49090038314176243 - global_seqlen/min:748518 - global_seqlen/max:811595 - global_seqlen/minmax_diff:63077 - global_seqlen/balanced_min:776836 - global_seqlen/balanced_max:776837 - global_seqlen/mean:776836.375 - actor/entropy:0.1317944973707199 - actor/pg_loss:0.06699996166342016 - actor/pg_clipfrac:0.013595520616984696 - actor/ppo_kl:0.007771853863030426 - actor/pg_clipfrac_lower:1.3187939074144141e-05 - actor/grad_norm:1.0001378757879138 - perf/mfu/actor:0.2993417861058719 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.27386474609375 - actor/lr:1e-06 - critic/score/mean:0.5901116132736206 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5901116132736206 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.01417255774140358 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.01417255774140358 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:388.5662841796875 - response_length/max:2048.0 - response_length/min:32.0 - response_length/clip_ratio:0.000244140625 - prompt_length/mean:370.06298828125 - prompt_length/max:1380.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.450821042060852e-06 - timing_s/generate_sequences:50.20415115356445 - timing_s/reshard:2.4915428161621094 - timing_s/gen:294.96358256880194 - timing_s/reward filter:9.288201078772545 - timing_s/gen_layer2:121.07044218759984 - timing_s/process_data:133.74195895623416 - timing_s/reward:8.039393242448568 - timing_s/step:897.6325119081885 - timing_s/old_log_prob:68.22184588946402 - timing_s/adv:0.2841395679861307 - timing_s/update_actor:389.9266845751554 - timing_s/stop_profile:1.2153759598731995e-06 - timing_per_token_ms/update_actor:0.0627427308252583 - timing_per_token_ms/adv:4.572062681573882e-05 - timing_per_token_ms/gen:0.0926644903746784 - perf/total_num_tokens:6214691 - perf/time_per_step:897.6325119081885 - perf/throughput:865.4280729522599 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.236328125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5115932047750229
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4457 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.24088541666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.47274774774774775
[36m(TaskRunner pid=3962660)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 30}
[36m(TaskRunner pid=3962660)[0m validation generation end
[36m(TaskRunner pid=3962660)[0m [prompt] system
[36m(TaskRunner pid=3962660)[0m You are a helpful assistant.
[36m(TaskRunner pid=3962660)[0m user
[36m(TaskRunner pid=3962660)[0m How many vertical asymptotes does the graph of $y=\frac{2}{x^2+x-6}$ have? Let's think step by step and output the final answer within \boxed{}.
[36m(TaskRunner pid=3962660)[0m assistant
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m [response] To determine the number of vertical asymptotes of the function \( y = \frac{2}{x^2 + x - 6} \), we need to identify the values of \( x \) that make the denominator zero, as these values will result in an undefined form of the function and thus form vertical asymptotes.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m First, we factor the denominator:
[36m(TaskRunner pid=3962660)[0m \[ x^2 + x - 6 = (x + 3)(x - 2). \]
[36m(TaskRunner pid=3962660)[0m So, the function can be rewritten as:
[36m(TaskRunner pid=3962660)[0m \[ y = \frac{2}{(x + 3)(x - 2)}. \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m The function will have vertical asymptotes at the values of \( x \) that make the denominator zero, provided these values do not cancel with any factors in the numerator. In this case, the numerator is a constant (2), so we do not have any cancellation.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Next, we solve the equation \( (x + 3)(x - 2) = 0 \):
[36m(TaskRunner pid=3962660)[0m \[ x + 3 = 0 \quad \text{or} \quad x - 2 = 0. \]
[36m(TaskRunner pid=3962660)[0m This gives us the solutions:
[36m(TaskRunner pid=3962660)[0m \[ x = -3 \quad \text{or} \quad x = 2. \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Therefore, the function \( y = \frac{2}{x^2 + x - 6} \) has vertical asymptotes at \( x = -3 \) and \( x = 2 \). This means there are 2 vertical asymptotes.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m The final answer is:
[36m(TaskRunner pid=3962660)[0m \[ \boxed{2} \]
[36m(TaskRunner pid=3962660)[0m [ground_truth] 2
[36m(TaskRunner pid=3962660)[0m [score] 1.0
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m len reward_extra_infos_dict['reward']: 5000
[36m(TaskRunner pid=3962660)[0m len reward_extra_infos_dict['acc']: 5000
[36m(TaskRunner pid=3962660)[0m step:30 - train/true_reward_mean:0.8044788241386414 - train/kept_rate_layer1:0.24088541666666666 - train/kept_rate_layer2:0.47274774774774775 - global_seqlen/min:743815 - global_seqlen/max:860002 - global_seqlen/minmax_diff:116187 - global_seqlen/balanced_min:800924 - global_seqlen/balanced_max:800925 - global_seqlen/mean:800924.875 - actor/entropy:0.13840198516845703 - actor/pg_loss:0.01323627683278076 - actor/pg_clipfrac:0.013007489285749815 - actor/ppo_kl:0.0069960754984883895 - actor/pg_clipfrac_lower:3.744321161368375e-06 - actor/grad_norm:1.012760050361976 - perf/mfu/actor:0.3009088517614161 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.551025390625 - actor/lr:1e-06 - val-aux/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:0.67178515625 - val-core/DigitalLearningGmbH/MATH-lighteval/acc/mean@1:0.6732 - critic/score/mean:0.5837101340293884 - critic/score/max:1.0 - critic/score/min:-0.560546875 - critic/rewards/mean:0.5837101340293884 - critic/rewards/max:1.0 - critic/rewards/min:-0.560546875 - critic/advantages/mean:-0.01579928770661354 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888507843017578 - critic/returns/mean:-0.01579928770661354 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888507843017578 - response_length/mean:406.6766357421875 - response_length/max:1823.0 - response_length/min:13.0 - response_length/clip_ratio:0.0 - prompt_length/mean:375.4765625 - prompt_length/max:1839.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.169771611690521e-06 - timing_s/generate_sequences:53.50067901611328 - timing_s/reshard:2.5193569660186768 - timing_s/gen:308.7948579583317 - timing_s/reward filter:9.14866257365793 - timing_s/gen_layer2:133.2381306765601 - timing_s/process_data:146.02594588603824 - timing_s/reward:8.938131887465715 - timing_s/step:1026.7599562155083 - timing_s/old_log_prob:70.62954286765307 - timing_s/adv:0.26734000351279974 - timing_s/update_actor:400.22388303559273 - timing_s/testing:89.27598824817687 - timing_s/stop_profile:9.909272193908691e-07 - timing_per_token_ms/update_actor:0.06246276890756963 - timing_per_token_ms/adv:4.1723639110472085e-05 - timing_per_token_ms/gen:0.09268957568849172 - perf/total_num_tokens:6407399 - perf/time_per_step:1026.7599562155083 - perf/throughput:780.0507510558706 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.23958333333333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.48969655797101447
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4325 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.22916666666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.48851799242424243
[36m(TaskRunner pid=3962660)[0m step:31 - train/true_reward_mean:0.8054774403572083 - train/kept_rate_layer1:0.22916666666666666 - train/kept_rate_layer2:0.48851799242424243 - global_seqlen/min:754078 - global_seqlen/max:848381 - global_seqlen/minmax_diff:94303 - global_seqlen/balanced_min:804634 - global_seqlen/balanced_max:804634 - global_seqlen/mean:804634.0 - actor/entropy:0.1387205868959427 - actor/pg_loss:0.011265274988968045 - actor/pg_clipfrac:0.0124432182100962 - actor/ppo_kl:0.0068750874285181075 - actor/pg_clipfrac_lower:1.2031644620301743e-05 - actor/grad_norm:1.020163510227576 - perf/mfu/actor:0.28965296893434217 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.09064102172852 - actor/lr:1e-06 - critic/score/mean:0.5975686311721802 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5975686311721802 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.025242844596505165 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888513803482056 - critic/returns/mean:-0.025242844596505165 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888513803482056 - response_length/mean:405.2879638671875 - response_length/max:2048.0 - response_length/min:35.0 - response_length/clip_ratio:0.000244140625 - prompt_length/mean:380.4874267578125 - prompt_length/max:1839.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.541399776935577e-06 - timing_s/generate_sequences:51.957313537597656 - timing_s/reshard:2.4920761585235596 - timing_s/gen:306.6375107532367 - timing_s/reward filter:9.280489024706185 - timing_s/gen_layer2:133.14728679228574 - timing_s/process_data:145.78930508811027 - timing_s/reward:8.382102676667273 - timing_s/step:952.6983291488141 - timing_s/old_log_prob:71.06341995950788 - timing_s/adv:0.44317890144884586 - timing_s/update_actor:417.70738742966205 - timing_s/stop_profile:1.2880191206932068e-06 - timing_per_token_ms/update_actor:0.06489089875484724 - timing_per_token_ms/adv:6.884790187974375e-05 - timing_per_token_ms/gen:0.09235738560974371 - perf/total_num_tokens:6437072 - perf/time_per_step:952.6983291488141 - perf/throughput:844.5842460109048 - train/num_gen_batches:2
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.21354166666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4870426829268293
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3834 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.212890625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4941386340468909
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7712 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.20963541666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.47696687370600416
[36m(TaskRunner pid=3962660)[0m step:32 - train/true_reward_mean:0.8283651471138 - train/kept_rate_layer1:0.20963541666666666 - train/kept_rate_layer2:0.47696687370600416 - global_seqlen/min:749053 - global_seqlen/max:845968 - global_seqlen/minmax_diff:96915 - global_seqlen/balanced_min:783931 - global_seqlen/balanced_max:783931 - global_seqlen/mean:783931.0 - actor/entropy:0.14148610830307007 - actor/pg_loss:0.011061032162041672 - actor/pg_clipfrac:0.013223250289510111 - actor/ppo_kl:0.007338903626582294 - actor/pg_clipfrac_lower:9.906723069483352e-06 - actor/grad_norm:1.0236550202826038 - perf/mfu/actor:0.2935146930980353 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.8195686340332 - actor/lr:1e-06 - critic/score/mean:0.587778627872467 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.587778627872467 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.024034127593040466 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.024034127593040466 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:395.254638671875 - response_length/max:2048.0 - response_length/min:36.0 - response_length/clip_ratio:0.0006103515625 - prompt_length/mean:370.302978515625 - prompt_length/max:1285.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.0967254638671875e-05 - timing_s/generate_sequences:48.18116760253906 - timing_s/reshard:2.6298935413360596 - timing_s/gen:465.1510625341907 - timing_s/reward filter:14.313287748023868 - timing_s/gen_layer2:191.58614637330174 - timing_s/process_data:210.4106846889481 - timing_s/reward:11.465247354470193 - timing_s/step:1162.0329865114763 - timing_s/old_log_prob:69.37821625266224 - timing_s/adv:0.25578102841973305 - timing_s/update_actor:401.45955626666546 - timing_s/stop_profile:1.1129304766654968e-06 - timing_per_token_ms/update_actor:0.06401385394037637 - timing_per_token_ms/adv:4.07850034664615e-05 - timing_per_token_ms/gen:0.1436571010375749 - perf/total_num_tokens:6271448 - perf/time_per_step:1162.0329865114763 - perf/throughput:674.6202638820338 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.2265625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.48084291187739464
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4016 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.21744791666666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.5123502994011976
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=8123 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.23893229166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4876248864668483
[36m(TaskRunner pid=3962660)[0m step:33 - train/true_reward_mean:0.8066201210021973 - train/kept_rate_layer1:0.23893229166666666 - train/kept_rate_layer2:0.4876248864668483 - global_seqlen/min:745848 - global_seqlen/max:821343 - global_seqlen/minmax_diff:75495 - global_seqlen/balanced_min:792457 - global_seqlen/balanced_max:792457 - global_seqlen/mean:792457.0 - actor/entropy:0.14076389372348785 - actor/pg_loss:0.04960999271253111 - actor/pg_clipfrac:0.013470065636948107 - actor/ppo_kl:0.008519042653948268 - actor/pg_clipfrac_lower:1.4434506701076651e-05 - actor/grad_norm:1.0043064367491752 - perf/mfu/actor:0.29826397952057004 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:231.54113388061523 - actor/lr:1e-06 - critic/score/mean:0.5957478284835815 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5957478284835815 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.021365782245993614 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.788851022720337 - critic/returns/mean:-0.021365782245993614 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.788851022720337 - response_length/mean:402.9224853515625 - response_length/max:2048.0 - response_length/min:14.0 - response_length/clip_ratio:0.0003662109375 - prompt_length/mean:370.9613037109375 - prompt_length/max:1259.0 - prompt_length/min:47.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.127892553806305e-06 - timing_s/generate_sequences:52.678592681884766 - timing_s/reshard:2.573643207550049 - timing_s/gen:448.9723335430026 - timing_s/reward filter:13.6905468814075 - timing_s/gen_layer2:190.22001936193556 - timing_s/process_data:208.50724777579308 - timing_s/reward:12.257221018895507 - timing_s/step:1143.540091834031 - timing_s/old_log_prob:69.89985883701593 - timing_s/adv:0.28366404213011265 - timing_s/update_actor:399.4327711034566 - timing_s/stop_profile:1.1315569281578064e-06 - timing_per_token_ms/update_actor:0.06300543296094561 - timing_per_token_ms/adv:4.474439025242263e-05 - timing_per_token_ms/gen:0.13602167923596628 - perf/total_num_tokens:6339656 - perf/time_per_step:1143.540091834031 - perf/throughput:692.9857603234904 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.22330729166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4805636540330418
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3956 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.22981770833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4721435316336166
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7956 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.19466145833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.49038461538461536
[36m(TaskRunner pid=3962660)[0m step:34 - train/true_reward_mean:0.8261691927909851 - train/kept_rate_layer1:0.19466145833333334 - train/kept_rate_layer2:0.49038461538461536 - global_seqlen/min:729305 - global_seqlen/max:840922 - global_seqlen/minmax_diff:111617 - global_seqlen/balanced_min:789942 - global_seqlen/balanced_max:789943 - global_seqlen/mean:789942.375 - actor/entropy:0.1331428736448288 - actor/pg_loss:0.018056851973286814 - actor/pg_clipfrac:0.012224478756714563 - actor/ppo_kl:0.007331580835849905 - actor/pg_clipfrac_lower:1.5285565365218e-06 - actor/grad_norm:0.9743404302280396 - perf/mfu/actor:0.29083688006364006 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:229.14996719360352 - actor/lr:1e-06 - critic/score/mean:0.6053245067596436 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6053245067596436 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.025110607966780663 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.025110607966780663 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:401.9161376953125 - response_length/max:2048.0 - response_length/min:8.0 - response_length/clip_ratio:0.0003662109375 - prompt_length/mean:369.511962890625 - prompt_length/max:1910.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.1458061635494232e-05 - timing_s/generate_sequences:45.43217086791992 - timing_s/reshard:2.462587833404541 - timing_s/gen:454.2418401679024 - timing_s/reward filter:13.78707654774189 - timing_s/gen_layer2:184.85468480363488 - timing_s/process_data:203.16193284653127 - timing_s/reward:11.590271991677582 - timing_s/step:1151.069885008037 - timing_s/old_log_prob:69.4722229288891 - timing_s/adv:0.2900202441960573 - timing_s/update_actor:408.4641404263675 - timing_s/stop_profile:1.2461096048355103e-06 - timing_per_token_ms/update_actor:0.06463511664796555 - timing_per_token_ms/adv:4.589262669255737e-05 - timing_per_token_ms/gen:0.13796271953107395 - perf/total_num_tokens:6319539 - perf/time_per_step:1151.069885008037 - perf/throughput:686.2679540908017 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.23111979166666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.47007042253521125
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4005 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.23307291666666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.47358007448789574
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=8074 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.21419270833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.47213779128672745
[36m(TaskRunner pid=3962660)[0m step:35 - train/true_reward_mean:0.8282092213630676 - train/kept_rate_layer1:0.21419270833333334 - train/kept_rate_layer2:0.47213779128672745 - global_seqlen/min:710890 - global_seqlen/max:863289 - global_seqlen/minmax_diff:152399 - global_seqlen/balanced_min:789838 - global_seqlen/balanced_max:789839 - global_seqlen/mean:789838.375 - actor/entropy:0.1427861452102661 - actor/pg_loss:-0.049351822254044136 - actor/pg_clipfrac:0.011610492945747506 - actor/ppo_kl:0.006364402472399122 - actor/pg_clipfrac_lower:6.92624363559063e-06 - actor/grad_norm:0.9800751981092617 - perf/mfu/actor:0.29794630659914245 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:229.47243881225586 - actor/lr:1e-06 - critic/score/mean:0.598953902721405 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.598953902721405 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.019863422960042953 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.019863422960042953 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:403.5634765625 - response_length/max:2048.0 - response_length/min:8.0 - response_length/clip_ratio:0.0006103515625 - prompt_length/mean:367.7630615234375 - prompt_length/max:1148.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.308787614107132e-05 - timing_s/generate_sequences:50.35787582397461 - timing_s/reshard:2.549429178237915 - timing_s/gen:465.23522244859487 - timing_s/reward filter:14.155415002256632 - timing_s/gen_layer2:196.08411999978125 - timing_s/process_data:214.97691309731454 - timing_s/reward:12.509867379441857 - timing_s/step:1165.6906858468428 - timing_s/old_log_prob:70.09159426949918 - timing_s/adv:0.28519988618791103 - timing_s/update_actor:398.5598631063476 - timing_s/stop_profile:1.4230608940124512e-06 - timing_per_token_ms/update_actor:0.06307617414549331 - timing_per_token_ms/adv:4.5135798540415156e-05 - timing_per_token_ms/gen:0.14072484822969775 - perf/total_num_tokens:6318707 - perf/time_per_step:1165.6906858468428 - perf/throughput:677.5711469515635 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.203125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4776976495726496
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3577 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.22721354166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4940305635148042
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7715 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.19856770833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4663934426229508
[36m(TaskRunner pid=3962660)[0m step:36 - train/true_reward_mean:0.8372200131416321 - train/kept_rate_layer1:0.19856770833333334 - train/kept_rate_layer2:0.4663934426229508 - global_seqlen/min:736405 - global_seqlen/max:790358 - global_seqlen/minmax_diff:53953 - global_seqlen/balanced_min:767327 - global_seqlen/balanced_max:767327 - global_seqlen/mean:767327.0 - actor/entropy:0.1425624042749405 - actor/pg_loss:0.032084215519049004 - actor/pg_clipfrac:0.01296085127835452 - actor/ppo_kl:0.007930709879041924 - actor/pg_clipfrac_lower:1.0783567482636112e-05 - actor/grad_norm:1.0218285345472395 - perf/mfu/actor:0.28399458924647014 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.86677169799805 - actor/lr:1e-06 - critic/score/mean:0.6036170125007629 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6036170125007629 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.017007015645503998 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.017007015645503998 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:389.7027587890625 - response_length/max:2048.0 - response_length/min:14.0 - response_length/clip_ratio:0.0008544921875 - prompt_length/mean:359.6400146484375 - prompt_length/max:1390.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.0531395673751831e-05 - timing_s/generate_sequences:46.538639068603516 - timing_s/reshard:2.503025531768799 - timing_s/gen:457.4548415495083 - timing_s/reward filter:13.563791760243475 - timing_s/gen_layer2:184.56724202726036 - timing_s/process_data:202.55337711330503 - timing_s/reward:11.40372299682349 - timing_s/step:1149.360102568753 - timing_s/old_log_prob:67.64537257794291 - timing_s/adv:0.459468312561512 - timing_s/update_actor:406.1525884224102 - timing_s/stop_profile:1.062639057636261e-06 - timing_per_token_ms/update_actor:0.06616354377312576 - timing_per_token_ms/adv:7.484884419574575e-05 - timing_per_token_ms/gen:0.14329294366841347 - perf/total_num_tokens:6138616 - perf/time_per_step:1149.360102568753 - perf/throughput:667.6123508072611 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.205078125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4736772486772487
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3581 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.20638020833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.48370136698212407
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7261 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.21158854166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.47384615384615386
[36m(TaskRunner pid=3962660)[0m step:37 - train/true_reward_mean:0.8204172253608704 - train/kept_rate_layer1:0.21158854166666666 - train/kept_rate_layer2:0.47384615384615386 - global_seqlen/min:751053 - global_seqlen/max:847914 - global_seqlen/minmax_diff:96861 - global_seqlen/balanced_min:794615 - global_seqlen/balanced_max:794616 - global_seqlen/mean:794615.625 - actor/entropy:0.15175847709178925 - actor/pg_loss:0.00033913558640246306 - actor/pg_clipfrac:0.012584681124122732 - actor/ppo_kl:0.009200010336318402 - actor/pg_clipfrac_lower:2.23513720066514e-05 - actor/grad_norm:0.9932607947848737 - perf/mfu/actor:0.29510709133486457 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:231.2234115600586 - actor/lr:1e-06 - critic/score/mean:0.6052564382553101 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6052564382553101 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.025781642645597458 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.025781642645597458 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:404.566162109375 - response_length/max:2048.0 - response_length/min:15.0 - response_length/clip_ratio:0.000732421875 - prompt_length/mean:371.4256591796875 - prompt_length/max:1842.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.762814104557037e-06 - timing_s/generate_sequences:50.111209869384766 - timing_s/reshard:3.299421548843384 - timing_s/gen:455.33616929035634 - timing_s/reward filter:13.60660092253238 - timing_s/gen_layer2:184.3955483660102 - timing_s/process_data:202.39012110698968 - timing_s/reward:11.262174810282886 - timing_s/step:1148.3082645060495 - timing_s/old_log_prob:70.53022961691022 - timing_s/adv:0.2620803602039814 - timing_s/update_actor:404.8790142657235 - timing_s/stop_profile:1.1213123798370361e-06 - timing_per_token_ms/update_actor:0.06369101637438282 - timing_per_token_ms/adv:4.122753693082448e-05 - timing_per_token_ms/gen:0.13738921759551348 - perf/total_num_tokens:6356925 - perf/time_per_step:1148.3082645060495 - perf/throughput:691.988074597554 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.1875
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.46556712962962965
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3218 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.21223958333333334
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4993609406952965
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7125 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.20052083333333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4836309523809524
[36m(TaskRunner pid=3962660)[0m step:38 - train/true_reward_mean:0.8376415371894836 - train/kept_rate_layer1:0.20052083333333334 - train/kept_rate_layer2:0.4836309523809524 - global_seqlen/min:744549 - global_seqlen/max:842810 - global_seqlen/minmax_diff:98261 - global_seqlen/balanced_min:793000 - global_seqlen/balanced_max:793001 - global_seqlen/mean:793000.25 - actor/entropy:0.15077348053455353 - actor/pg_loss:0.04041823300152423 - actor/pg_clipfrac:0.017619454435133176 - actor/ppo_kl:0.03347227734566724 - actor/pg_clipfrac_lower:1.2562549680756076e-05 - actor/grad_norm:0.9994410937651992 - perf/mfu/actor:0.29097963222682083 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:228.53140258789062 - actor/lr:1e-06 - critic/score/mean:0.6019872426986694 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6019872426986694 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.04725659266114235 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.04725659266114235 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:403.189208984375 - response_length/max:2048.0 - response_length/min:36.0 - response_length/clip_ratio:0.002685546875 - prompt_length/mean:371.22509765625 - prompt_length/max:1688.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.0384246706962585e-05 - timing_s/generate_sequences:51.63266372680664 - timing_s/reshard:2.4105939865112305 - timing_s/gen:458.5697248335928 - timing_s/reward filter:13.750539802014828 - timing_s/gen_layer2:183.57995238061994 - timing_s/process_data:201.76382828317583 - timing_s/reward:11.102209387347102 - timing_s/step:1155.603541395627 - timing_s/old_log_prob:70.12784720491618 - timing_s/adv:0.28669993206858635 - timing_s/update_actor:409.97366071958095 - timing_s/stop_profile:1.16787850856781e-06 - timing_per_token_ms/update_actor:0.06462382274147785 - timing_per_token_ms/adv:4.519228273707769e-05 - timing_per_token_ms/gen:0.13883742016430062 - perf/total_num_tokens:6344002 - perf/time_per_step:1155.603541395627 - perf/throughput:686.221720160437 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.228515625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.48124406457739793
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4054 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.20182291666666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.44946236559139785
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7398 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.19140625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.48696145124716556
[36m(TaskRunner pid=3962660)[0m step:39 - train/true_reward_mean:0.8367326855659485 - train/kept_rate_layer1:0.19140625 - train/kept_rate_layer2:0.48696145124716556 - global_seqlen/min:741912 - global_seqlen/max:859765 - global_seqlen/minmax_diff:117853 - global_seqlen/balanced_min:786654 - global_seqlen/balanced_max:786655 - global_seqlen/mean:786654.125 - actor/entropy:0.1642778217792511 - actor/pg_loss:0.03241248469306892 - actor/pg_clipfrac:0.012196774736704477 - actor/ppo_kl:0.008226576948400304 - actor/pg_clipfrac_lower:8.635065691142353e-06 - actor/grad_norm:1.0014946029987186 - perf/mfu/actor:0.29447224237114356 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:229.26623153686523 - actor/lr:1e-06 - critic/score/mean:0.6040055155754089 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6040055155754089 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.04604291170835495 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.04604291170835495 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:404.1983642578125 - response_length/max:2048.0 - response_length/min:47.0 - response_length/clip_ratio:0.0030517578125 - prompt_length/mean:364.0185546875 - prompt_length/max:1276.0 - prompt_length/min:45.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.3500452041625977e-05 - timing_s/generate_sequences:50.202430725097656 - timing_s/reshard:2.941415786743164 - timing_s/gen:449.8490163302049 - timing_s/reward filter:13.799340356141329 - timing_s/gen_layer2:187.04967762250453 - timing_s/process_data:205.46749033033848 - timing_s/reward:11.307615240104496 - timing_s/step:1141.4101752769202 - timing_s/old_log_prob:68.94203275162727 - timing_s/adv:0.454201583750546 - timing_s/update_actor:401.7327254572883 - timing_s/stop_profile:1.0170042514801025e-06 - timing_per_token_ms/update_actor:0.06383566689129233 - timing_per_token_ms/adv:7.217301246442743e-05 - timing_per_token_ms/gen:0.13585708121822102 - perf/total_num_tokens:6293233 - perf/time_per_step:1141.4101752769202 - perf/throughput:689.1949467763839 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.21809895833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4899253731343284
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3939 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.21419270833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.49455420466058764
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7844 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.22135416666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4502450980392157
[36m(TaskRunner pid=3962660)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 40}
[36m(TaskRunner pid=3962660)[0m validation generation end
[36m(TaskRunner pid=3962660)[0m [prompt] system
[36m(TaskRunner pid=3962660)[0m You are a helpful assistant.
[36m(TaskRunner pid=3962660)[0m user
[36m(TaskRunner pid=3962660)[0m How many vertical asymptotes does the graph of $y=\frac{2}{x^2+x-6}$ have? Let's think step by step and output the final answer within \boxed{}.
[36m(TaskRunner pid=3962660)[0m assistant
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m [response] To determine the number of vertical asymptotes of the function \( y = \frac{2}{x^2 + x - 6} \), we need to identify the values of \( x \) that make the denominator zero, since vertical asymptotes occur where the function is undefined due to division by zero.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m First, we factor the denominator:
[36m(TaskRunner pid=3962660)[0m \[ x^2 + x - 6 = (x + 3)(x - 2). \]
[36m(TaskRunner pid=3962660)[0m Thus, the function can be rewritten as:
[36m(TaskRunner pid=3962660)[0m \[ y = \frac{2}{(x + 3)(x - 2)}. \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m The function is undefined where the denominator is zero, which happens when \( x + 3 = 0 \) or \( x - 2 = 0 \). Therefore, the function is undefined at \( x = -3 \) and \( x = 2 \).
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m To determine if these points are vertical asymptotes, we need to check if the limit of the function as \( x \) approaches these values goes to infinity or negative infinity. We do this by examining the behavior of the function around these values.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 1. As \( x \) approaches \(-3\) from the left, \( x + 3 \) approaches 0 from the left (a small negative number) and \( x - 2 \) is a non-zero number. Therefore, the denominator \( (x + 3)(x - 2) \) becomes a small negative number, and the function goes to \(-\infty\).
[36m(TaskRunner pid=3962660)[0m 2. As \( x \) approaches \(-3\) from the right, \( x + 3 \) approaches 0 from the right (a small positive number) and \( x - 2 \) is a non-zero number. Therefore, the denominator \( (x + 3)(x - 2) \) becomes a small positive number, and the function goes to \(+\infty\).
[36m(TaskRunner pid=3962660)[0m 3. As \( x \) approaches 2 from the left, \( x + 3 \) is a non-zero number and \( x - 2 \) approaches 0 from the left (a small negative number). Therefore, the denominator \( (x + 3)(x - 2) \) becomes a small negative number, and the function goes to \(-\infty\).
[36m(TaskRunner pid=3962660)[0m 4. As \( x \) approaches 2 from the right, \( x + 3 \) is a non-zero number and \( x - 2 \) approaches 0 from the right (a small positive number). Therefore, the denominator \( (x + 3)(x - 2) \) becomes a small positive number, and the function goes to \(+\infty\).
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Since the function goes to \(\pm\infty\) at both \( x = -3 \) and \( x = 2 \), both of these points are vertical asymptotes.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Therefore, the number of vertical asymptotes of the graph of \( y = \frac{2}{x^2 + x - 6} \) is \(\boxed{2}\).
[36m(TaskRunner pid=3962660)[0m [ground_truth] 2
[36m(TaskRunner pid=3962660)[0m [score] 1.0
[36m(TaskRunner pid=3962660)[0m len reward_extra_infos_dict['reward']: 5000
[36m(TaskRunner pid=3962660)[0m len reward_extra_infos_dict['acc']: 5000
[36m(TaskRunner pid=3962660)[0m local_global_step_folder: /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_40
[36m(TaskRunner pid=3962660)[0m step:40 - train/true_reward_mean:0.8368091583251953 - train/kept_rate_layer1:0.22135416666666666 - train/kept_rate_layer2:0.4502450980392157 - global_seqlen/min:757083 - global_seqlen/max:824715 - global_seqlen/minmax_diff:67632 - global_seqlen/balanced_min:797699 - global_seqlen/balanced_max:797700 - global_seqlen/mean:797699.875 - actor/entropy:0.19174057245254517 - actor/pg_loss:0.024845954732623913 - actor/pg_clipfrac:0.012280158378228906 - actor/ppo_kl:0.008120307468796514 - actor/pg_clipfrac_lower:1.0311932325543415e-05 - actor/grad_norm:1.007990337908268 - perf/mfu/actor:0.29145809545208257 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.92422485351562 - actor/lr:1e-06 - val-aux/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:0.666801171875 - val-core/DigitalLearningGmbH/MATH-lighteval/acc/mean@1:0.6708 - critic/score/mean:0.6092771887779236 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6092771887779236 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.05499023571610451 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.05499023571610451 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:411.0318603515625 - response_length/max:2048.0 - response_length/min:23.0 - response_length/clip_ratio:0.0023193359375 - prompt_length/mean:367.971923828125 - prompt_length/max:1193.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.1360272765159607e-05 - timing_s/generate_sequences:55.5430793762207 - timing_s/reshard:2.5268635749816895 - timing_s/gen:463.6937678074464 - timing_s/reward filter:13.723744144663215 - timing_s/gen_layer2:197.0962789412588 - timing_s/process_data:215.48079639393836 - timing_s/reward:11.912308934144676 - timing_s/step:1321.6405040677637 - timing_s/old_log_prob:70.20457448158413 - timing_s/adv:0.28974873572587967 - timing_s/update_actor:411.6339595448226 - timing_s/testing:91.88542328868061 - timing_s/save_checkpoint:52.575645035132766 - timing_s/stop_profile:1.5692785382270813e-06 - timing_per_token_ms/update_actor:0.06450326313903813 - timing_per_token_ms/adv:4.540378292742613e-05 - timing_per_token_ms/gen:0.137710111065706 - perf/total_num_tokens:6381599 - perf/time_per_step:1321.6405040677637 - perf/throughput:603.5679691601673 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.20572916666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.45121308016877637
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3422 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.20638020833333334
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.44873817034700314
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6836 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.20182291666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.460752688172043
[36m(TaskRunner pid=3962660)[0m step:41 - train/true_reward_mean:0.8364498019218445 - train/kept_rate_layer1:0.20182291666666666 - train/kept_rate_layer2:0.460752688172043 - global_seqlen/min:769052 - global_seqlen/max:836307 - global_seqlen/minmax_diff:67255 - global_seqlen/balanced_min:807172 - global_seqlen/balanced_max:807173 - global_seqlen/mean:807172.625 - actor/entropy:0.1764604151248932 - actor/pg_loss:0.0351432922844772 - actor/pg_clipfrac:0.012273673763842259 - actor/ppo_kl:0.008074512511402086 - actor/pg_clipfrac_lower:4.664691681988706e-06 - actor/grad_norm:0.9632871220819652 - perf/mfu/actor:0.2922357799184199 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.8551025390625 - actor/lr:1e-06 - critic/score/mean:0.5979893207550049 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5979893207550049 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.03871295601129532 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.03871295601129532 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:421.6163330078125 - response_length/max:2048.0 - response_length/min:30.0 - response_length/clip_ratio:0.001953125 - prompt_length/mean:366.63818359375 - prompt_length/max:1217.0 - prompt_length/min:42.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.570030331611633e-06 - timing_s/generate_sequences:52.42893600463867 - timing_s/reshard:2.5268914699554443 - timing_s/gen:461.65157469175756 - timing_s/reward filter:14.12910373043269 - timing_s/gen_layer2:190.6991533888504 - timing_s/process_data:209.3226933637634 - timing_s/reward:11.3918537190184 - timing_s/step:1173.5688964016736 - timing_s/old_log_prob:71.17290351260453 - timing_s/adv:0.27417442854493856 - timing_s/update_actor:415.61739245895296 - timing_s/stop_profile:1.3820827007293701e-06 - timing_per_token_ms/update_actor:0.06436315163360393 - timing_per_token_ms/adv:4.245907567556236e-05 - timing_per_token_ms/gen:0.13366169091863836 - perf/total_num_tokens:6457381 - perf/time_per_step:1173.5688964016736 - perf/throughput:687.7931304032547 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.18880208333333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.47313218390804596
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3293 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.189453125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.47637457044673537
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6620 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.1953125
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4498611111111111
[36m(TaskRunner pid=3962660)[0m step:42 - train/true_reward_mean:0.8532460331916809 - train/kept_rate_layer1:0.1953125 - train/kept_rate_layer2:0.4498611111111111 - global_seqlen/min:811441 - global_seqlen/max:872503 - global_seqlen/minmax_diff:61062 - global_seqlen/balanced_min:841699 - global_seqlen/balanced_max:841700 - global_seqlen/mean:841699.875 - actor/entropy:0.19144660234451294 - actor/pg_loss:0.02664395271172255 - actor/pg_clipfrac:0.011591558796046127 - actor/ppo_kl:0.007482564425901396 - actor/pg_clipfrac_lower:3.5510804436796305e-06 - actor/grad_norm:0.9602415282279253 - perf/mfu/actor:0.2941620767352804 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:228.39527893066406 - actor/lr:1e-06 - critic/score/mean:0.5926695466041565 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5926695466041565 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.04935836046934128 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.04935836046934128 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:432.4022216796875 - response_length/max:2048.0 - response_length/min:8.0 - response_length/clip_ratio:0.0028076171875 - prompt_length/mean:389.5703125 - prompt_length/max:1912.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.2596137821674347e-05 - timing_s/generate_sequences:52.14332962036133 - timing_s/reshard:2.368943452835083 - timing_s/gen:465.0446966383606 - timing_s/reward filter:13.992217076011002 - timing_s/gen_layer2:183.8366213729605 - timing_s/process_data:201.99080297909677 - timing_s/reward:10.739899695850909 - timing_s/step:1186.4394337181002 - timing_s/old_log_prob:73.89784020278603 - timing_s/adv:0.28482785634696484 - timing_s/update_actor:430.9370140871033 - timing_s/stop_profile:1.218169927597046e-06 - timing_per_token_ms/update_actor:0.06399802157614425 - timing_per_token_ms/adv:4.229949783866916e-05 - timing_per_token_ms/gen:0.13128552213398378 - perf/total_num_tokens:6733599 - perf/time_per_step:1186.4394337181002 - perf/throughput:709.4334957851621 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.189453125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.44215349369988544
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3088 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.189453125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4460194730813288
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6203 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.20572916666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4443565400843882
[36m(TaskRunner pid=3962660)[0m step:43 - train/true_reward_mean:0.8489149212837219 - train/kept_rate_layer1:0.20572916666666666 - train/kept_rate_layer2:0.4443565400843882 - global_seqlen/min:820549 - global_seqlen/max:870237 - global_seqlen/minmax_diff:49688 - global_seqlen/balanced_min:840080 - global_seqlen/balanced_max:840081 - global_seqlen/mean:840080.25 - actor/entropy:0.18059661984443665 - actor/pg_loss:0.027178210493210436 - actor/pg_clipfrac:0.011099814759723986 - actor/ppo_kl:0.008348442487929441 - actor/pg_clipfrac_lower:1.526276675923284e-05 - actor/grad_norm:0.9577236487530172 - perf/mfu/actor:0.28621241601661823 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:228.53911209106445 - actor/lr:1e-06 - critic/score/mean:0.5977186560630798 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5977186560630798 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.0449838750064373 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.0449838750064373 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:433.7926025390625 - response_length/max:2048.0 - response_length/min:20.0 - response_length/clip_ratio:0.0032958984375 - prompt_length/mean:386.5982666015625 - prompt_length/max:1864.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.1446885764598846e-05 - timing_s/generate_sequences:54.94369888305664 - timing_s/reshard:3.456399440765381 - timing_s/gen:470.372795692645 - timing_s/reward filter:13.761416858062148 - timing_s/gen_layer2:189.2742469785735 - timing_s/process_data:207.3719705780968 - timing_s/reward:10.808394308201969 - timing_s/step:1208.2429120969027 - timing_s/old_log_prob:73.86303705722094 - timing_s/adv:0.2865902315825224 - timing_s/update_actor:442.3008635127917 - timing_s/stop_profile:1.3299286365509033e-06 - timing_per_token_ms/update_actor:0.06581229345541567 - timing_per_token_ms/adv:4.264328193385727e-05 - timing_per_token_ms/gen:0.13236406943230286 - perf/total_num_tokens:6720642 - perf/time_per_step:1208.2429120969027 - perf/throughput:695.2908571522614 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.20638020833333334
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4400630914826498
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3348 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.18880208333333334
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.46551724137931033
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6588 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.1953125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4625
[36m(TaskRunner pid=3962660)[0m step:44 - train/true_reward_mean:0.8575177192687988 - train/kept_rate_layer1:0.1953125 - train/kept_rate_layer2:0.4625 - global_seqlen/min:812527 - global_seqlen/max:878228 - global_seqlen/minmax_diff:65701 - global_seqlen/balanced_min:853448 - global_seqlen/balanced_max:853449 - global_seqlen/mean:853448.25 - actor/entropy:0.1918034851551056 - actor/pg_loss:0.09339857242527862 - actor/pg_clipfrac:0.011987221069334324 - actor/ppo_kl:0.007108616147232541 - actor/pg_clipfrac_lower:9.314215111027641e-06 - actor/grad_norm:0.9621768827782944 - perf/mfu/actor:0.2789281617230865 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.6098175048828 - actor/lr:1e-06 - critic/score/mean:0.6012284755706787 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6012284755706787 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.04567212238907814 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.04567212238907814 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:443.3887939453125 - response_length/max:2048.0 - response_length/min:12.0 - response_length/clip_ratio:0.003173828125 - prompt_length/mean:390.0567626953125 - prompt_length/max:1415.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.2975186109542847e-05 - timing_s/generate_sequences:55.98451232910156 - timing_s/reshard:3.0648767948150635 - timing_s/gen:472.4879771890119 - timing_s/reward filter:13.927983274683356 - timing_s/gen_layer2:195.71740676276386 - timing_s/process_data:214.2045185090974 - timing_s/reward:10.903989177197218 - timing_s/step:1237.2133486075327 - timing_s/old_log_prob:74.69003067724407 - timing_s/adv:0.2935458878055215 - timing_s/update_actor:461.1402196502313 - timing_s/stop_profile:1.1818483471870422e-06 - timing_per_token_ms/update_actor:0.06754074128838967 - timing_per_token_ms/adv:4.2994095981437874e-05 - timing_per_token_ms/gen:0.13008167056894404 - perf/total_num_tokens:6827586 - perf/time_per_step:1237.2133486075327 - perf/throughput:689.814938515289 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.212890625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.43934760448521915
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3448 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.18229166666666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.45148809523809524
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6482 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.18098958333333334
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.44319544364508395
[36m(TaskRunner pid=3962660)[0m step:45 - train/true_reward_mean:0.8360390663146973 - train/kept_rate_layer1:0.18098958333333334 - train/kept_rate_layer2:0.44319544364508395 - global_seqlen/min:809043 - global_seqlen/max:902101 - global_seqlen/minmax_diff:93058 - global_seqlen/balanced_min:848702 - global_seqlen/balanced_max:848703 - global_seqlen/mean:848702.125 - actor/entropy:0.21317395567893982 - actor/pg_loss:0.0015035893589984404 - actor/pg_clipfrac:0.012024321135998304 - actor/ppo_kl:0.007394833694942939 - actor/pg_clipfrac_lower:7.421475380570406e-06 - actor/grad_norm:0.944795006653294 - perf/mfu/actor:0.29041024948928257 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.34871292114258 - actor/lr:1e-06 - critic/score/mean:0.5946418046951294 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.5946418046951294 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.054205697029829025 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.054205697029829025 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:443.53271484375 - response_length/max:2048.0 - response_length/min:28.0 - response_length/clip_ratio:0.003173828125 - prompt_length/mean:385.2779541015625 - prompt_length/max:1434.0 - prompt_length/min:43.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.512528777122498e-06 - timing_s/generate_sequences:54.60057830810547 - timing_s/reshard:2.4261677265167236 - timing_s/gen:473.04542657453567 - timing_s/reward filter:13.763797111809254 - timing_s/gen_layer2:195.51711837761104 - timing_s/process_data:213.37463274691254 - timing_s/reward:10.854794615879655 - timing_s/step:1215.5735271601006 - timing_s/old_log_prob:74.33830966148525 - timing_s/adv:0.26721729524433613 - timing_s/update_actor:440.27686113491654 - timing_s/stop_profile:3.968365490436554e-06 - timing_per_token_ms/update_actor:0.06484561075166928 - timing_per_token_ms/adv:3.9356755358120515e-05 - timing_per_token_ms/gen:0.13019288344714777 - perf/total_num_tokens:6789617 - perf/time_per_step:1215.5735271601006 - perf/throughput:698.1906943817634 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.20182291666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4389784946236559
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3266 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.19140625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4403344671201814
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6373 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.19075520833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.40998293515358364
[36m(TaskRunner pid=3962660)[0m step:46 - train/true_reward_mean:0.8316701054573059 - train/kept_rate_layer1:0.19075520833333334 - train/kept_rate_layer2:0.40998293515358364 - global_seqlen/min:769598 - global_seqlen/max:887349 - global_seqlen/minmax_diff:117751 - global_seqlen/balanced_min:847039 - global_seqlen/balanced_max:847040 - global_seqlen/mean:847039.125 - actor/entropy:0.20372694730758667 - actor/pg_loss:0.09796578455841849 - actor/pg_clipfrac:0.011765367305028241 - actor/ppo_kl:0.0068942201451681106 - actor/pg_clipfrac_lower:6.69595277951863e-06 - actor/grad_norm:0.9354065365623683 - perf/mfu/actor:0.2899172100148879 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:227.8992576599121 - actor/lr:1e-06 - critic/score/mean:0.6066022515296936 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6066022515296936 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.05468098074197769 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.05468098074197769 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:445.1826171875 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.0030517578125 - prompt_length/mean:382.0040283203125 - prompt_length/max:1236.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.083221286535263e-05 - timing_s/generate_sequences:53.627166748046875 - timing_s/reshard:3.3729958534240723 - timing_s/gen:479.8582387631759 - timing_s/reward filter:14.211569805629551 - timing_s/gen_layer2:193.02952586393803 - timing_s/process_data:211.5325298057869 - timing_s/reward:11.370249401777983 - timing_s/step:1221.1611463036388 - timing_s/old_log_prob:74.29997937567532 - timing_s/adv:0.2901475252583623 - timing_s/update_actor:440.2298583500087 - timing_s/stop_profile:1.1585652828216553e-06 - timing_per_token_ms/update_actor:0.06496598642211608 - timing_per_token_ms/adv:4.2817904848604586e-05 - timing_per_token_ms/gen:0.13157846443238266 - perf/total_num_tokens:6776313 - perf/time_per_step:1221.1611463036388 - perf/throughput:693.634191985163 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.177734375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.42353479853479853
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2775 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.17643229166666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.46571340713407133
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5804 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.1796875
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4320652173913043
[36m(TaskRunner pid=3962660)[0m step:47 - train/true_reward_mean:0.8525670170783997 - train/kept_rate_layer1:0.1796875 - train/kept_rate_layer2:0.4320652173913043 - global_seqlen/min:797416 - global_seqlen/max:901693 - global_seqlen/minmax_diff:104277 - global_seqlen/balanced_min:847731 - global_seqlen/balanced_max:847732 - global_seqlen/mean:847731.625 - actor/entropy:0.21564653515815735 - actor/pg_loss:0.01410443291643629 - actor/pg_clipfrac:0.012105231165781528 - actor/ppo_kl:0.008265734661486196 - actor/pg_clipfrac_lower:6.077993128195976e-06 - actor/grad_norm:0.9765670630149543 - perf/mfu/actor:0.2886292311960499 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:227.8477020263672 - actor/lr:1e-06 - critic/score/mean:0.6104092001914978 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6104092001914978 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.055330920964479446 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.055330920964479446 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:446.148193359375 - response_length/max:2048.0 - response_length/min:8.0 - response_length/clip_ratio:0.0028076171875 - prompt_length/mean:381.7147216796875 - prompt_length/max:1343.0 - prompt_length/min:41.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.389719545841217e-05 - timing_s/generate_sequences:51.09031677246094 - timing_s/reshard:2.4206607341766357 - timing_s/gen:459.85934782307595 - timing_s/reward filter:13.991605214774609 - timing_s/gen_layer2:181.83528787549585 - timing_s/process_data:199.59615071862936 - timing_s/reward:9.894136833027005 - timing_s/step:1189.834464664571 - timing_s/old_log_prob:74.47342498414218 - timing_s/adv:0.2826401526108384 - timing_s/update_actor:442.6048093410209 - timing_s/stop_profile:1.319684088230133e-06 - timing_per_token_ms/update_actor:0.0652631086726623 - timing_per_token_ms/adv:4.167594794679838e-05 - timing_per_token_ms/gen:0.12582181241646734 - perf/total_num_tokens:6781853 - perf/time_per_step:1189.834464664571 - perf/throughput:712.4786263768095 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.20833333333333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.43268229166666666
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3323 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.20182291666666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.432258064516129
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6539 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.18619791666666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4256993006993007
[36m(TaskRunner pid=3962660)[0m step:48 - train/true_reward_mean:0.8524829745292664 - train/kept_rate_layer1:0.18619791666666666 - train/kept_rate_layer2:0.4256993006993007 - global_seqlen/min:752633 - global_seqlen/max:884535 - global_seqlen/minmax_diff:131902 - global_seqlen/balanced_min:832049 - global_seqlen/balanced_max:832050 - global_seqlen/mean:832049.375 - actor/entropy:0.228793203830719 - actor/pg_loss:-0.02513645176470074 - actor/pg_clipfrac:0.01160845430150051 - actor/ppo_kl:0.0075265420069861345 - actor/pg_clipfrac_lower:2.6512400395711143e-06 - actor/grad_norm:1.0019768110942096 - perf/mfu/actor:0.28872558140249305 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:230.00249862670898 - actor/lr:1e-06 - critic/score/mean:0.6079960465431213 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6079960465431213 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.056315261870622635 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.056315261870622635 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:438.4010009765625 - response_length/max:2048.0 - response_length/min:28.0 - response_length/clip_ratio:0.003662109375 - prompt_length/mean:374.147216796875 - prompt_length/max:1339.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.17570161819458e-05 - timing_s/generate_sequences:52.701663970947266 - timing_s/reshard:2.4324793815612793 - timing_s/gen:479.2862184289843 - timing_s/reward filter:13.974154831841588 - timing_s/gen_layer2:195.05316244624555 - timing_s/process_data:213.37139211874455 - timing_s/reward:11.117222594097257 - timing_s/step:1214.85659282282 - timing_s/old_log_prob:73.3153445450589 - timing_s/adv:0.28515672218054533 - timing_s/update_actor:434.09820198919624 - timing_s/stop_profile:1.0784715414047241e-06 - timing_per_token_ms/update_actor:0.06521521063416402 - timing_per_token_ms/adv:4.283951330720988e-05 - timing_per_token_ms/gen:0.13345457316530446 - perf/total_num_tokens:6656395 - perf/time_per_step:1214.85659282282 - perf/throughput:684.8951389946893 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.17578125
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.43503086419753084
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2819 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.16861979166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4354890604890605
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5526 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.17578125
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4595679012345679
[36m(TaskRunner pid=3962660)[0m step:49 - train/true_reward_mean:0.8553187251091003 - train/kept_rate_layer1:0.17578125 - train/kept_rate_layer2:0.4595679012345679 - global_seqlen/min:774969 - global_seqlen/max:886779 - global_seqlen/minmax_diff:111810 - global_seqlen/balanced_min:817100 - global_seqlen/balanced_max:817100 - global_seqlen/mean:817100.0 - actor/entropy:0.2083919495344162 - actor/pg_loss:0.05117378919873567 - actor/pg_clipfrac:0.011598356338518282 - actor/ppo_kl:0.0067188642241339655 - actor/pg_clipfrac_lower:1.825583768227408e-06 - actor/grad_norm:0.9703886352945119 - perf/mfu/actor:0.2949231068383543 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:229.94127655029297 - actor/lr:1e-06 - critic/score/mean:0.6329089403152466 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6329089403152466 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.036461327224969864 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.036461327224969864 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:422.3773193359375 - response_length/max:2048.0 - response_length/min:19.0 - response_length/clip_ratio:0.0009765625 - prompt_length/mean:375.5718994140625 - prompt_length/max:1408.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.745118975639343e-06 - timing_s/generate_sequences:45.1717643737793 - timing_s/reshard:2.390162467956543 - timing_s/gen:464.63584948983043 - timing_s/reward filter:13.823227507062256 - timing_s/gen_layer2:167.48102940339595 - timing_s/process_data:184.9749915068969 - timing_s/reward:9.554412994533777 - timing_s/step:1151.67534357775 - timing_s/old_log_prob:71.98367272783071 - timing_s/adv:0.24602225236594677 - timing_s/update_actor:417.02464783750474 - timing_s/stop_profile:1.171603798866272e-06 - timing_per_token_ms/update_actor:0.06379645206178937 - timing_per_token_ms/adv:3.7636496812805464e-05 - timing_per_token_ms/gen:0.13428335459654678 - perf/total_num_tokens:6536800 - perf/time_per_step:1151.67534357775 - perf/throughput:709.4881422585889 - train/num_gen_batches:3
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.16276041666666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.416
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2496 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.16536458333333334
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4210958005249344
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5063 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.17317708333333334
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4519110275689223
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7948 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.17447916666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.44029850746268656
[36m(TaskRunner pid=3962660)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 50}
[36m(TaskRunner pid=3962660)[0m validation generation end
[36m(TaskRunner pid=3962660)[0m [prompt] system
[36m(TaskRunner pid=3962660)[0m You are a helpful assistant.
[36m(TaskRunner pid=3962660)[0m user
[36m(TaskRunner pid=3962660)[0m How many vertical asymptotes does the graph of $y=\frac{2}{x^2+x-6}$ have? Let's think step by step and output the final answer within \boxed{}.
[36m(TaskRunner pid=3962660)[0m assistant
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m [response] To determine the number of vertical asymptotes of the function \( y = \frac{2}{x^2 + x - 6} \), we need to find the values of \( x \) that make the denominator zero, since vertical asymptotes occur where the function approaches infinity due to division by zero.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m First, we factor the denominator:
[36m(TaskRunner pid=3962660)[0m \[ x^2 + x - 6 = (x + 3)(x - 2). \]
[36m(TaskRunner pid=3962660)[0m Thus, the function can be rewritten as:
[36m(TaskRunner pid=3962660)[0m \[ y = \frac{2}{(x + 3)(x - 2)}. \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m The vertical asymptotes occur where the denominator is zero and the numerator is non-zero. Therefore, we need to solve the equation:
[36m(TaskRunner pid=3962660)[0m \[ (x + 3)(x - 2) = 0. \]
[36m(TaskRunner pid=3962660)[0m This gives us two solutions:
[36m(TaskRunner pid=3962660)[0m \[ x + 3 = 0 \implies x = -3, \]
[36m(TaskRunner pid=3962660)[0m \[ x - 2 = 0 \implies x = 2. \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m We need to check if these solutions make the numerator zero. The numerator is 2, which is non-zero for all \( x \). Therefore, the function has vertical asymptotes at \( x = -3 \) and \( x = 2 \).
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Thus, the function \( y = \frac{2}{x^2 + x - 6} \) has 2 vertical asymptotes.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m The final answer is:
[36m(TaskRunner pid=3962660)[0m \[ \boxed{2} \]
[36m(TaskRunner pid=3962660)[0m [ground_truth] 2
[36m(TaskRunner pid=3962660)[0m [score] 1.0
[36m(TaskRunner pid=3962660)[0m len reward_extra_infos_dict['reward']: 5000
[36m(TaskRunner pid=3962660)[0m len reward_extra_infos_dict['acc']: 5000
[36m(TaskRunner pid=3962660)[0m step:50 - train/true_reward_mean:0.8627758026123047 - train/kept_rate_layer1:0.17447916666666666 - train/kept_rate_layer2:0.44029850746268656 - global_seqlen/min:777152 - global_seqlen/max:884608 - global_seqlen/minmax_diff:107456 - global_seqlen/balanced_min:817731 - global_seqlen/balanced_max:817732 - global_seqlen/mean:817731.875 - actor/entropy:0.23983322083950043 - actor/pg_loss:0.03205728145141977 - actor/pg_clipfrac:0.013258640901856925 - actor/ppo_kl:0.009156049704351469 - actor/pg_clipfrac_lower:1.3212638370052803e-05 - actor/grad_norm:1.017564935144037 - perf/mfu/actor:0.28650130919418754 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:228.0758514404297 - actor/lr:1e-06 - val-aux/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:0.654153515625 - val-core/DigitalLearningGmbH/MATH-lighteval/acc/mean@1:0.6562 - critic/score/mean:0.6127896308898926 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6127896308898926 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.05617779865860939 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.05617779865860939 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:433.6669921875 - response_length/max:2048.0 - response_length/min:20.0 - response_length/clip_ratio:0.003662109375 - prompt_length/mean:364.8992919921875 - prompt_length/max:1337.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.4103949069976807e-05 - timing_s/generate_sequences:48.382568359375 - timing_s/reshard:3.684706687927246 - timing_s/gen:619.0809462470934 - timing_s/reward filter:18.4602991072461 - timing_s/gen_layer2:234.58745694439858 - timing_s/process_data:257.94819283206016 - timing_s/reward:12.571159474551678 - timing_s/step:1487.0182102741674 - timing_s/old_log_prob:71.80467176809907 - timing_s/adv:0.4750513443723321 - timing_s/update_actor:429.71422680374235 - timing_s/testing:91.21105647739023 - timing_s/stop_profile:1.0738149285316467e-06 - timing_per_token_ms/update_actor:0.0656869078883195 - timing_per_token_ms/adv:7.26172231534224e-05 - timing_per_token_ms/gen:0.17426137089655278 - perf/total_num_tokens:6541855 - perf/time_per_step:1487.0182102741674 - perf/throughput:549.9138271139474 - train/num_gen_batches:4
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.16015625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4078590785907859
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2408 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.17122395833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.41777566539923955
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5045 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.15755208333333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4612603305785124
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7724 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.18815104166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.44232987312572086
[36m(TaskRunner pid=3962660)[0m step:51 - train/true_reward_mean:0.8444075584411621 - train/kept_rate_layer1:0.18815104166666666 - train/kept_rate_layer2:0.44232987312572086 - global_seqlen/min:771132 - global_seqlen/max:862728 - global_seqlen/minmax_diff:91596 - global_seqlen/balanced_min:808187 - global_seqlen/balanced_max:808188 - global_seqlen/mean:808187.375 - actor/entropy:0.1705283522605896 - actor/pg_loss:-0.025524720408776333 - actor/pg_clipfrac:0.011262745548793602 - actor/ppo_kl:0.007964039680934678 - actor/pg_clipfrac_lower:8.841304917864147e-06 - actor/grad_norm:0.9379057490732521 - perf/mfu/actor:0.2932797614145536 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:228.57351303100586 - actor/lr:1e-06 - critic/score/mean:0.6284929513931274 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6284929513931274 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.030987948179244995 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.030987948179244995 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:420.6549072265625 - response_length/max:2048.0 - response_length/min:14.0 - response_length/clip_ratio:0.0008544921875 - prompt_length/mean:368.590576171875 - prompt_length/max:1970.0 - prompt_length/min:41.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.2974254786968231e-05 - timing_s/generate_sequences:46.71859359741211 - timing_s/reshard:2.474714756011963 - timing_s/gen:610.0932031348348 - timing_s/reward filter:18.380179970525205 - timing_s/gen_layer2:231.78345571644604 - timing_s/process_data:254.9624806707725 - timing_s/reward:12.563852761872113 - timing_s/step:1368.5621833130717 - timing_s/old_log_prob:71.173150440678 - timing_s/adv:0.2888269489631057 - timing_s/update_actor:414.67482991702855 - timing_s/stop_profile:1.3541430234909058e-06 - timing_per_token_ms/update_actor:0.06413655464443326 - timing_per_token_ms/adv:4.4672027474307194e-05 - timing_per_token_ms/gen:0.17704362098570223 - perf/total_num_tokens:6465499 - perf/time_per_step:1368.5621833130717 - perf/throughput:590.5375618691338 - train/num_gen_batches:4
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.16015625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.42208672086720866
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2492 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.169921875
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.39383780332056195
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4959 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.173828125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.42946317103620474
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7711 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.15885416666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.43084016393442626
[36m(TaskRunner pid=3962660)[0m step:52 - train/true_reward_mean:0.8652215003967285 - train/kept_rate_layer1:0.15885416666666666 - train/kept_rate_layer2:0.43084016393442626 - global_seqlen/min:769851 - global_seqlen/max:852148 - global_seqlen/minmax_diff:82297 - global_seqlen/balanced_min:819170 - global_seqlen/balanced_max:819171 - global_seqlen/mean:819170.75 - actor/entropy:0.17592379450798035 - actor/pg_loss:-0.00193916702783885 - actor/pg_clipfrac:0.01111692182103856 - actor/ppo_kl:0.009655936477856026 - actor/pg_clipfrac_lower:4.8690263712261285e-06 - actor/grad_norm:0.9765846668742597 - perf/mfu/actor:0.287941853208717 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:228.10761642456055 - actor/lr:1e-06 - critic/score/mean:0.6297454833984375 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6297454833984375 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.03310559317469597 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.03310559317469597 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:425.02783203125 - response_length/max:2048.0 - response_length/min:24.0 - response_length/clip_ratio:0.000732421875 - prompt_length/mean:374.943603515625 - prompt_length/max:1941.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.4013610780239105e-05 - timing_s/generate_sequences:48.05152130126953 - timing_s/reshard:3.6525609493255615 - timing_s/gen:625.55998454988 - timing_s/reward filter:18.192529424093664 - timing_s/gen_layer2:229.79630794934928 - timing_s/process_data:252.81249428819865 - timing_s/reward:12.406111893244088 - timing_s/step:1396.1849730750546 - timing_s/old_log_prob:72.32891458366066 - timing_s/adv:0.4926213063299656 - timing_s/update_actor:428.24681905377656 - timing_s/stop_profile:1.2023374438285828e-06 - timing_per_token_ms/update_actor:0.06534761205978372 - timing_per_token_ms/adv:7.517073002331406e-05 - timing_per_token_ms/gen:0.17966424089583977 - perf/total_num_tokens:6553366 - perf/time_per_step:1396.1849730750546 - perf/throughput:586.7207897215808 - train/num_gen_batches:4
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.154296875
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3948663853727145
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2246 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.15885416666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.413422131147541
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4667 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.162109375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.40227576974564927
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7071 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.14908854166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4430494905385735
[36m(TaskRunner pid=3962660)[0m step:53 - train/true_reward_mean:0.8664982914924622 - train/kept_rate_layer1:0.14908854166666666 - train/kept_rate_layer2:0.4430494905385735 - global_seqlen/min:756243 - global_seqlen/max:863537 - global_seqlen/minmax_diff:107294 - global_seqlen/balanced_min:817060 - global_seqlen/balanced_max:817061 - global_seqlen/mean:817060.875 - actor/entropy:0.13179373741149902 - actor/pg_loss:0.00757919666430098 - actor/pg_clipfrac:0.01151467019899428 - actor/ppo_kl:0.009138998134312714 - actor/pg_clipfrac_lower:5.255377072899137e-06 - actor/grad_norm:0.9249549021478742 - perf/mfu/actor:0.28875790671588236 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:228.22608184814453 - actor/lr:1e-06 - critic/score/mean:0.6205244660377502 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6205244660377502 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.024149587377905846 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.788851261138916 - critic/returns/mean:-0.024149587377905846 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.788851261138916 - response_length/mean:429.4073486328125 - response_length/max:2048.0 - response_length/min:34.0 - response_length/clip_ratio:0.0006103515625 - prompt_length/mean:368.503662109375 - prompt_length/max:1435.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.844111829996109e-05 - timing_s/generate_sequences:40.56671142578125 - timing_s/reshard:2.328394889831543 - timing_s/gen:623.897041737102 - timing_s/reward filter:18.31344000995159 - timing_s/gen_layer2:213.50567085575312 - timing_s/process_data:236.41729579120874 - timing_s/reward:11.510137816891074 - timing_s/step:1373.664729888551 - timing_s/old_log_prob:71.75479777995497 - timing_s/adv:0.26401154417544603 - timing_s/update_actor:425.7813070360571 - timing_s/stop_profile:1.2991949915885925e-06 - timing_per_token_ms/update_actor:0.06513916527885041 - timing_per_token_ms/adv:4.039043360377616e-05 - timing_per_token_ms/gen:0.17735911389303594 - perf/total_num_tokens:6536487 - perf/time_per_step:1373.664729888551 - perf/throughput:594.8037080826049 - train/num_gen_batches:4
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.14388020833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.41855203619909503
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2220 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.15104166666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.42474856321839083
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4585 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.158203125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4207818930041152
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7039 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.14908854166666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.440684133915575
[36m(TaskRunner pid=3962660)[0m step:54 - train/true_reward_mean:0.8734092712402344 - train/kept_rate_layer1:0.14908854166666666 - train/kept_rate_layer2:0.440684133915575 - global_seqlen/min:749517 - global_seqlen/max:824745 - global_seqlen/minmax_diff:75228 - global_seqlen/balanced_min:787424 - global_seqlen/balanced_max:787425 - global_seqlen/mean:787424.875 - actor/entropy:0.17411720752716064 - actor/pg_loss:0.03697081484204652 - actor/pg_clipfrac:0.01192585883094283 - actor/ppo_kl:0.008637460107740084 - actor/pg_clipfrac_lower:1.3132665946218027e-05 - actor/grad_norm:0.9528036962728947 - perf/mfu/actor:0.2958033459134565 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:227.5001335144043 - actor/lr:1e-06 - critic/score/mean:0.624519407749176 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.624519407749176 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.03154878318309784 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.03154878318309784 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:411.9385986328125 - response_length/max:2048.0 - response_length/min:7.0 - response_length/clip_ratio:0.000732421875 - prompt_length/mean:357.031005859375 - prompt_length/max:1400.0 - prompt_length/min:43.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.3804994523525238e-05 - timing_s/generate_sequences:41.51544952392578 - timing_s/reshard:2.276538133621216 - timing_s/gen:617.2767165284604 - timing_s/reward filter:18.108669663779438 - timing_s/gen_layer2:218.40207845903933 - timing_s/process_data:240.74012724868953 - timing_s/reward:11.081212821416557 - timing_s/step:1343.1815805975348 - timing_s/old_log_prob:69.23844546545297 - timing_s/adv:0.4658993734046817 - timing_s/update_actor:400.24727725051343 - timing_s/stop_profile:1.0980293154716492e-06 - timing_per_token_ms/update_actor:0.06353737511316769 - timing_per_token_ms/adv:7.395933697876285e-05 - timing_per_token_ms/gen:0.1829184299205922 - perf/total_num_tokens:6299399 - perf/time_per_step:1343.1815805975348 - perf/throughput:586.2385893124756 - train/num_gen_batches:4
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.15494791666666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4163165266106443
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2378 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.162109375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.41214859437751006
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4841 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.15625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.41180555555555554
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7213 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.13606770833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3761961722488038
[36m(TaskRunner pid=3962660)[0m step:55 - train/true_reward_mean:0.8779398798942566 - train/kept_rate_layer1:0.13606770833333334 - train/kept_rate_layer2:0.3761961722488038 - global_seqlen/min:775379 - global_seqlen/max:883505 - global_seqlen/minmax_diff:108126 - global_seqlen/balanced_min:836671 - global_seqlen/balanced_max:836672 - global_seqlen/mean:836671.625 - actor/entropy:0.17344270646572113 - actor/pg_loss:-0.01609423302331979 - actor/pg_clipfrac:0.011397704444040112 - actor/ppo_kl:0.007975802731072396 - actor/pg_clipfrac_lower:6.309021151083943e-06 - actor/grad_norm:0.9657966722734272 - perf/mfu/actor:0.2916429327417421 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:227.6745834350586 - actor/lr:1e-06 - critic/score/mean:0.6290900707244873 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6290900707244873 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.0365726500749588 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888519763946533 - critic/returns/mean:-0.0365726500749588 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888519763946533 - response_length/mean:435.4619140625 - response_length/max:2048.0 - response_length/min:15.0 - response_length/clip_ratio:0.0015869140625 - prompt_length/mean:381.6002197265625 - prompt_length/max:1262.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.360476016998291e-05 - timing_s/generate_sequences:43.16181945800781 - timing_s/reshard:2.2737481594085693 - timing_s/gen:629.0646013366058 - timing_s/reward filter:18.414811522699893 - timing_s/gen_layer2:219.11218973994255 - timing_s/process_data:242.06196384411305 - timing_s/reward:11.628674522973597 - timing_s/step:1392.7423540391028 - timing_s/old_log_prob:73.40949042700231 - timing_s/adv:0.2863047393038869 - timing_s/update_actor:432.0236618593335 - timing_s/stop_profile:1.234002411365509e-06 - timing_per_token_ms/update_actor:0.0645449852950573 - timing_per_token_ms/adv:4.277435895233791e-05 - timing_per_token_ms/gen:0.17634174192516416 - perf/total_num_tokens:6693373 - perf/time_per_step:1392.7423540391028 - perf/throughput:600.7368287275548 - train/num_gen_batches:4
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.134765625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.36513687600644124
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=1814 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.14192708333333334
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.40978593272171254
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3958 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.158203125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4024348422496571
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6305 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.15885416666666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.41598360655737704
[36m(TaskRunner pid=3962660)[0m step:56 - train/true_reward_mean:0.8756268620491028 - train/kept_rate_layer1:0.15885416666666666 - train/kept_rate_layer2:0.41598360655737704 - global_seqlen/min:828467 - global_seqlen/max:885183 - global_seqlen/minmax_diff:56716 - global_seqlen/balanced_min:855577 - global_seqlen/balanced_max:855578 - global_seqlen/mean:855577.125 - actor/entropy:0.23223376274108887 - actor/pg_loss:0.021861461041019544 - actor/pg_clipfrac:0.015201220030687818 - actor/ppo_kl:0.03104546613068358 - actor/pg_clipfrac_lower:0.00010987185048899311 - actor/grad_norm:0.9869909614790231 - perf/mfu/actor:0.29397874650892836 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:227.2900619506836 - actor/lr:1e-06 - critic/score/mean:0.6268994808197021 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6268994808197021 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.05194581300020218 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.05194581300020218 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:451.126220703125 - response_length/max:2048.0 - response_length/min:15.0 - response_length/clip_ratio:0.0028076171875 - prompt_length/mean:384.3983154296875 - prompt_length/max:1243.0 - prompt_length/min:43.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.2589618563652039e-05 - timing_s/generate_sequences:44.06934356689453 - timing_s/reshard:2.338887929916382 - timing_s/gen:631.9139253767207 - timing_s/reward filter:18.69970780517906 - timing_s/gen_layer2:224.20432827901095 - timing_s/process_data:247.0886913407594 - timing_s/reward:11.570519221015275 - timing_s/step:1408.7871610680595 - timing_s/old_log_prob:75.72200459986925 - timing_s/adv:0.2674801293760538 - timing_s/update_actor:438.49475113581866 - timing_s/stop_profile:1.0514631867408752e-06 - timing_per_token_ms/update_actor:0.06406417643760325 - timing_per_token_ms/adv:3.9078903812449084e-05 - timing_per_token_ms/gen:0.17098968493476363 - perf/total_num_tokens:6844617 - perf/time_per_step:1408.7871610680595 - perf/throughput:607.314680772184 - train/num_gen_batches:4
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.146484375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4087037037037037
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2207 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.150390625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.38203463203463206
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4325 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.14322916666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.41704545454545455
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6527 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.13736979166666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4075829383886256
[36m(TaskRunner pid=3962660)[0m step:57 - train/true_reward_mean:0.8759541511535645 - train/kept_rate_layer1:0.13736979166666666 - train/kept_rate_layer2:0.4075829383886256 - global_seqlen/min:810364 - global_seqlen/max:889621 - global_seqlen/minmax_diff:79257 - global_seqlen/balanced_min:837505 - global_seqlen/balanced_max:837506 - global_seqlen/mean:837505.625 - actor/entropy:0.2202928215265274 - actor/pg_loss:0.015983315566858357 - actor/pg_clipfrac:0.011832790473846267 - actor/ppo_kl:0.010568102610673886 - actor/pg_clipfrac_lower:1.410843304832761e-05 - actor/grad_norm:0.9671227895887569 - perf/mfu/actor:0.29844068506021987 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:227.59624862670898 - actor/lr:1e-06 - critic/score/mean:0.6175922155380249 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6175922155380249 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.04777604714035988 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.04777604714035988 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:437.4593505859375 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.002685546875 - prompt_length/mean:380.417236328125 - prompt_length/max:1461.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.79903581738472e-05 - timing_s/generate_sequences:43.93090057373047 - timing_s/reshard:2.3095808029174805 - timing_s/gen:630.9046379942447 - timing_s/reward filter:18.447664636187255 - timing_s/gen_layer2:221.91945026163012 - timing_s/process_data:244.4777232091874 - timing_s/reward:10.941849615424871 - timing_s/step:1386.3756944835186 - timing_s/old_log_prob:73.48369296360761 - timing_s/adv:0.2861997578293085 - timing_s/update_actor:422.5890413084999 - timing_s/stop_profile:1.364387571811676e-06 - timing_per_token_ms/update_actor:0.0630725676183518 - timing_per_token_ms/adv:4.271609486642381e-05 - timing_per_token_ms/gen:0.17605001748048707 - perf/total_num_tokens:6700045 - perf/time_per_step:1386.3756944835186 - perf/throughput:604.0971638009024 - train/num_gen_batches:4
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.1640625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.41980820105820105
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2539 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.1484375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3934576023391813
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4692 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.15559895833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.37011854951185497
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6815 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.154296875
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3871308016877637
[36m(TaskRunner pid=3962660)[0m step:58 - train/true_reward_mean:0.8649609684944153 - train/kept_rate_layer1:0.154296875 - train/kept_rate_layer2:0.3871308016877637 - global_seqlen/min:820811 - global_seqlen/max:917120 - global_seqlen/minmax_diff:96309 - global_seqlen/balanced_min:872911 - global_seqlen/balanced_max:872912 - global_seqlen/mean:872911.75 - actor/entropy:0.3000994920730591 - actor/pg_loss:0.00038426079988187437 - actor/pg_clipfrac:0.012241146608101888 - actor/ppo_kl:0.009291425761110061 - actor/pg_clipfrac_lower:9.69541773685262e-06 - actor/grad_norm:1.0031149588758126 - perf/mfu/actor:0.28494931587991634 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:227.1339340209961 - actor/lr:1e-06 - critic/score/mean:0.6193001866340637 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6193001866340637 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.0790361538529396 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.0790361538529396 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:463.405517578125 - response_length/max:2048.0 - response_length/min:32.0 - response_length/clip_ratio:0.004638671875 - prompt_length/mean:389.04736328125 - prompt_length/max:1286.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.5135854482650757e-05 - timing_s/generate_sequences:49.41583251953125 - timing_s/reshard:2.3669393062591553 - timing_s/gen:653.375590134412 - timing_s/reward filter:18.410085301846266 - timing_s/gen_layer2:233.50217463541776 - timing_s/process_data:256.31470787059516 - timing_s/reward:11.997920517809689 - timing_s/step:1465.422064261511 - timing_s/old_log_prob:77.01296250429004 - timing_s/adv:0.4862041138112545 - timing_s/update_actor:462.1669522328302 - timing_s/stop_profile:1.3792887330055237e-06 - timing_per_token_ms/update_actor:0.06618179790695197 - timing_per_token_ms/adv:6.962389293809691e-05 - timing_per_token_ms/gen:0.17211224174544562 - perf/total_num_tokens:6983294 - perf/time_per_step:1465.422064261511 - perf/throughput:595.6725855904849 - train/num_gen_batches:4
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.140625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.390625
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2025 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.15625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4041666666666667
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4353 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.14973958333333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.39891304347826084
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6555 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.13411458333333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.38228155339805825
[36m(TaskRunner pid=3962660)[0m step:59 - train/true_reward_mean:0.8679461479187012 - train/kept_rate_layer1:0.13411458333333334 - train/kept_rate_layer2:0.38228155339805825 - global_seqlen/min:822202 - global_seqlen/max:910642 - global_seqlen/minmax_diff:88440 - global_seqlen/balanced_min:855446 - global_seqlen/balanced_max:855447 - global_seqlen/mean:855446.875 - actor/entropy:0.3350527286529541 - actor/pg_loss:0.053538985158053415 - actor/pg_clipfrac:0.014472449385376413 - actor/ppo_kl:0.009034966307829857 - actor/pg_clipfrac_lower:7.80397805836019e-06 - actor/grad_norm:1.1225286358967423 - perf/mfu/actor:0.2858097911948569 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:227.11178970336914 - actor/lr:1e-06 - critic/score/mean:0.6296514868736267 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6296514868736267 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.08410673588514328 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.08410673588514328 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:451.8016357421875 - response_length/max:2048.0 - response_length/min:27.0 - response_length/clip_ratio:0.00634765625 - prompt_length/mean:383.595703125 - prompt_length/max:1432.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.584179699420929e-05 - timing_s/generate_sequences:44.45787811279297 - timing_s/reshard:3.4553890228271484 - timing_s/gen:639.1674851002172 - timing_s/reward filter:18.487837864086032 - timing_s/gen_layer2:232.89795166999102 - timing_s/process_data:255.465939136222 - timing_s/reward:11.078947230242193 - timing_s/step:1436.9911687634885 - timing_s/old_log_prob:76.034539276734 - timing_s/adv:0.28575904201716185 - timing_s/update_actor:451.091754113324 - timing_s/stop_profile:1.12876296043396e-06 - timing_per_token_ms/update_actor:0.06591463586112872 - timing_per_token_ms/adv:4.175581359408815e-05 - timing_per_token_ms/gen:0.1726938737569008 - perf/total_num_tokens:6843575 - perf/time_per_step:1436.9911687634885 - perf/throughput:595.3041978233592 - train/num_gen_batches:4
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.13736979166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.39790679304897314
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2015 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.13736979166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3921800947867299
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4001 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.13541666666666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.406650641025641
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6031 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.14127604166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3665514592933948
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7940 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.13997395833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3932170542635659
[36m(TaskRunner pid=3962660)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': True, 'validate': True, 'global_steps': 60}
[36m(TaskRunner pid=3962660)[0m validation generation end
[36m(TaskRunner pid=3962660)[0m [prompt] system
[36m(TaskRunner pid=3962660)[0m You are a helpful assistant.
[36m(TaskRunner pid=3962660)[0m user
[36m(TaskRunner pid=3962660)[0m How many vertical asymptotes does the graph of $y=\frac{2}{x^2+x-6}$ have? Let's think step by step and output the final answer within \boxed{}.
[36m(TaskRunner pid=3962660)[0m assistant
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m [response] To determine the number of vertical asymptotes of the function \( y = \frac{2}{x^2 + x - 6} \), we need to find the values of \( x \) that make the denominator zero, as vertical asymptotes occur at these points if the numerator is non-zero.
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m First, we factor the denominator:
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m \[ x^2 + x - 6 = (x + 3)(x - 2). \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m So, the function becomes:
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m \[ y = \frac{2}{(x + 3)(x - 2)}. \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m The vertical asymptotes occur where the denominator is zero and the numerator is non-zero. Therefore, we need to solve:
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m \[ (x + 3)(x - 2) = 0. \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m This equation is satisfied when \( x + 3 = 0 \) or \( x - 2 = 0 \). Solving these, we get:
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m \[ x = -3 \quad \text{or} \quad x = 2. \]
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m We need to check that the numerator is non-zero at these points. Since the numerator is 2, which is non-zero, the vertical asymptotes occur at \( x = -3 \) and \( x = 2 \).
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m Thus, the function has two vertical asymptotes. Therefore, the number of vertical asymptotes is:
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m \[ \boxed{2} \]
[36m(TaskRunner pid=3962660)[0m [ground_truth] 2
[36m(TaskRunner pid=3962660)[0m [score] 1.0
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m len reward_extra_infos_dict['reward']: 5000
[36m(TaskRunner pid=3962660)[0m len reward_extra_infos_dict['acc']: 5000
[36m(TaskRunner pid=3962660)[0m local_global_step_folder: /workspace/ckpts/my_DAPO/DAPO-Qwen2.5-7B-Instruct-1M-Test_on_math0724/global_step_60
[36m(TaskRunner pid=3962660)[0m step:60 - train/true_reward_mean:0.8761118054389954 - train/kept_rate_layer1:0.13997395833333334 - train/kept_rate_layer2:0.3932170542635659 - global_seqlen/min:778831 - global_seqlen/max:900890 - global_seqlen/minmax_diff:122059 - global_seqlen/balanced_min:844934 - global_seqlen/balanced_max:844935 - global_seqlen/mean:844934.5 - actor/entropy:0.2631044387817383 - actor/pg_loss:0.03490998265703886 - actor/pg_clipfrac:0.011818557522245542 - actor/ppo_kl:0.009153920161643878 - actor/pg_clipfrac_lower:1.553476225429525e-05 - actor/grad_norm:1.0402266222517937 - perf/mfu/actor:0.29136963516352526 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:228.78368759155273 - actor/lr:1e-06 - val-aux/DigitalLearningGmbH/MATH-lighteval/reward/mean@1:0.639180078125 - val-core/DigitalLearningGmbH/MATH-lighteval/acc/mean@1:0.6458 - critic/score/mean:0.6408374309539795 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6408374309539795 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.05656083673238754 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.05656083673238754 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:448.63330078125 - response_length/max:2048.0 - response_length/min:37.0 - response_length/clip_ratio:0.0028076171875 - prompt_length/mean:376.498046875 - prompt_length/max:1245.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.1420419216156006e-05 - timing_s/generate_sequences:46.48051834106445 - timing_s/reshard:2.3140957355499268 - timing_s/gen:804.6588812861592 - timing_s/reward filter:23.00124282296747 - timing_s/gen_layer2:270.67909562494606 - timing_s/process_data:298.5493057547137 - timing_s/reward:12.919937503524125 - timing_s/step:1779.4059834014624 - timing_s/old_log_prob:74.01402544602752 - timing_s/adv:0.26174445170909166 - timing_s/update_actor:436.91569694690406 - timing_s/testing:94.54810365848243 - timing_s/save_checkpoint:52.816151645965874 - timing_s/stop_profile:2.7138739824295044e-06 - timing_per_token_ms/update_actor:0.06463750991155291 - timing_per_token_ms/adv:3.8722595022024145e-05 - timing_per_token_ms/gen:0.2189426440780319 - perf/total_num_tokens:6759476 - perf/time_per_step:1779.4059834014624 - perf/throughput:474.8407658969692 - train/num_gen_batches:5
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.14778645833333334
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4232745961820852
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2306 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.1328125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.40584150326797386
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4293 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.134765625
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.37318840579710144
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6147 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.13216145833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.41153530377668307
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=8152 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.146484375
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.41555555555555557
[36m(TaskRunner pid=3962660)[0m step:61 - train/true_reward_mean:0.8775880932807922 - train/kept_rate_layer1:0.146484375 - train/kept_rate_layer2:0.41555555555555557 - global_seqlen/min:820495 - global_seqlen/max:874201 - global_seqlen/minmax_diff:53706 - global_seqlen/balanced_min:853199 - global_seqlen/balanced_max:853199 - global_seqlen/mean:853199.0 - actor/entropy:0.4355899393558502 - actor/pg_loss:0.05399748277064996 - actor/pg_clipfrac:0.014133863271521236 - actor/ppo_kl:0.010993209507016372 - actor/pg_clipfrac_lower:9.832947047887347e-06 - actor/grad_norm:1.0348547662142664 - perf/mfu/actor:0.2899587552644879 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:228.07409286499023 - actor/lr:1e-06 - critic/score/mean:0.6070932745933533 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6070932745933533 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.08313368260860443 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.08313368260860443 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:453.770751953125 - response_length/max:2048.0 - response_length/min:27.0 - response_length/clip_ratio:0.0069580078125 - prompt_length/mean:379.431396484375 - prompt_length/max:1196.0 - prompt_length/min:41.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.0813196897506714e-05 - timing_s/generate_sequences:47.89451217651367 - timing_s/reshard:2.3279590606689453 - timing_s/gen:797.3112071715295 - timing_s/reward filter:23.539936096407473 - timing_s/gen_layer2:274.4540847223252 - timing_s/process_data:303.1103178784251 - timing_s/reward:13.485196956433356 - timing_s/step:1637.4217364527285 - timing_s/old_log_prob:74.656719179824 - timing_s/adv:0.2892409488558769 - timing_s/update_actor:443.5396189214662 - timing_s/stop_profile:1.3904646039009094e-06 - timing_per_token_ms/update_actor:0.06498185343065717 - timing_per_token_ms/adv:4.2375950519145726e-05 - timing_per_token_ms/gen:0.21448722245816967 - perf/total_num_tokens:6825592 - perf/time_per_step:1637.4217364527285 - perf/throughput:521.0624611887406 - train/num_gen_batches:5
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.14127604166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3655913978494624
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=1904 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.150390625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.39466089466089466
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4092 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.14453125
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4057807807807808
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6254 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.13020833333333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.38416666666666666
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=8098 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.138671875
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3884976525821596
[36m(TaskRunner pid=3962660)[0m step:62 - train/true_reward_mean:0.8714173436164856 - train/kept_rate_layer1:0.138671875 - train/kept_rate_layer2:0.3884976525821596 - global_seqlen/min:814558 - global_seqlen/max:902735 - global_seqlen/minmax_diff:88177 - global_seqlen/balanced_min:860485 - global_seqlen/balanced_max:860486 - global_seqlen/mean:860485.125 - actor/entropy:0.30399131774902344 - actor/pg_loss:0.05209521044188322 - actor/pg_clipfrac:0.012288564578479703 - actor/ppo_kl:0.009030959975623707 - actor/pg_clipfrac_lower:2.497543550065688e-06 - actor/grad_norm:0.9780116283800453 - perf/mfu/actor:0.2950863709253918 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:228.15946197509766 - actor/lr:1e-06 - critic/score/mean:0.6407353281974792 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6407353281974792 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.044114336371421814 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888516187667847 - critic/returns/mean:-0.044114336371421814 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888516187667847 - response_length/mean:460.3831787109375 - response_length/max:2048.0 - response_length/min:17.0 - response_length/clip_ratio:0.0018310546875 - prompt_length/mean:379.934326171875 - prompt_length/max:1235.0 - prompt_length/min:44.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.908373087644577e-05 - timing_s/generate_sequences:41.48274230957031 - timing_s/reshard:3.016932249069214 - timing_s/gen:815.3134921221063 - timing_s/reward filter:23.21826425753534 - timing_s/gen_layer2:270.65935679059476 - timing_s/process_data:298.74311303533614 - timing_s/reward:13.484844411723316 - timing_s/step:1648.214190418832 - timing_s/old_log_prob:75.97738911025226 - timing_s/adv:0.2993435189127922 - timing_s/update_actor:439.52601820230484 - timing_s/stop_profile:1.2051314115524292e-06 - timing_per_token_ms/update_actor:0.06384857875990373 - timing_per_token_ms/adv:4.3484702729868835e-05 - timing_per_token_ms/gen:0.21617986358120458 - perf/total_num_tokens:6883881 - perf/time_per_step:1648.214190418832 - perf/throughput:522.0711786138304 - train/num_gen_batches:5
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.11979166666666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.38247282608695654
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=1689 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.13411458333333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3897653721682848
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3616 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.140625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3939043209876543
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5658 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.12955729166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.37814070351758794
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7464 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.12630208333333334
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4020618556701031
[36m(TaskRunner pid=3962660)[0m step:63 - train/true_reward_mean:0.8807751536369324 - train/kept_rate_layer1:0.12630208333333334 - train/kept_rate_layer2:0.4020618556701031 - global_seqlen/min:804590 - global_seqlen/max:898472 - global_seqlen/minmax_diff:93882 - global_seqlen/balanced_min:846950 - global_seqlen/balanced_max:846951 - global_seqlen/mean:846950.375 - actor/entropy:0.3449518382549286 - actor/pg_loss:0.019734388242774046 - actor/pg_clipfrac:0.011914493645050614 - actor/ppo_kl:0.008176492132624408 - actor/pg_clipfrac_lower:1.0818782493243451e-05 - actor/grad_norm:0.95734026376158 - perf/mfu/actor:0.2933941324037259 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:226.0662956237793 - actor/lr:1e-06 - critic/score/mean:0.6495741009712219 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6495741009712219 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.046737030148506165 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.046737030148506165 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:450.951416015625 - response_length/max:2048.0 - response_length/min:8.0 - response_length/clip_ratio:0.0013427734375 - prompt_length/mean:376.1485595703125 - prompt_length/max:1819.0 - prompt_length/min:41.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.141948789358139e-05 - timing_s/generate_sequences:39.110233306884766 - timing_s/reshard:3.0169260501861572 - timing_s/gen:791.4971149647608 - timing_s/reward filter:23.175076350569725 - timing_s/gen_layer2:259.91402334719896 - timing_s/process_data:287.7143122917041 - timing_s/reward:12.718394985422492 - timing_s/step:1606.0989583348855 - timing_s/old_log_prob:74.35536273475736 - timing_s/adv:0.444047337397933 - timing_s/update_actor:434.779458431527 - timing_s/stop_profile:1.3569369912147522e-06 - timing_per_token_ms/update_actor:0.06416837858291388 - timing_per_token_ms/adv:6.55362094558865e-05 - timing_per_token_ms/gen:0.21425434478123262 - perf/total_num_tokens:6775603 - perf/time_per_step:1606.0989583348855 - perf/throughput:527.3338673216446 - train/num_gen_batches:5
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.14518229166666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.42096412556053814
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2253 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.12825520833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4037648054145516
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=4162 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.12890625
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3806818181818182
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5971 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.12955729166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3814907872696817
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7793 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.134765625
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4023752012882448
[36m(TaskRunner pid=3962660)[0m step:64 - train/true_reward_mean:0.8773486018180847 - train/kept_rate_layer1:0.134765625 - train/kept_rate_layer2:0.4023752012882448 - global_seqlen/min:810537 - global_seqlen/max:913111 - global_seqlen/minmax_diff:102574 - global_seqlen/balanced_min:859682 - global_seqlen/balanced_max:859683 - global_seqlen/mean:859682.25 - actor/entropy:0.28998976945877075 - actor/pg_loss:-0.037272522804044285 - actor/pg_clipfrac:0.011286358725458027 - actor/ppo_kl:0.007654221332601507 - actor/pg_clipfrac_lower:1.5346038512171741e-06 - actor/grad_norm:0.9439893844537437 - perf/mfu/actor:0.29378804983667917 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:228.30065536499023 - actor/lr:1e-06 - critic/score/mean:0.6456232666969299 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6456232666969299 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.04366251826286316 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.04366251826286316 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:454.841064453125 - response_length/max:2048.0 - response_length/min:18.0 - response_length/clip_ratio:0.00146484375 - prompt_length/mean:384.6923828125 - prompt_length/max:1934.0 - prompt_length/min:47.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.145674079656601e-05 - timing_s/generate_sequences:44.74923324584961 - timing_s/reshard:2.30643892288208 - timing_s/gen:782.5456187492236 - timing_s/reward filter:23.307133904658258 - timing_s/gen_layer2:263.77862094622105 - timing_s/process_data:291.88698640372604 - timing_s/reward:12.755102580413222 - timing_s/step:1609.3458106415346 - timing_s/old_log_prob:76.29519190173596 - timing_s/adv:0.2837075348943472 - timing_s/update_actor:440.88386972341686 - timing_s/stop_profile:1.2479722499847412e-06 - timing_per_token_ms/update_actor:0.0641056433530262 - timing_per_token_ms/adv:4.1251801885863526e-05 - timing_per_token_ms/gen:0.21001970950243493 - perf/total_num_tokens:6877458 - perf/time_per_step:1609.3458106415346 - perf/throughput:534.1811836309464 - train/num_gen_batches:5
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.12239583333333333
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.39738475177304966
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=1793 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.10807291666666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3755020080321285
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3289 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.13671875
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.36884920634920637
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5148 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.126953125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.375
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6903 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.11653645833333333
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4085195530726257
[36m(TaskRunner pid=3962660)[0m step:65 - train/true_reward_mean:0.8823361396789551 - train/kept_rate_layer1:0.11653645833333333 - train/kept_rate_layer2:0.4085195530726257 - global_seqlen/min:822427 - global_seqlen/max:872521 - global_seqlen/minmax_diff:50094 - global_seqlen/balanced_min:843309 - global_seqlen/balanced_max:843310 - global_seqlen/mean:843309.875 - actor/entropy:0.2909074127674103 - actor/pg_loss:0.03127300637279831 - actor/pg_clipfrac:0.011676289999101017 - actor/ppo_kl:0.009059649754025515 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9573273446876556 - perf/mfu/actor:0.28336210223541286 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:227.55466842651367 - actor/lr:1e-06 - critic/score/mean:0.6467350721359253 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6467350721359253 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.037873126566410065 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888518571853638 - critic/returns/mean:-0.037873126566410065 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888518571853638 - response_length/mean:453.3587646484375 - response_length/max:2048.0 - response_length/min:29.0 - response_length/clip_ratio:0.0008544921875 - prompt_length/mean:370.18603515625 - prompt_length/max:1889.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:2.080574631690979e-05 - timing_s/generate_sequences:35.732757568359375 - timing_s/reshard:3.861847400665283 - timing_s/gen:787.8552410919219 - timing_s/reward filter:23.358726835809648 - timing_s/gen_layer2:253.8212888147682 - timing_s/process_data:281.59560991451144 - timing_s/reward:11.557998673990369 - timing_s/step:1607.8587969131768 - timing_s/old_log_prob:74.06569612491876 - timing_s/adv:0.2628667317330837 - timing_s/update_actor:448.2667530309409 - timing_s/stop_profile:1.1771917343139648e-06 - timing_per_token_ms/update_actor:0.06644454878328991 - timing_per_token_ms/adv:3.896354405506691e-05 - timing_per_token_ms/gen:0.212136045410819 - perf/total_num_tokens:6746479 - perf/time_per_step:1607.8587969131768 - perf/throughput:524.4924968654061 - train/num_gen_batches:5
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.1171875
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3803240740740741
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=1643 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.1328125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.37826797385620914
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3495 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.11588541666666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3822565543071161
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5128 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.130859375
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.35883084577114427
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=6859 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.126953125
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3628205128205128
[36m(TaskRunner pid=3962660)[0m step:66 - train/true_reward_mean:0.8933280110359192 - train/kept_rate_layer1:0.126953125 - train/kept_rate_layer2:0.3628205128205128 - global_seqlen/min:803970 - global_seqlen/max:915784 - global_seqlen/minmax_diff:111814 - global_seqlen/balanced_min:846701 - global_seqlen/balanced_max:846702 - global_seqlen/mean:846701.875 - actor/entropy:0.2749336063861847 - actor/pg_loss:0.01865619719253566 - actor/pg_clipfrac:0.01134546827018441 - actor/ppo_kl:0.008171078853292041 - actor/pg_clipfrac_lower:1.8858601581136446e-06 - actor/grad_norm:0.9545142431743443 - perf/mfu/actor:0.29363192981582265 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:227.69181060791016 - actor/lr:1e-06 - critic/score/mean:0.6419563889503479 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6419563889503479 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.03653080761432648 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.03653080761432648 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888504266738892 - response_length/mean:451.3768310546875 - response_length/max:2048.0 - response_length/min:18.0 - response_length/clip_ratio:0.0010986328125 - prompt_length/mean:375.48046875 - prompt_length/max:1653.0 - prompt_length/min:45.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.7726793885231018e-05 - timing_s/generate_sequences:40.24232864379883 - timing_s/reshard:2.2090115547180176 - timing_s/gen:788.6696799704805 - timing_s/reward filter:23.30339888110757 - timing_s/gen_layer2:244.8029453670606 - timing_s/process_data:272.56158340815455 - timing_s/reward:12.053285032510757 - timing_s/step:1586.7242184681818 - timing_s/old_log_prob:74.50735222082585 - timing_s/adv:0.2558381650596857 - timing_s/update_actor:434.3536895290017 - timing_s/stop_profile:1.2153759598731995e-06 - timing_per_token_ms/update_actor:0.06412435450331938 - timing_per_token_ms/adv:3.776981199251592e-05 - timing_per_token_ms/gen:0.21328776239648722 - perf/total_num_tokens:6773615 - perf/time_per_step:1586.7242184681818 - perf/throughput:533.6162800977495 - train/num_gen_batches:5
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.12825520833333334
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4276649746192893
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=2022 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.13606770833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3437001594896332
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3746 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.12760416666666666
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3862670068027211
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5563 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.13216145833333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.4088669950738916
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7555 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=4. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.125
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3943142361111111
[36m(TaskRunner pid=3962660)[0m step:67 - train/true_reward_mean:0.8749257922172546 - train/kept_rate_layer1:0.125 - train/kept_rate_layer2:0.3943142361111111 - global_seqlen/min:776820 - global_seqlen/max:891343 - global_seqlen/minmax_diff:114523 - global_seqlen/balanced_min:831634 - global_seqlen/balanced_max:831635 - global_seqlen/mean:831634.625 - actor/entropy:0.29039737582206726 - actor/pg_loss:0.08687035107411645 - actor/pg_clipfrac:0.013074657431645438 - actor/ppo_kl:0.0108661995165256 - actor/pg_clipfrac_lower:5.725449554096812e-06 - actor/grad_norm:0.9744735490530729 - perf/mfu/actor:0.2994188973873141 - perf/max_memory_allocated_gb:82.89672517776489 - perf/max_memory_reserved_gb:123.361328125 - perf/cpu_memory_used_gb:226.7984390258789 - actor/lr:1e-06 - critic/score/mean:0.6446993947029114 - critic/score/max:1.0 - critic/score/min:-1.0 - critic/rewards/mean:0.6446993947029114 - critic/rewards/max:1.0 - critic/rewards/min:-1.0 - critic/advantages/mean:-0.03840956091880798 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888524532318115 - critic/returns/mean:-0.03840956091880798 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888524532318115 - response_length/mean:442.265380859375 - response_length/max:2048.0 - response_length/min:25.0 - response_length/clip_ratio:0.001220703125 - prompt_length/mean:369.8778076171875 - prompt_length/max:1458.0 - prompt_length/min:46.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:1.6303732991218567e-05 - timing_s/generate_sequences:38.66322326660156 - timing_s/reshard:2.18654727935791 - timing_s/gen:795.6533750286326 - timing_s/reward filter:23.572231243364513 - timing_s/gen_layer2:262.57008639350533 - timing_s/process_data:290.78585726581514 - timing_s/reward:12.544678634032607 - timing_s/step:1594.5066393082961 - timing_s/old_log_prob:72.81232905294746 - timing_s/adv:0.2631891658529639 - timing_s/update_actor:418.15640140045434 - timing_s/stop_profile:1.1315569281578064e-06 - timing_per_token_ms/update_actor:0.06285158001334636 - timing_per_token_ms/adv:3.955901394993082e-05 - timing_per_token_ms/gen:0.2196094479353053 - perf/total_num_tokens:6653077 - perf/time_per_step:1594.5066393082961 - perf/throughput:521.5623469343261 - train/num_gen_batches:5
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.13020833333333334
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.39708333333333334
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=1906 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=1. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.12565104166666666
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.3797495682210708
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=3665 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=2. Keep generating...
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.11979166666666667
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.37069746376811596
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=5302 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=3. Keep generating...
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m kept_rate_layer1=0.1328125
[36m(TaskRunner pid=3962660)[0m 
[36m(TaskRunner pid=3962660)[0m list(reward_extra_infos_dict.keys())=['acc']
[36m(TaskRunner pid=3962660)[0m kept_rate_layer2=0.40093954248366015
[36m(TaskRunner pid=3962660)[0m num_prompt_in_batch=7265 < prompt_bsz*16=8192
[36m(TaskRunner pid=3962660)[0m num_gen_batches=4. Keep generating...
